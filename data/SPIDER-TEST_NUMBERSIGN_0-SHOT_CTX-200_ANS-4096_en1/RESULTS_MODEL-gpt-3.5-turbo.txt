SELECT COUNT(*) FROM events_log WHERE activity = 'end trip';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip';
SELECT COUNT(*) FROM events_log WHERE activity = 'end of trip';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip' AND resource = 'James';
SELECT COUNT(activity) FROM events_log WHERE resource = 'James' AND activity = 'end trip';
SELECT COUNT(*) FROM events_log WHERE resource = 'James' AND activity = 'end trip';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip' AND resource = 'James';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip' AND resource = 'James';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip' AND resource = 'James';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip' AND resource = 'James';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip' AND resource = 'James';
SELECT COUNT(*) FROM events_log WHERE activity = 'end trip' AND resource = 'James';
SELECT COUNT(*) FROM events_log WHERE activity = 'finalization' AND resource = 'James';
SELECT COUNT(activity) FROM events_log WHERE activity LIKE '%end of trip%' AND resource = 'James';
SELECT resource, COUNT(*) AS num_events FROM events_log GROUP BY resource;
SELECT resource, COUNT(*) AS num_events FROM events_log GROUP BY resource;
SELECT resource, COUNT(*) as event_count FROM events_log GROUP BY resource;
SELECT resource, COUNT(*) AS num_events FROM events_log GROUP BY resource;
SELECT resource, COUNT(*) AS num_events FROM events_log GROUP BY resource;
SELECT resource, COUNT(resource) as resource_count FROM events_log GROUP BY resource;
SELECT resource, COUNT(resource) AS resource_count FROM events_log GROUP BY resource;
SELECT resource, COUNT(*) as event_count FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) AS activity_performances FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) AS num_activities FROM events_log GROUP BY resource;
SELECT idcase, COUNT(activity) as actions_taken FROM events_log WHERE activity LIKE '%travel declaration%' GROUP BY idcase;
SELECT COUNT(*) FROM events_log WHERE resource = 'Peter';
SELECT COUNT(*) FROM events_log WHERE resource = 'Peter'
SELECT COUNT(*) FROM events_log WHERE activity = 'Peter';
SELECT COUNT(*) FROM events_log WHERE resource = 'Peter';
SELECT COUNT(*) FROM events_log WHERE resource = 'Peter';
SELECT COUNT(*) FROM events_log WHERE activity = 'Peter';
SELECT COUNT(activity) FROM events_log WHERE activity = 'travel declaration' AND resource = 'Peter';
SELECT idcase FROM events_log WHERE timestamp >= '2018-03-01' AND timestamp < '2018-04-01' AND activity = 'Terminated';
SELECT idcase FROM events_log WHERE timestamp >= '2018-03-01' AND timestamp < '2018-04-01';
SELECT idcase FROM events_log WHERE timestamp >= '2018-03-01' AND timestamp < '2018-04-01'
SELECT idcase FROM events_log WHERE timestamp >= '2018-03-01' AND timestamp < '2018-04-01';
SELECT idcase FROM events_log WHERE timestamp = '2018-03-31' GROUP BY idcase;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'terminate' AND timestamp >= '2018-03-01' AND timestamp < '2018-04-01';
SELECT DISTINCT idcase FROM events_log WHERE strftime('%Y-%m', timestamp) = '2018-03';
SELECT activity FROM events_log WHERE strftime('%Y-%m', timestamp) = '2018-03';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND resource != 'Douglas';
SELECT idcase FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND resource != 'Douglas';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND resource != 'Douglas';
SELECT idcase FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND resource != 'Douglas';
SELECT idcase FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND resource != 'Douglas';
SELECT idcase FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND resource != 'Douglas';
SELECT idcase FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND resource != 'Douglas';
SELECT idcase FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND resource != 'Douglas';
SELECT idcase FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND resource != 'Douglas';
SELECT idcase FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND resource != 'Douglas';
SELECT idcase FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND resource != 'Douglas';
SELECT activity FROM events_log WHERE pre_approver <> 'Douglas' AND activity = 'declaration';
SELECT * FROM events_log WHERE activity = 'declaration rejected' AND resource = 'pre-approver' AND cost = 'other than Douglas';
SELECT COUNT(DISTINCT resource) FROM events_log;
SELECT COUNT(DISTINCT resource) FROM events_log;
SELECT COUNT(DISTINCT resource) FROM events_log;
SELECT COUNT(DISTINCT resource) FROM events_log;
SELECT COUNT(DISTINCT resource) FROM events_log;
SELECT COUNT(DISTINCT resource) FROM events_log;
SELECT COUNT(DISTINCT resource) FROM events_log;
SELECT COUNT(DISTINCT resource) FROM events_log;
SELECT COUNT(DISTINCT resource) FROM events_log;
SELECT COUNT(DISTINCT resource) FROM events_log;
SELECT COUNT(DISTINCT resource) FROM events_log;
SELECT COUNT(DISTINCT resource) AS num_employees FROM events_log;
SELECT COUNT(DISTINCT resource) FROM events_log WHERE activity = 'processing declarations';
SELECT resource, COUNT(*) AS total_events FROM events_log GROUP BY resource;
SELECT resource, COUNT(*) AS total_events FROM events_log GROUP BY resource;
SELECT resource, COUNT(*) as total_events FROM events_log GROUP BY resource;
SELECT resource, COUNT(activity) AS total_actions FROM events_log WHERE activity = 'declaration' GROUP BY resource;
SELECT idcase FROM events_log WHERE cost > 2225;
SELECT DISTINCT idcase FROM events_log WHERE cost > 2225;
SELECT DISTINCT idcase FROM events_log WHERE cost > 2225;
SELECT idcase, activity FROM events_log WHERE cost > 2225;
SELECT idcase FROM events_log WHERE cost > 2225;
SELECT resource, COUNT(*) as num_events FROM events_log GROUP BY resource ORDER BY num_events DESC LIMIT 1;
SELECT resource, COUNT(*) as event_count FROM events_log GROUP BY resource ORDER BY event_count DESC;
SELECT resource, COUNT(*) as event_count FROM events_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS event_count FROM events_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(activity) as num_events FROM events_log GROUP BY resource ORDER BY num_events DESC;
SELECT resource, COUNT(*) as num_events FROM events_log GROUP BY resource ORDER BY num_events DESC LIMIT 1;
SELECT resource, COUNT(*) as event_count FROM events_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) as num_events FROM events_log GROUP BY resource ORDER BY num_events DESC LIMIT 1;
SELECT resource, COUNT(*) as event_count FROM events_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) as event_count FROM events_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, SUM(cost) as total_cost FROM events_log WHERE activity = 'processing' GROUP BY resource ORDER BY total_cost DESC;
SELECT resource, COUNT(*) AS event_count FROM events_log GROUP BY resource ORDER BY event_count DESC;
SELECT resource, COUNT(*) AS num_events FROM events_log GROUP BY resource ORDER BY num_events DESC LIMIT 1;
SELECT resource, COUNT(*) as event_count FROM events_log GROUP BY resource ORDER BY event_count DESC;
SELECT resource, COUNT(activity) AS num_events FROM events_log GROUP BY resource ORDER BY num_events DESC;
SELECT resource, COUNT(*) AS num_events FROM events_log GROUP BY resource ORDER BY num_events DESC LIMIT 1;
SELECT resource, COUNT(*) as num_events FROM events_log GROUP BY resource ORDER BY num_events DESC LIMIT 1;
SELECT resource, COUNT(*) AS num_events FROM events_log GROUP BY resource ORDER BY num_events DESC LIMIT 1;
SELECT resource, COUNT(activity) as total_actions FROM events_log WHERE activity = 'declaration' GROUP BY resource ORDER BY total_actions DESC;
SELECT resource, COUNT(*) as num_events FROM events_log GROUP BY resource ORDER BY num_events DESC;
SELECT resource, COUNT(*) as num_events FROM events_log GROUP BY resource ORDER BY num_events DESC;
SELECT resource, COUNT(*) AS num_events FROM events_log GROUP BY resource ORDER BY num_events DESC;
SELECT resource, COUNT(*) as num_events FROM events_log GROUP BY resource ORDER BY num_events DESC;
SELECT resource, COUNT(activity) AS activity_performances FROM events_log GROUP BY resource ORDER BY activity_performances DESC;
SELECT resource, COUNT(activity) AS declaration_count FROM events_log WHERE activity = 'processing declarations' GROUP BY resource ORDER BY declaration_count DESC;
SELECT activity, cost FROM events_log WHERE cost <> 0;
SELECT activity, cost FROM events_log WHERE cost <> 0;
SELECT * FROM events_log WHERE cost <> 0;
SELECT activity, timestamp, resource, cost, idcase FROM events_log WHERE cost <> 0;
SELECT * FROM events_log WHERE cost <> 0;
SELECT activity FROM events_log WHERE cost IS NOT NULL;
SELECT activity, cost FROM events_log WHERE cost IS NOT NULL;
SELECT * FROM events_log WHERE cost IS NOT NULL;
SELECT * FROM events_log WHERE cost IS NOT NULL;
SELECT activity, cost FROM events_log WHERE activity = 'declaration' AND cost > 0;
SELECT * FROM events_log WHERE activity = 'start trip' OR activity = 'request payment';
SELECT * FROM events_log WHERE activity = 'start trip' OR activity = 'request payment';
SELECT * FROM events_log WHERE activity IN ('start trip', 'request payment');
SELECT * FROM events_log WHERE activity = 'start trip' OR activity = 'request payment';
SELECT * FROM events_log WHERE activity IN ('start_trip', 'payment_request');
SELECT activity, COUNT(activity) as frequency FROM events_log GROUP BY activity ORDER BY frequency DESC LIMIT 1;
SELECT activity, COUNT(activity) as frequency FROM events_log GROUP BY activity ORDER BY frequency DESC;
SELECT activity, COUNT(activity) AS frequency FROM events_log GROUP BY activity ORDER BY frequency DESC;
SELECT activity, COUNT(activity) as frequency FROM events_log GROUP BY activity ORDER BY frequency DESC LIMIT 1;
SELECT activity, COUNT(activity) AS activity_count FROM events_log GROUP BY activity ORDER BY activity_count DESC LIMIT 1;
SELECT activity, COUNT(activity) as activity_occurrences FROM events_log GROUP BY activity ORDER BY activity_occurrences DESC;
SELECT activity, COUNT(activity) as frequency FROM events_log GROUP BY activity ORDER BY frequency DESC;
SELECT activity, COUNT(activity) as frequency FROM events_log GROUP BY activity ORDER BY frequency DESC;
SELECT activity, COUNT(activity) AS frequency FROM events_log WHERE activity LIKE '%processing of declarations%' GROUP BY activity ORDER BY frequency DESC;
SELECT * FROM events_log WHERE strftime('%Y', timestamp) = '2017';
SELECT * FROM events_log WHERE strftime('%Y', timestamp) = '2017';
SELECT activity FROM events_log WHERE strftime('%Y', timestamp) = '2017';
SELECT * FROM events_log WHERE strftime('%Y', timestamp) = '2017';
SELECT activity FROM events_log WHERE timestamp >= '2017-01-01' AND timestamp < '2018-01-01';
SELECT activity FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-12-31';
SELECT activity FROM events_log WHERE timestamp >= '2017-01-01' AND timestamp < '2018-01-01';
SELECT * FROM events_log WHERE timestamp >= '2017-01-01' AND timestamp < '2018-01-01';
SELECT * FROM events_log WHERE strftime('%Y', timestamp) = '2017';
SELECT * FROM events_log WHERE timestamp >= '2017-01-01' AND timestamp < '2018-01-01';
SELECT * FROM events_log WHERE activity = 'processing of declarations' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31';
SELECT * FROM events_log WHERE timestamp >= '2017-01-01' AND timestamp < '2018-01-01' AND activity = 'processing declarations';
SELECT * FROM events_log WHERE activity = 'processing of declarations' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31';
SELECT activity FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-12-31' AND activity = 'processing of declarations';
SELECT activity FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-12-31' AND activity LIKE '%processing declarations%';
SELECT * FROM events_log LIMIT 20;
SELECT idcase, COUNT(*) as num_events FROM events_log GROUP BY idcase HAVING num_events <= 20;
SELECT idcase, COUNT(*) as num_events FROM events_log GROUP BY idcase HAVING COUNT(*) <= 20;
SELECT activity, COUNT(activity) as activity_occurrences FROM events_log GROUP BY activity HAVING COUNT(activity) <= 20;
SELECT idcase, COUNT(id) as num_events FROM events_log GROUP BY idcase HAVING num_events <= 20;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(activity) <= 20;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(activity) <= 20;
SELECT resource, COUNT(DISTINCT idcase) as num_cases FROM events_log GROUP BY resource ORDER BY num_cases DESC LIMIT 5;
SELECT resource FROM events_log GROUP BY resource ORDER BY COUNT(DISTINCT idcase) DESC LIMIT 5;
SELECT resource, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY resource ORDER BY num_cases DESC LIMIT 5;
SELECT resource, COUNT(DISTINCT idcase) as num_cases FROM events_log GROUP BY resource ORDER BY num_cases DESC LIMIT 5;
SELECT resource, COUNT(*) AS declaration_count FROM events_log WHERE activity = 'declaration' GROUP BY resource ORDER BY declaration_count DESC LIMIT 5;
SELECT resource, COUNT(*) as num_events FROM events_log GROUP BY resource ORDER BY num_events DESC LIMIT 5;
SELECT resource, COUNT(*) as event_count FROM events_log GROUP BY resource ORDER BY event_count DESC LIMIT 5;
SELECT resource, COUNT(resource) as num_events FROM events_log GROUP BY resource ORDER BY num_events DESC LIMIT 5;
SELECT resource, COUNT(*) as event_count FROM events_log GROUP BY resource ORDER BY event_count DESC LIMIT 5;
SELECT resource, COUNT(resource) as total_worked FROM events_log GROUP BY resource ORDER BY total_worked DESC LIMIT 5;
SELECT resource, COUNT(*) FROM events_log WHERE activity = 'start trip' AND timestamp BETWEEN '2016-01-01' AND '2016-12-31' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity = 'start trip' AND timestamp BETWEEN '2016-01-01' AND '2016-12-31' GROUP BY resource;
SELECT resource, COUNT(*) AS num_performances FROM events_log WHERE activity = 'start trip' AND timestamp BETWEEN '2016-01-01' AND '2016-12-31' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity = 'start trip' AND strftime('%Y', timestamp) = '2016' GROUP BY resource;
SELECT resource, COUNT(*) AS num_performances FROM events_log WHERE activity = 'start trip' AND timestamp LIKE '2016%' GROUP BY resource;
SELECT resource, COUNT(*) AS num_occurrences FROM events_log WHERE activity = 'start trip' AND strftime('%Y', timestamp) = '2016' GROUP BY resource;
SELECT resource, COUNT(*) AS total_occurrences FROM events_log WHERE activity = 'start trip' AND strftime('%Y', timestamp) = '2016' GROUP BY resource;
SELECT resource, COUNT(activity) as num_actions FROM events_log WHERE activity = 'start_trip' AND timestamp BETWEEN '2016-01-01' AND '2016-12-31' GROUP BY resource;
SELECT resource, COUNT(activity) FROM events_log WHERE activity = 'start of the trip' AND timestamp LIKE '2016%' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity = 'declaration rejected by supervisor' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity = 'declaration rejected by supervisor' GROUP BY resource;
SELECT resource, COUNT(*) AS num_performances FROM events_log WHERE activity = 'declaration rejected by supervisor' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity = 'declaration rejected by supervisor' GROUP BY resource;
SELECT resource, COUNT(*) as num_performances FROM events_log WHERE activity = 'declaration rejected by supervisor' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity = 'declaration rejected by supervisor' GROUP BY resource;
SELECT resource, COUNT(*) AS num_performances FROM events_log WHERE activity = 'declaration rejected by supervisor' GROUP BY resource;
SELECT resource, COUNT(*) AS occurrences FROM events_log WHERE activity = 'declaration rejected by supervisor' GROUP BY resource;
SELECT resource, COUNT(*) AS num_occurrences FROM events_log WHERE activity = 'declaration rejected by supervisor' GROUP BY resource;
SELECT resource, COUNT(*) AS total_occurrences FROM events_log WHERE activity = 'declaration rejected by supervisor' GROUP BY resource;
SELECT resource, COUNT(*) AS num_rejections FROM events_log WHERE activity = 'reject' AND resource IN (SELECT resource FROM events_log WHERE activity = 'declare' AND role = 'supervisor') GROUP BY resource;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(activity) > 20;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(activity) > 20;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(activity) > 20;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(activity) > 20;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 20;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(activity) > 20;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(activity) > 20;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(activity) > 20;
SELECT idcase, COUNT(*) as intervention_count FROM events_log WHERE activity = 'declaration_processing' GROUP BY idcase HAVING COUNT(*) > 20;
SELECT idcase, COUNT(*) as num_events FROM events_log GROUP BY idcase ORDER BY num_events DESC;
SELECT idcase, COUNT(activity) as activity_count FROM events_log GROUP BY idcase ORDER BY activity_count DESC LIMIT 1;
SELECT idcase FROM events_log GROUP BY idcase ORDER BY COUNT(id) DESC LIMIT 1;
SELECT idcase FROM events_log GROUP BY idcase ORDER BY COUNT(activity) DESC LIMIT 1;
SELECT idcase FROM events_log GROUP BY idcase ORDER BY COUNT(id) DESC LIMIT 1;
SELECT idcase FROM events_log GROUP BY idcase ORDER BY COUNT(activity) DESC LIMIT 1;
SELECT idcase, COUNT(activity) AS num_actions FROM events_log GROUP BY idcase ORDER BY num_actions DESC LIMIT 1;
SELECT idcase FROM events_log WHERE resource = 'Sara' AND activity != 'request payment';
SELECT idcase FROM events_log WHERE resource = 'Sara' AND activity != 'request payment';
SELECT idcase FROM events_log WHERE resource = 'Sara' AND activity != 'request payment';
SELECT idcase FROM events_log WHERE resource = 'Sara' AND activity != 'request payment';
SELECT DISTINCT idcase FROM events_log WHERE activity != 'request payment' AND resource = 'Sara';
SELECT id, activity, timestamp, resource, cost, idcase FROM events_log WHERE resource = 'Sara' AND idcase NOT IN (SELECT idcase FROM events_log WHERE activity = 'payment request');
SELECT * FROM events_log WHERE timestamp BETWEEN '2017-01-10' AND '2017-02-01' AND idcase = 'declaration 143598';
SELECT * FROM events_log WHERE idcase = 'declaration 143598' AND timestamp BETWEEN '2017-01-10' AND '2017-02-01';
SELECT SUM(cost) FROM events_log WHERE activity = 'declaration 143598' AND timestamp BETWEEN '2017-01-10' AND '2017-02-01';
SELECT SUM(cost) FROM events_log WHERE timestamp BETWEEN '2017-01-10' AND '2017-02-01' AND idcase = 'declaration 143598';
SELECT * FROM events_log WHERE timestamp >= '2017-01-10' AND timestamp <= '2017-02-01' AND idcase = 143598;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-05-31' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS cases_associated FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-05-31' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-05-31' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-05-31' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS cases_associated FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-05-31' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS cases_worked_on FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-05-31' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-05-31' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS cases_associated FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-05-31' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS cases_worked_on FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-05-31' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-05-31' GROUP BY resource;
SELECT employee, COUNT(DISTINCT idcase) AS declarations_worked_on FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-05-31' GROUP BY employee;
SELECT idcase, COUNT(activity) as num_activities FROM events_log GROUP BY idcase ORDER BY num_activities DESC LIMIT 10;
SELECT idcase, COUNT(activity) as num_activities FROM events_log GROUP BY idcase ORDER BY num_activities DESC LIMIT 10;
SELECT idcase, COUNT(activity) as activity_count FROM events_log GROUP BY idcase ORDER BY activity_count DESC LIMIT 10;
SELECT idcase, COUNT(activity) as activity_count FROM events_log GROUP BY idcase ORDER BY activity_count DESC LIMIT 10;
SELECT idcase, COUNT(activity) as activity_count FROM events_log GROUP BY idcase ORDER BY activity_count DESC LIMIT 10;
SELECT idcase, COUNT(activity) as num_activities FROM events_log GROUP BY idcase ORDER BY num_activities DESC LIMIT 10;
SELECT idcase, COUNT(activity) as activity_performances FROM events_log GROUP BY idcase ORDER BY activity_performances DESC LIMIT 10;
SELECT idcase, COUNT(activity) as activity_performances FROM events_log GROUP BY idcase ORDER BY activity_performances DESC LIMIT 10;
SELECT idcase, COUNT(activity) as num_activities FROM events_log GROUP BY idcase ORDER BY num_activities DESC LIMIT 10;
SELECT id, COUNT(DISTINCT activity) AS num_actions FROM events_log GROUP BY id ORDER BY id DESC LIMIT 10;
SELECT activity, COUNT(DISTINCT activity) as diversity FROM events_log GROUP BY activity ORDER BY diversity DESC LIMIT 10;
SELECT idcase, COUNT(*) as num_events FROM events_log GROUP BY idcase ORDER BY num_events DESC LIMIT 10;
SELECT idcase, COUNT(*) as num_events FROM events_log GROUP BY idcase ORDER BY num_events DESC LIMIT 10;
SELECT idcase, COUNT(*) as num_events FROM events_log GROUP BY idcase ORDER BY num_events DESC LIMIT 10;
SELECT idcase, COUNT(*) as event_count FROM events_log GROUP BY idcase ORDER BY event_count DESC LIMIT 10;
SELECT idcase, COUNT(*) as event_count FROM events_log GROUP BY idcase ORDER BY event_count DESC LIMIT 10;
SELECT idcase, COUNT(*) as event_count FROM events_log GROUP BY idcase ORDER BY event_count DESC LIMIT 10;
SELECT activity, COUNT(activity) as total_actions FROM events_log GROUP BY activity ORDER BY total_actions DESC LIMIT 10;
SELECT idcase, SUM(cost) AS total_cost FROM events_log GROUP BY idcase;
SELECT idcase, SUM(cost) AS total_cost FROM events_log GROUP BY idcase;
SELECT idcase, SUM(cost) AS total_cost FROM events_log GROUP BY idcase;
SELECT idcase, SUM(cost) AS total_cost FROM events_log GROUP BY idcase;
SELECT idcase, SUM(cost) AS total_cost FROM events_log GROUP BY idcase;
SELECT idcase, SUM(cost) AS total_costs FROM events_log GROUP BY idcase;
SELECT idcase, SUM(cost) AS total_cost FROM events_log GROUP BY idcase;
SELECT idcase, SUM(cost) as total_cost FROM events_log GROUP BY idcase;
SELECT idcase, SUM(cost) as total_cost FROM events_log WHERE activity = 'declaration' GROUP BY idcase;
SELECT resource, COUNT(*) as num_events FROM events_log GROUP BY resource HAVING COUNT(*) >= 100 ORDER BY num_events DESC;
SELECT resource, COUNT(*) as num_events FROM events_log GROUP BY resource HAVING COUNT(*) >= 100 ORDER BY num_events DESC;
SELECT activity, COUNT(activity) as num_actions FROM events_log GROUP BY activity HAVING num_actions >= 100 ORDER BY num_actions DESC;
SELECT * FROM events_log ORDER BY idcase, timestamp;
SELECT * FROM events_log ORDER BY idcase, timestamp;
SELECT idcase, activity, timestamp FROM events_log ORDER BY idcase, timestamp;
SELECT idcase, activity, timestamp FROM events_log ORDER BY idcase, timestamp;
SELECT idcase, activity, timestamp, resource, cost FROM events_log ORDER BY idcase, timestamp;
SELECT * FROM events_log WHERE activity = 'declaration' ORDER BY idcase, timestamp;
SELECT resource, COUNT(*) as num_activities FROM events_log WHERE activity = 'declaration approved by administration' GROUP BY resource;
SELECT resource, COUNT(*) AS total_count FROM events_log WHERE activity = 'declaration approved by administration' GROUP BY resource;
SELECT resource, COUNT(*) AS total_count FROM events_log WHERE activity = 'declaration approved by administration' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity = 'declaration approved by administration' GROUP BY resource;
SELECT resource, COUNT(*) as approval_count FROM events_log WHERE activity = 'approve declaration' AND resource LIKE '%administrator%' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity = 'declaration approved by administration' GROUP BY resource;
SELECT resource, COUNT(*) AS num_events FROM events_log WHERE activity = 'declaration approved by administration' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) as num_approvals FROM events_log WHERE activity = 'approve_declaration' AND resource LIKE 'employee%' GROUP BY resource;
SELECT activity, COUNT(*) as instances FROM events_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31' GROUP BY activity;
SELECT activity, COUNT(*) as num_occurrences FROM events_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31' GROUP BY activity;
SELECT activity, COUNT(*) as num_occurrences FROM events_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31' GROUP BY activity;
SELECT activity, COUNT(activity) as count FROM events_log WHERE activity IN ('declaration_processing_action1', 'declaration_processing_action2', 'declaration_processing_action3') AND timestamp BETWEEN '2017-01-01' AND '2017-12-31' AND resource = 'Thomas' GROUP BY activity;
SELECT COUNT(*) FROM events_log WHERE resource = 'Thomas' AND strftime('%Y', timestamp) = '2017'
SELECT COUNT(activity) FROM events_log WHERE resource = 'Thomas' AND timestamp LIKE '2017%'
SELECT COUNT(activity) FROM events_log WHERE resource = 'Thomas' AND strftime('%Y', timestamp) = '2017';
SELECT COUNT(*) FROM events_log WHERE resource = 'Thomas' AND strftime('%Y', timestamp) = '2017';
SELECT COUNT(*) FROM events_log WHERE resource = 'Thomas' AND strftime('%Y', timestamp) = '2017';
SELECT activity, COUNT(activity) as workload FROM events_log WHERE resource = 'Thomas' AND timestamp LIKE '2017%' GROUP BY activity;
SELECT activity, MAX(timestamp) AS most_recent_date FROM events_log GROUP BY activity;
SELECT activity, MAX(timestamp) as most_recent_date FROM events_log GROUP BY activity;
SELECT activity, MAX(timestamp) FROM events_log GROUP BY activity;
SELECT activity, MAX(timestamp) FROM events_log GROUP BY activity;
SELECT activity, MAX(timestamp) FROM events_log GROUP BY activity;
SELECT activity, MAX(timestamp) AS last_occurrence FROM events_log GROUP BY activity;
SELECT activity, MAX(timestamp) as most_recent_date FROM events_log GROUP BY activity;
SELECT activity, MAX(timestamp) as last_date FROM events_log WHERE activity = 'processing declarations' GROUP BY activity;
SELECT activity, COUNT(*) FROM events_log WHERE (activity = 'declaration approved by supervisor' OR activity = 'permit rejected by employee') AND timestamp BETWEEN '2017-01-01' AND '2018-12-31' GROUP BY activity;
SELECT activity, COUNT(*) FROM events_log WHERE activity = 'declaration approved by supervisor' AND strftime('%Y', timestamp) = '2017' UNION SELECT activity, COUNT(*) FROM events_log WHERE activity = 'permit rejected by employee' AND strftime('%Y', timestamp) = '2018';
SELECT activity, COUNT(*) FROM events_log WHERE (activity = 'declaration approved by supervisor' AND strftime('%Y', timestamp) = '2017') OR (activity = 'permit rejected by employee' AND strftime('%Y', timestamp) = '2018') GROUP BY activity;
SELECT activity, COUNT(*) FROM events_log WHERE (activity = 'declaration approved by supervisor' AND strftime('%Y', timestamp) = '2017') OR (activity = 'permit rejected by employee' AND strftime('%Y', timestamp) = '2018') GROUP BY activity;
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration approved by supervisor' AND strftime('%Y', timestamp) = '2017' SELECT COUNT(*) FROM events_log WHERE activity = 'permit rejected by employee' AND strftime('%Y', timestamp) = '2018'
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration approval' AND timestamp LIKE '2017%' OR activity = 'permit rejection' AND timestamp LIKE '2018%' AND resource = 'employee';
SELECT activity, timestamp, id FROM events_log ORDER BY timestamp;
SELECT activity, timestamp, id FROM events_log ORDER BY timestamp;
SELECT activity, timestamp, id FROM events_log WHERE activity = 'processing declarations' ORDER BY timestamp;
SELECT COUNT(*) FROM events_log WHERE resource = 'Thomas' AND activity = 'declaration submitted by employee';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration submitted by employee' AND resource = 'Thomas';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration submitted by employee' AND resource = 'Thomas';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration submitted by employee' AND resource = 'Thomas';
SELECT COUNT(*) FROM events_log WHERE resource = 'Thomas' AND activity = 'declaration submitted by employee';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration request' AND resource = 'Thomas';
SELECT COUNT(*) FROM events_log WHERE resource = 'Diana' AND cost IS NOT NULL;
SELECT COUNT(*) FROM events_log WHERE resource = 'Diana' AND cost IS NOT NULL;
SELECT COUNT(*) FROM events_log WHERE resource = 'Diana' AND cost IS NOT NULL;
SELECT * FROM events_log WHERE activity = 'processing declarations' AND resource = 'Diana' AND cost IS NOT NULL;
SELECT activity, COUNT(*) FROM events_log WHERE resource = 'Diana' AND cost IS NOT NULL GROUP BY activity;
SELECT activity, COUNT(*) as event_count FROM events_log WHERE resource = 'Diana' AND cost = 'existence' GROUP BY activity;
SELECT activity FROM events_log WHERE resource = 'Diana' AND activity LIKE '%processing declarations%' AND cost IS NOT NULL;
SELECT COUNT(DISTINCT resource) FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3 )
SELECT COUNT(DISTINCT resource) FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3 )
SELECT COUNT(DISTINCT resource) FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3 )
SELECT COUNT(DISTINCT resource) as num_resources FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3 )
SELECT COUNT(DISTINCT resource) FROM events_log WHERE activity = 'processing declarations' AND idcase IN ( SELECT idcase FROM events_log WHERE activity = 'intervention' GROUP BY idcase HAVING COUNT(DISTINCT id) > 3 )
SELECT DISTINCT resource FROM events_log WHERE activity = 'declaration rejected by pre-approver';
SELECT DISTINCT resource FROM events_log WHERE activity = 'declaration rejected by pre-approver';
SELECT DISTINCT resource FROM events_log WHERE activity = 'declaration rejected by pre-approver';
SELECT DISTINCT resource FROM events_log WHERE activity = 'declaration rejected by pre-approver';
SELECT DISTINCT resource FROM events_log WHERE activity = 'declaration rejected by pre-approver';
SELECT DISTINCT resource FROM events_log WHERE activity = 'declaration rejected by pre-approver';
SELECT DISTINCT resource FROM events_log WHERE activity = 'pre-approval' AND cost = 'reject';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'declaration final approved by director' AND timestamp BETWEEN '2017-01-01' AND '2017-05-31';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'declaration final approved by director' AND timestamp >= '2017-01-01' AND timestamp <= '2017-05-31';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'declaration final approved by director' AND timestamp >= '2017-01-01' AND timestamp <= '2017-05-31';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration final approved by a director' AND timestamp BETWEEN '2017-01-01' AND '2017-05-31';
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Charles' AND timestamp NOT LIKE '2018-01%'
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Charles' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE strftime('%Y-%m', timestamp) = '2018-01' )
SELECT idcase FROM events_log WHERE resource = 'Charles' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE strftime('%Y-%m', timestamp) = '2018-01' )
SELECT DISTINCT resource FROM events_log WHERE resource = 'Charles' AND strftime('%Y-%m', timestamp) != '2018-01';
SELECT id, activity, timestamp, resource, cost, idcase FROM events_log WHERE resource = 'Charles' AND timestamp NOT LIKE '2018-01%'
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT idcase, COUNT(DISTINCT activity) as intervention_count FROM events_log GROUP BY idcase HAVING intervention_count > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(id) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(id) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(id) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(id) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3;
SELECT activity, COUNT(*) as intervention_count FROM events_log WHERE activity = 'declaration' GROUP BY activity HAVING COUNT(*) > 3;
SELECT idcase, MAX(timestamp) - MIN(timestamp) AS duration FROM events_log GROUP BY idcase;
SELECT idcase, SUM(cost) AS total_time FROM events_log GROUP BY idcase;
SELECT idcase, MAX(timestamp) - MIN(timestamp) AS duration FROM events_log GROUP BY idcase;
SELECT idcase, MAX(timestamp) - MIN(timestamp) AS duration FROM events_log GROUP BY idcase;
SELECT idcase, MAX(timestamp) - MIN(timestamp) AS duration FROM events_log GROUP BY idcase;
SELECT idcase, MAX(timestamp) - MIN(timestamp) AS duration FROM events_log GROUP BY idcase;
SELECT idcase, resource FROM events_log GROUP BY idcase, resource HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase, resource FROM events_log GROUP BY idcase, resource HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase, resource FROM events_log GROUP BY idcase, resource HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase, resource FROM events_log GROUP BY idcase, resource HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase, resource FROM events_log GROUP BY idcase, resource HAVING COUNT(DISTINCT activity) = 1;
SELECT idcase, resource FROM events_log GROUP BY idcase, resource HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase, resource FROM events_log GROUP BY idcase, resource HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase, resource FROM events_log GROUP BY idcase, resource HAVING COUNT(DISTINCT activity) = 1;
SELECT idcase, resource FROM events_log GROUP BY idcase, resource HAVING COUNT(DISTINCT resource) = 1;
SELECT activity, COUNT(DISTINCT idcase) as num_cases, resource FROM events_log GROUP BY resource HAVING COUNT(DISTINCT idcase) = 1;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT idcase FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT idcase FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT id, activity, timestamp, resource, cost, idcase FROM events_log WHERE activity = 'end of trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT * FROM events_log WHERE activity LIKE '%rejected%';
SELECT * FROM events_log WHERE activity LIKE '%rejected%';
SELECT * FROM events_log WHERE activity LIKE '%rejected%';
SELECT * FROM events_log WHERE activity LIKE '%rejected%';
SELECT * FROM events_log WHERE activity LIKE '%rejected%';
SELECT * FROM events_log WHERE activity LIKE '%rejected%';
SELECT * FROM events_log WHERE activity = 'rejection'
SELECT activity, timestamp, resource, cost, idcase FROM events_log WHERE activity = 'rejection intervention';
SELECT idcase, MIN(cost) AS min_cost, MAX(cost) AS max_cost FROM events_log WHERE max_cost > 0 GROUP BY idcase;
SELECT idcase, MIN(cost) as min_cost, MAX(cost) as max_cost FROM events_log GROUP BY idcase HAVING MAX(cost) > 0;
SELECT idcase, MIN(cost) as min_cost, MAX(cost) as max_cost FROM events_log GROUP BY idcase HAVING MAX(cost) > 0;
SELECT idcase, MIN(cost) as min_cost, MAX(cost) as max_cost FROM events_log GROUP BY idcase HAVING MAX(cost) > 0;
SELECT idcase, MIN(cost) as min_cost, MAX(cost) as max_cost FROM events_log GROUP BY idcase HAVING MAX(cost) > 0;
SELECT idcase, MIN(cost) as min_cost, MAX(cost) as max_cost FROM events_log WHERE max_cost > 0 GROUP BY idcase;
SELECT idcase, MIN(cost) as min_cost, MAX(cost) as max_cost FROM events_log WHERE max_cost > 0 GROUP BY idcase;
SELECT idcase, MIN(cost) as min_cost, MAX(cost) as max_cost FROM events_log WHERE max_cost > 0 GROUP BY idcase;
SELECT idcase, MIN(cost) as min_cost, MAX(cost) as max_cost FROM events_log GROUP BY idcase HAVING MAX(cost) > 0;
SELECT idcase, MIN(cost) as min_cost, MAX(cost) as max_cost FROM events_log WHERE max_cost > 0 GROUP BY idcase;
SELECT idcase, MIN(cost) as min_cost, MAX(cost) as max_cost FROM events_log WHERE max_cost > 0 GROUP BY idcase;
SELECT idcase, MIN(cost) as min_cost, MAX(cost) as max_cost FROM events_log GROUP BY idcase HAVING MAX(cost) > 0;
SELECT idcase, MIN(activity) AS min_interventions, MAX(activity) AS max_interventions FROM events_log WHERE cost > 0 GROUP BY idcase;
SELECT idcase, MIN(cost) as min_cost, MAX(cost) as max_cost FROM events_log WHERE max_cost > 0 GROUP BY idcase;
SELECT idcase, MIN(timestamp) as start_time, MAX(timestamp) as end_time, (MAX(timestamp) - MIN(timestamp)) as duration FROM events_log WHERE activity IN ('end trip', 'declaration rejected by employee', 'payment handled') GROUP BY idcase;
SELECT MAX(timestamp) - MIN(timestamp) AS duration FROM events_log WHERE activity IN ('end trip', 'declaration rejected by employee', 'payment handled') GROUP BY idcase;
SELECT idcase, MIN(timestamp) AS start_time, MAX(CASE WHEN activity IN ('end trip', 'declaration rejected by employee', 'payment handled') THEN timestamp END) AS end_time, JULIANDAY(MAX(CASE WHEN activity IN ('end trip', 'declaration rejected by employee', 'payment handled') THEN timestamp END)) - JULIANDAY(MIN(timestamp)) AS elapsed_time FROM events_log GROUP BY idcase;
SELECT MIN(timestamp) as start_time, MAX(timestamp) as end_time FROM events_log WHERE activity IN ('declaration_started', 'trip_finalized', 'declaration_rejected', 'payment_made')
SELECT MAX(timestamp) - MIN(timestamp) AS trip_duration FROM events_log WHERE activity = 'end of trip' OR activity = 'declaration rejected' OR activity = 'payment made' GROUP BY idcase;
SELECT idcase, MIN(timestamp) AS start_time, MAX(CASE WHEN activity = 'end trip' THEN timestamp END) AS end_trip_time, MAX(CASE WHEN activity = 'declaration rejected by employee' OR activity = 'payment handled' THEN timestamp END) AS final_activity_time, CASE WHEN activity = 'end trip' THEN 'end trip' WHEN activity = 'declaration rejected by employee' THEN 'declaration rejected by employee' WHEN activity = 'payment handled' THEN 'payment handled' END AS final_activity FROM events_log GROUP BY idcase;
SELECT idcase, activity as end_activity, MAX(timestamp) - MIN(timestamp) as duration FROM events_log WHERE activity IN ('end trip', 'declaration rejected by employee', 'payment handled') GROUP BY idcase;
SELECT idcase, activity, MIN(timestamp) as start_time, MAX(timestamp) as end_time, julianday(MAX(timestamp)) - julianday(MIN(timestamp)) as duration FROM events_log WHERE activity IN ('end trip', 'declaration rejected by employee', 'payment handled') GROUP BY idcase;
SELECT idcase, activity, (strftime('%s', MAX(timestamp)) - strftime('%s', MIN(timestamp))) as elapsed_time FROM events_log WHERE activity IN ('end trip', 'declaration rejected by employee', 'payment handled') GROUP BY idcase, activity;
SELECT MAX(timestamp) - MIN(timestamp) AS processing_time FROM events_log WHERE activity = 'start_processing_declaration' OR activity = 'end_trip_recorded' OR activity = 'rejected_by_employee' OR activity = 'payment_made';
SELECT * FROM events_log WHERE activity = 'request payment';
SELECT * FROM events_log WHERE activity = 'request payment';
SELECT * FROM events_log WHERE activity = 'payment request';
SELECT * FROM events_log WHERE activity = 'payment' AND resource = 'declaration';
SELECT activity, AVG(timestamp) as mean_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as avg_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as mean_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as avg_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as mean_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as mean_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as average_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as average_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as average_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as average_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as avg_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as mean_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as mean_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as mean_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as mean_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as average_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as mean_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as mean_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as mean_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as mean_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as average_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as average_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as average_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as average_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as average_duration FROM events_log GROUP BY activity;
SELECT activity, AVG(timestamp) as average_duration FROM events_log GROUP BY activity;
SELECT idcase, SUM(cost) as total_cost FROM events_log GROUP BY idcase ORDER BY total_cost DESC;
SELECT idcase, SUM(cost) as total_cost FROM events_log GROUP BY idcase ORDER BY total_cost DESC;
SELECT idcase FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT idcase FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log)
SELECT * FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT idcase, SUM(cost) as total_cost FROM events_log GROUP BY idcase ORDER BY total_cost DESC;
SELECT resource, SUM(cost) as total_cost FROM events_log GROUP BY resource ORDER BY total_cost DESC LIMIT 1;
SELECT * FROM events_log ORDER BY cost DESC;
SELECT * FROM events_log ORDER BY cost DESC;
SELECT * FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT * FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT * FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT * FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT * FROM events_log ORDER BY cost DESC;
SELECT * FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT * FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT * FROM events_log ORDER BY cost DESC LIMIT 1;
SELECT * FROM events_log ORDER BY cost DESC;
SELECT * FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT * FROM events_log ORDER BY cost DESC;
SELECT * FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT * FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT * FROM events_log ORDER BY cost DESC LIMIT 1;
SELECT activity FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start trip';
SELECT * FROM events_log WHERE activity = 'start of the trip';
SELECT * FROM events_log WHERE activity = 'start_trip';
SELECT activity, COUNT(*) AS total_records FROM events_log GROUP BY activity;
SELECT activity, COUNT(*) AS total_performances FROM events_log GROUP BY activity;
SELECT activity, COUNT(*) AS total_performances FROM events_log GROUP BY activity;
SELECT activity, COUNT(*) AS event_count FROM events_log GROUP BY activity;
SELECT activity, COUNT(activity) FROM events_log GROUP BY activity;
SELECT activity, COUNT(activity) as num_performances FROM events_log GROUP BY activity;
SELECT activity, COUNT(*) AS event_count FROM events_log GROUP BY activity;
SELECT activity, COUNT(*) AS event_count FROM events_log GROUP BY activity;
SELECT activity, COUNT(*) as num_events FROM events_log GROUP BY activity;
SELECT activity, COUNT(id) as event_count FROM events_log GROUP BY activity;
SELECT activity, COUNT(*) as num_events FROM events_log GROUP BY activity;
SELECT activity, COUNT(*) as num_events FROM events_log GROUP BY activity;
SELECT activity, COUNT(*) AS total_performances FROM events_log GROUP BY activity;
SELECT activity, COUNT(*) AS total_performances FROM events_log GROUP BY activity;
SELECT activity, COUNT(*) as event_count FROM events_log GROUP BY activity;
SELECT activity, COUNT(activity) as activity_count FROM events_log GROUP BY activity;
SELECT activity, COUNT(*) as num_performances FROM events_log GROUP BY activity;
SELECT activity, COUNT(id) as num_interventions FROM events_log GROUP BY activity;
SELECT activity, COUNT(activity) as action_count FROM events_log GROUP BY activity;
SELECT activity, COUNT(id) AS num_interventions FROM events_log GROUP BY activity;
SELECT activity, COUNT(*) AS num_interventions FROM events_log WHERE activity = 'intervention' GROUP BY activity;
SELECT activity, COUNT(*) AS intervention_count FROM events_log WHERE activity LIKE 'intervention%' GROUP BY activity;
SELECT activity, COUNT(*) AS num_interventions FROM events_log WHERE activity = 'declaration' GROUP BY activity;
SELECT activity, COUNT(*) AS intervention_count FROM events_log WHERE activity LIKE '%declaration%' GROUP BY activity;
SELECT activity, cost FROM events_log ORDER BY cost;
SELECT activity, cost FROM events_log ORDER BY cost;
SELECT activity, cost FROM events_log ORDER BY cost;
SELECT activity, cost FROM events_log ORDER BY cost;
SELECT cost, activity FROM events_log ORDER BY cost;
SELECT cost, activity FROM events_log ORDER BY cost;
SELECT activity, SUM(cost) as total_cost FROM events_log GROUP BY activity ORDER BY total_cost DESC;
SELECT activity, SUM(cost) AS total_cost FROM events_log WHERE activity LIKE '%declaration%' GROUP BY activity ORDER BY total_cost DESC;
SELECT * FROM events_log WHERE activity = 'permit';
SELECT activity, cost FROM events_log WHERE activity = 'permit';
SELECT * FROM events_log WHERE activity = 'permit';
SELECT * FROM events_log WHERE activity = 'permit';
SELECT * FROM events_log WHERE activity = 'permit';
SELECT activity, cost FROM events_log WHERE activity = 'permit';
SELECT id, activity, timestamp, resource, cost, idcase FROM events_log WHERE activity = 'permit';
SELECT * FROM events_log WHERE activity = 'permit';
SELECT cost FROM events_log WHERE activity = 'permit';
SELECT * FROM events_log WHERE activity = 'permit';
SELECT activity FROM events_log WHERE activity = 'permit' AND idcase IN ( SELECT idcase FROM events_log WHERE activity = 'declaration' )
SELECT * FROM events_log WHERE activity = 'permit interventions' AND idcase IN ( SELECT idcase FROM events_log WHERE activity = 'processing of a declaration' )
SELECT MAX(cost) FROM events_log;
SELECT MAX(cost) FROM events_log;
SELECT MAX(cost) FROM events_log;
SELECT MAX(cost) FROM events_log;
SELECT MAX(cost) FROM events_log;
SELECT MAX(cost) FROM events_log WHERE activity = 'intervention';
SELECT idcase FROM events_log WHERE resource = 'Sara' AND idcase IN (SELECT idcase FROM events_log WHERE resource = 'Thomas');
SELECT idcase FROM events_log WHERE resource = 'Sara' AND idcase IN (SELECT idcase FROM events_log WHERE resource = 'Thomas');
SELECT DISTINCT idcase FROM events_log WHERE resource IN ('Sara', 'Thomas');
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Sara' OR resource = 'Thomas';
SELECT DISTINCT idcase FROM events_log WHERE resource IN ('Sara', 'Thomas') GROUP BY idcase HAVING COUNT(DISTINCT resource) = 2;
SELECT idcase FROM events_log WHERE activity = 'declaration' AND idcase IN ( SELECT idcase FROM events_log WHERE resource = 'Sara' ) AND idcase IN ( SELECT idcase FROM events_log WHERE resource = 'Thomas' );
SELECT resource, COUNT(*) FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource;
SELECT resource, COUNT(*) AS num_activities FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource;
SELECT resource, COUNT(*) as instances FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource;
SELECT resource, COUNT(*) AS num_activities FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource;
SELECT resource, COUNT(*) AS num_occurrences FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource;
SELECT resource, COUNT(*) AS num_instances FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource;
SELECT resource, COUNT(*) AS num_rejections FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource;
SELECT resource, COUNT(*) as num_events FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource;
SELECT resource, COUNT(*) as rejections FROM events_log WHERE activity = 'reject declaration' AND role = 'administrator' GROUP BY resource;
SELECT resource, idcase, COUNT(*) AS num_activities FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource, idcase;
SELECT resource, idcase, COUNT(*) FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource, idcase;
SELECT resource, idcase, COUNT(*) AS num_activities FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource, idcase;
SELECT resource, idcase, COUNT(*) as instances FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource, idcase;
SELECT resource, COUNT(*) as count FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource, idcase;
SELECT resource, COUNT(*) FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource, idcase;
SELECT resource, idcase, COUNT(*) FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource, idcase;
SELECT resource, activity, idcase, COUNT(*) as num_times FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource, activity, idcase;
SELECT resource, idcase, COUNT(*) as num_events FROM events_log WHERE activity = 'declaration rejected by administration' GROUP BY resource, idcase;
SELECT resource, COUNT(activity) FROM events_log WHERE activity = 'reject_declaration' GROUP BY resource;
SELECT AVG(cost) FROM events_log WHERE activity NOT IN ('start trip', 'end trip');
SELECT AVG(cost) FROM events_log WHERE activity NOT IN ('start trip', 'end trip');
SELECT AVG(cost) FROM events_log WHERE activity NOT IN ('start trip', 'end trip');
SELECT AVG(cost) FROM events_log WHERE activity NOT IN ('start trip', 'end trip');
SELECT AVG(cost) FROM events_log WHERE activity NOT IN ('start trip', 'end trip');
SELECT AVG(cost) FROM events_log WHERE activity NOT IN ('start trip', 'end trip');
SELECT AVG(cost) FROM events_log WHERE activity NOT IN ('start trip', 'end trip');
SELECT AVG(cost) FROM events_log WHERE activity NOT IN ('start trip', 'end trip');
SELECT AVG(cost) FROM events_log WHERE activity NOT IN ('start trip', 'end trip');
SELECT AVG(cost) FROM events_log WHERE activity NOT IN ('Trip Start', 'Trip End');
SELECT id, activity, timestamp, resource, cost, idcase FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT * FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT * FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT * FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT * FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT activity, timestamp, resource, cost, idcase FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT * FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT * FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT * FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT * FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT * FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT * FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT * FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT * FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT * FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT activity, cost FROM events_log WHERE activity = 'intervention' ORDER BY cost DESC LIMIT 5;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(id) > 1;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(id) > 1;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(id) > 1;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 1;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 1;
SELECT idcase, COUNT(DISTINCT activity) as interventions FROM events_log GROUP BY idcase HAVING interventions > 1;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 1;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase, activity HAVING COUNT(activity) > 1;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase, activity HAVING COUNT(activity) > 1;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 1;
SELECT idcase, activity FROM events_log GROUP BY idcase, activity HAVING COUNT(*) > 1;
SELECT * FROM events_log WHERE date(timestamp) IN ('2018-10-01', '2018-10-02');
SELECT * FROM events_log WHERE timestamp LIKE '2018-10-01%' OR timestamp LIKE '2018-10-02%';
SELECT * FROM events_log WHERE date(timestamp) IN ('2018-10-01', '2018-10-02');
SELECT * FROM events_log WHERE date(timestamp) IN ('2018-10-01', '2018-10-02');
SELECT * FROM events_log WHERE date(timestamp) IN ('2018-10-01', '2018-10-02');
SELECT * FROM events_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-02';
SELECT * FROM events_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-02';
SELECT * FROM events_log WHERE date(timestamp) IN ('2018-10-01', '2018-10-02');
SELECT activity FROM events_log WHERE timestamp >= '2018-10-01' AND timestamp < '2018-10-02';
SELECT * FROM events_log WHERE date(timestamp) = '2018-10-01' OR date(timestamp) = '2018-10-02';
SELECT * FROM events_log WHERE timestamp >= '2018-10-01' AND timestamp < '2018-10-03';
SELECT * FROM events_log WHERE date(timestamp) = '2018-10-01' OR date(timestamp) = '2018-10-02';
SELECT * FROM events_log WHERE date(timestamp) = '2018-10-01' OR date(timestamp) = '2018-10-02';
SELECT * FROM events_log WHERE timestamp >= '2018-10-01' AND timestamp < '2018-10-03';
SELECT * FROM events_log WHERE timestamp >= '2018-10-01' AND timestamp < '2018-10-03';
SELECT * FROM events_log WHERE timestamp >= '2018-10-01' AND timestamp < '2018-10-03';
SELECT activity, timestamp, resource, cost FROM events_log WHERE timestamp >= '2018-10-01' AND timestamp < '2018-10-02';
SELECT activity FROM events_log WHERE timestamp >= '2018-10-01' AND timestamp < '2018-10-02';
SELECT activity FROM events_log WHERE timestamp >= '2018-10-01' AND timestamp < '2018-10-02';
SELECT * FROM events_log WHERE resource LIKE 'M%';
SELECT * FROM events_log WHERE resource LIKE 'M%';
SELECT * FROM events_log WHERE resource LIKE 'M%'
SELECT * FROM events_log WHERE resource LIKE 'M%';
SELECT * FROM events_log WHERE resource LIKE 'M%'
SELECT activity, timestamp, resource, cost, idcase FROM events_log WHERE resource LIKE 'M%'
SELECT activity FROM events_log WHERE resource = 'declarations' AND activity LIKE 'M%' ;
SELECT * FROM events_log WHERE activity = 'intervention' AND resource LIKE 'M%';
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT activity, COUNT(activity) as activity_count FROM events_log GROUP BY activity HAVING COUNT(activity) > 5;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(activity) > 5;
SELECT activity, COUNT(*) as occurrences FROM events_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT activity, COUNT(activity) as activity_count FROM events_log GROUP BY activity HAVING COUNT(activity) > 5;
SELECT activity, COUNT(activity) as num_actions FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log WHERE activity = 'processing of declarations' ) GROUP BY activity HAVING COUNT(activity) > 5;
SELECT activity FROM events_log GROUP BY activity, idcase HAVING COUNT(*) > 3;
SELECT activity, COUNT(activity) as activity_count FROM events_log GROUP BY activity, idcase HAVING COUNT(activity) > 3;
SELECT activity FROM events_log GROUP BY activity, idcase HAVING COUNT(*) > 3;
SELECT activity FROM events_log GROUP BY activity, idcase HAVING COUNT(*) > 3;
SELECT activity FROM events_log GROUP BY activity, idcase HAVING COUNT(activity) > 3;
SELECT activity FROM events_log GROUP BY activity, idcase HAVING COUNT(*) > 3;
SELECT activity FROM events_log GROUP BY activity, idcase HAVING COUNT(activity) > 3;
SELECT activity, idcase FROM events_log GROUP BY activity, idcase HAVING COUNT(*) > 3;
SELECT activity FROM events_log GROUP BY activity, idcase HAVING COUNT(*) > 3;
SELECT activity, idcase FROM events_log GROUP BY activity, idcase HAVING COUNT(*) > 3;
SELECT activity, COUNT(activity) as num_occurrences FROM events_log GROUP BY activity HAVING COUNT(activity) > 3;
SELECT COUNT(*) FROM events_log WHERE idcase = 'declaration 56300';
SELECT COUNT(*) FROM events_log WHERE idcase = 'declaration 56300';
SELECT COUNT(*) FROM events_log WHERE idcase = 'declaration 56300';
SELECT COUNT(*) FROM events_log WHERE idcase = 'declaration 56300';
SELECT COUNT(*) FROM events_log WHERE idcase = 'declaration 56300';
SELECT COUNT(*) FROM events_log WHERE idcase = 'declaration 56300';
SELECT * FROM events_log WHERE idcase = 56300;
SELECT activity, COUNT(activity) as num_performed FROM events_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(activity) > 1;
SELECT activity, COUNT(activity) as num_times FROM events_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(activity) > 1;
SELECT activity, COUNT(activity) as num_times FROM events_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(activity) > 1;
SELECT activity, COUNT(activity) as num_performed FROM events_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(activity) > 1;
SELECT activity, COUNT(activity) as num_times FROM events_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(activity) > 1;
SELECT activity, COUNT(activity) as num_times FROM events_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(activity) > 1;
SELECT activity, COUNT(activity) as num_times FROM events_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(activity) > 1;
SELECT activity, COUNT(activity) as num_times FROM events_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(activity) > 1;
SELECT activity, COUNT(activity) as num_times FROM events_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(activity) > 1;
SELECT activity, COUNT(activity) FROM events_log WHERE timestamp < '2017-10-01' GROUP BY activity;
SELECT activity, COUNT(activity) as num_occurrences FROM events_log WHERE timestamp < '2017-01-10' GROUP BY activity HAVING COUNT(activity) > 1;
SELECT resource, COUNT(DISTINCT idcase) AS cases_count FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS process_instances FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) as num_cases FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS cases_allocated FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) as process_instances FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS process_instances FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS declarations_worked_on FROM events_log GROUP BY resource;
SELECT resource, COUNT(*) AS event_count FROM events_log GROUP BY resource;
SELECT resource, COUNT(resource) AS allocation_count FROM events_log GROUP BY resource;
SELECT resource, COUNT(*) AS num_actions FROM events_log GROUP BY resource;
SELECT resource, COUNT(*) as num_events FROM events_log GROUP BY resource;
SELECT resource, COUNT(resource) as num_occurrences FROM events_log GROUP BY resource;
SELECT resource, COUNT(activity) AS activity_count FROM events_log GROUP BY resource;
SELECT resource, COUNT(resource) as num_occurrences FROM events_log GROUP BY resource;
SELECT resource, COUNT(*) AS interventions_count FROM events_log WHERE activity = 'intervention' GROUP BY resource;
SELECT DISTINCT idcase FROM events_log WHERE resource IN ('Thomas', 'Diana', 'Sara');
SELECT DISTINCT idcase FROM events_log WHERE resource IN ('Thomas', 'Diana', 'Sara');
SELECT DISTINCT idcase FROM events_log WHERE resource IN ('Thomas', 'Diana', 'Sara');
SELECT DISTINCT idcase FROM events_log WHERE resource IN ('Thomas', 'Diana', 'Sara');
SELECT DISTINCT activity FROM events_log WHERE resource IN ('Thomas', 'Diana', 'Sara');
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS process_instances FROM events_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS process_instances FROM events_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) as cases_count FROM events_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource;
SELECT resource, COUNT(id) as declarations_processed FROM events_log WHERE activity = 'processed' AND timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE timestamp BETWEEN '2017-01-05' AND '2017-01-06' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'declaration' AND timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource;
SELECT activity, resource FROM events_log WHERE resource NOT IN ('Joshua', 'Teresa');
SELECT activity, resource FROM events_log WHERE resource NOT IN ('Joshua', 'Teresa');
SELECT activity, resource FROM events_log WHERE resource NOT IN ('Joshua', 'Teresa');
SELECT activity, resource FROM events_log WHERE activity = 'intervention' AND resource NOT IN ('Joshua', 'Teresa');
SELECT activity, resource FROM events_log WHERE activity = 'interventions' AND resource NOT IN ('Joshua', 'Teresa');
SELECT DISTINCT idcase FROM events_log WHERE activity IN ('start trip', 'end trip') AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity IN ('request payment', 'payment handled') )
SELECT DISTINCT idcase FROM events_log WHERE activity IN ('start trip', 'end trip') AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity IN ('request payment', 'payment handled') )
SELECT DISTINCT idcase FROM events_log WHERE activity IN ('start trip', 'end trip') AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity IN ('request payment', 'payment handled') )
SELECT DISTINCT idcase FROM events_log WHERE activity IN ('start trip', 'trip end') AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity IN ('request payment', 'payment handled') )
SELECT DISTINCT idcase FROM events_log WHERE activity IN ('start trip', 'end trip') AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity IN ('request payment', 'payment handled') )
SELECT DISTINCT idcase FROM events_log WHERE activity IN ('started', 'completed') AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'payment_requested' OR activity = 'payment_made' )
SELECT DISTINCT idcase FROM events_log WHERE activity IN ('beginning of the trip', 'end of the trip') AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity IN ('payment request', 'payment execution') )
SELECT idcase FROM events_log WHERE activity = 'begin_trip' OR activity = 'end_trip' GROUP BY idcase HAVING COUNT(DISTINCT activity) < 2;
SELECT idcase FROM events_log WHERE activity = 'travel declaration' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'payment request' OR activity = 'payment execution' )
SELECT DISTINCT idcase FROM events_log WHERE activity IN ('trip_started', 'trip_ended') AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity IN ('payment_requested', 'payment_made') )
SELECT * FROM events_log WHERE resource IS NULL;
SELECT * FROM events_log WHERE resource IS NULL;
SELECT * FROM events_log WHERE resource IS NULL;
SELECT * FROM events_log WHERE resource IS NULL;
SELECT * FROM events_log WHERE resource IS NULL;
SELECT * FROM events_log WHERE resource IS NULL;
SELECT * FROM events_log WHERE resource IS NULL;
SELECT * FROM events_log WHERE activity = 'intervention' AND (resource IS NULL OR cost IS NULL);
SELECT DISTINCT idcase FROM events_log WHERE timestamp < '2017-03-01';
SELECT DISTINCT idcase FROM events_log WHERE timestamp < '2017-03-01';
SELECT idcase FROM events_log WHERE activity = (SELECT MIN(timestamp) FROM events_log WHERE activity = 'first performance') < '2017-03-01';
SELECT DISTINCT idcase FROM events_log WHERE timestamp < '2017-03-01';
SELECT DISTINCT idcase FROM events_log WHERE timestamp < '2017-03-01';
SELECT DISTINCT idcase FROM events_log WHERE activity = (SELECT MIN(timestamp) FROM events_log WHERE activity = 'performance') < '2017-03-01';
SELECT id, activity, timestamp, resource, cost, idcase FROM events_log WHERE timestamp < '2017-03-01';
SELECT id, activity, timestamp, resource, cost, idcase FROM events_log WHERE timestamp < '2017-03-01' ORDER BY timestamp LIMIT 1;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'intervention' AND timestamp < '2017-03-01';
SELECT * FROM events_log WHERE timestamp < '2017-03-01';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'start trip' AND timestamp >= '2017-03-01' AND timestamp < '2017-04-01';
SELECT idcase FROM events_log WHERE activity = 'start trip' AND timestamp BETWEEN '2017-03-01' AND '2017-03-31' ORDER BY timestamp;
SELECT idcase FROM events_log WHERE activity = 'start trip' AND timestamp >= '2017-03-01' AND timestamp < '2017-04-01';
SELECT idcase FROM events_log WHERE activity = 'start trip' AND strftime('%Y-%m', timestamp) = '2017-03' GROUP BY idcase;
SELECT idcase FROM events_log WHERE activity = 'start trip' AND timestamp BETWEEN '2017-03-01' AND '2017-03-31' GROUP BY idcase;
SELECT idcase FROM events_log WHERE activity = 'start trip' AND timestamp BETWEEN '2017-03-01' AND '2017-03-31' GROUP BY idcase;
SELECT id, activity, timestamp, resource, cost, idcase FROM events_log WHERE activity = 'start of the trip' AND timestamp >= '2017-03-01' AND timestamp < '2017-04-01';
SELECT resource, COUNT(resource) as num_actions FROM events_log GROUP BY resource, idcase HAVING COUNT(resource) > 5;
SELECT resource, COUNT(*) as num_events FROM events_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource, COUNT(resource) as num_actions FROM events_log GROUP BY resource, idcase HAVING COUNT(resource) > 5;
SELECT resource, COUNT(*) as num_actions FROM events_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource, COUNT(*) as num_events FROM events_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource, COUNT(activity) as num_events FROM events_log GROUP BY resource, idcase HAVING COUNT(activity) > 5;
SELECT resource, COUNT(resource) as num_allocations FROM events_log GROUP BY resource, idcase HAVING COUNT(resource) > 5;
SELECT resource, COUNT(resource) as num_actions FROM events_log WHERE activity = 'declaration' GROUP BY resource HAVING COUNT(resource) > 5;
SELECT resource, COUNT(resource) as num_activities FROM events_log WHERE activity = 'declaration' GROUP BY resource HAVING COUNT(resource) > 5;
SELECT resource, COUNT(DISTINCT activity) as num_interventions FROM events_log WHERE activity = 'intervention' GROUP BY resource, idcase HAVING COUNT(DISTINCT activity) > 5;
SELECT resource FROM events_log WHERE activity = 'declarations' GROUP BY resource HAVING COUNT(*) > 5;
SELECT activity, COUNT(activity) AS activity_count FROM events_log GROUP BY activity ORDER BY activity_count DESC;
SELECT activity, COUNT(activity) as activity_count FROM events_log GROUP BY activity ORDER BY activity_count DESC;
SELECT activity, COUNT(activity) as num_activities FROM events_log GROUP BY activity ORDER BY num_activities DESC LIMIT 1;
SELECT activity, COUNT(activity) AS frequency FROM events_log GROUP BY activity ORDER BY frequency DESC LIMIT 1;
SELECT activity, COUNT(activity) AS num_actions FROM events_log WHERE activity LIKE '%processing declarations%' GROUP BY activity ORDER BY num_actions DESC LIMIT 1;
SELECT resource, COUNT(*) as activity_count FROM events_log WHERE activity = 'declaration final approved by supervisor' GROUP BY resource ORDER BY activity_count DESC LIMIT 10;
SELECT resource, COUNT(resource) as total_usage FROM events_log WHERE activity = 'declaration final approved by supervisor' GROUP BY resource ORDER BY total_usage DESC LIMIT 10;
SELECT resource, COUNT(*) as approvals FROM events_log WHERE activity = 'declaration_approved' AND resource IN (SELECT resource FROM events_log WHERE activity = 'supervisor') GROUP BY resource ORDER BY approvals DESC LIMIT 10;
SELECT resource FROM events_log WHERE activity = 'declaration final approved by supervisor' GROUP BY resource ORDER BY COUNT(*) DESC;
SELECT resource, COUNT(*) as num_activities FROM events_log WHERE activity = 'declaration final approved by supervisor' GROUP BY resource ORDER BY num_activities DESC;
SELECT resource, COUNT(resource) as num_times FROM events_log WHERE activity = 'declaration final approved by supervisor' GROUP BY resource ORDER BY num_times DESC;
SELECT resource FROM events_log WHERE activity = 'declaration final approved by supervisor' GROUP BY resource ORDER BY COUNT(*) DESC;
SELECT e.employee_name FROM employees e JOIN events_log el ON e.employee_id = el.employee_id WHERE el.activity = 'declaration' AND e.position = 'supervisor' ORDER BY el.timestamp DESC;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'declaration approved by budget owner' AND (resource = 'Eugene' OR resource = 'Marie');
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE (resource = 'Eugene' OR resource = 'Marie') AND activity = 'declaration approved by budget owner';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'declaration approved by budget owner' AND (resource = 'Eugene' OR resource = 'Marie');
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'declaration approved by budget owner' AND (resource = 'Eugene' OR resource = 'Marie');
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'declaration approved by budget owner' AND resource IN ('Eugene', 'Marie');
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'declaration approved by budget owner' AND (resource = 'Eugine' OR resource = 'Marie');
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'declaration approved by budget owner' AND (resource = 'Eugine' OR resource = 'Marie');
SELECT COUNT(*) FROM events_log WHERE (activity = 'declaration approved' AND resource = 'Eugene') OR (activity = 'declaration approved' AND resource = 'Marie')
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration_approved' AND resource IN ('Eugene', 'Marie') AND cost > 0;
SELECT DISTINCT activity FROM events_log WHERE idcase = 'declaration 49464' AND activity NOT IN ( SELECT DISTINCT activity FROM events_log WHERE idcase = 'declaration 76667' )
SELECT DISTINCT activity FROM events_log WHERE idcase = 'declaration 49464' AND activity NOT IN ( SELECT activity FROM events_log WHERE idcase = 'declaration 76667' )
SELECT DISTINCT activity FROM events_log WHERE idcase = 'declaration 49464' AND activity NOT IN ( SELECT activity FROM events_log WHERE idcase = 'declaration 76667' )
SELECT activity FROM events_log WHERE idcase = 49464 EXCEPT SELECT activity FROM events_log WHERE idcase = 76667;
SELECT resource, COUNT(*) as num_occurrences FROM events_log WHERE activity = 'declaration submitted by employee' GROUP BY resource HAVING COUNT(*) > 2;
SELECT resource, COUNT(*) as performance_count FROM events_log WHERE activity = 'declaration submitted by employee' GROUP BY resource HAVING COUNT(*) > 2;
SELECT resource, COUNT(*) as performance_count FROM events_log WHERE activity = 'declaration submitted by employee' GROUP BY resource HAVING COUNT(*) > 2;
SELECT resource, COUNT(resource) as num_occurrences FROM events_log WHERE activity = 'declaration submitted by employee' GROUP BY resource HAVING COUNT(resource) > 2;
SELECT resource, COUNT(*) as num_occurrences FROM events_log WHERE activity = 'declaration submitted by employee' GROUP BY resource HAVING COUNT(*) > 2;
SELECT resource, COUNT(*) as num_events FROM events_log WHERE activity = 'declaration submitted by employee' GROUP BY resource HAVING COUNT(*) > 2;
SELECT employee_name, COUNT(*) as num_requests FROM events_log WHERE activity = 'declaration' GROUP BY employee_name HAVING COUNT(*) > 2;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'request payment' AND timestamp BETWEEN '2017-05-01' AND '2017-05-10';
SELECT idcase FROM events_log WHERE activity = 'request payment' AND timestamp >= '2017-05-01' AND timestamp < '2017-05-11';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'request payment' AND timestamp >= '2017-05-01' AND timestamp < '2017-05-11';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'request payment' AND timestamp BETWEEN '2017-05-01' AND '2017-05-10';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'request payment' AND timestamp BETWEEN '2017-05-01' AND '2017-05-10';
SELECT idcase FROM events_log WHERE activity = 'request payment' AND timestamp BETWEEN '2017-05-01' AND '2017-05-10';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Payment Request' AND timestamp BETWEEN '2017-05-01' AND '2017-05-10';
SELECT idcase FROM events_log WHERE activity = 'payment request' AND timestamp BETWEEN '2017-05-01' AND '2017-05-10';
SELECT idcase, COUNT(DISTINCT resource) as num_resources FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT resource) as num_resources FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT resource) AS num_resources FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT resource) AS num_resources FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT resource) AS num_resources FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT resource) AS num_resources FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT resource) as num_resources FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT resource) as num_employees FROM events_log GROUP BY idcase;
SELECT idcase FROM events_log WHERE resource = 'Christopher' GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase FROM events_log WHERE resource = 'Christopher' GROUP BY idcase HAVING COUNT(DISTINCT activity) = 3;
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Christopher'
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Christopher' GROUP BY idcase HAVING COUNT(DISTINCT activity) = (SELECT COUNT(DISTINCT activity) FROM events_log WHERE resource = 'Christopher')
SELECT idcase FROM events_log WHERE resource = 'Christopher' GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Christopher' EXCEPT SELECT DISTINCT idcase FROM events_log WHERE resource != 'Christopher';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'handled' AND resource = 'Christopher' GROUP BY idcase HAVING COUNT(DISTINCT activity) = 1;
SELECT activity FROM events_log WHERE resource = 'Christopher';
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase, COUNT(DISTINCT resource) as num_employees FROM events_log GROUP BY idcase HAVING num_employees > 1;
SELECT DISTINCT resource FROM events_log GROUP BY resource HAVING COUNT(DISTINCT idcase) = 1;
SELECT idcase FROM events_log GROUP BY idcase, date(timestamp) HAVING COUNT(DISTINCT date(timestamp)) > 1;
SELECT idcase FROM events_log GROUP BY idcase, strftime('%Y-%m-%d', timestamp) HAVING COUNT(*) > 1;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase, strftime('%Y-%m-%d', timestamp) HAVING COUNT(*) > 1;
SELECT idcase, COUNT(DISTINCT DATE(timestamp)) as num_days FROM events_log GROUP BY idcase HAVING num_days > 1;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase, date(timestamp) HAVING COUNT(*) > 1;
SELECT idcase, timestamp, COUNT(DISTINCT activity) as interventions FROM events_log GROUP BY idcase, timestamp HAVING interventions > 1;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'intervention' GROUP BY idcase, date(timestamp) HAVING COUNT(DISTINCT date(timestamp)) > 1;
SELECT resource, idcase, COUNT(*) FROM events_log WHERE cost = 0 GROUP BY resource, idcase;
SELECT resource, idcase, COUNT(*) FROM events_log WHERE cost = 0 GROUP BY resource, idcase;
SELECT idcase, resource, COUNT(*) FROM events_log WHERE cost = 0 GROUP BY idcase, resource;
SELECT resource, COUNT(*) FROM events_log WHERE cost = 0 GROUP BY resource, idcase;
SELECT resource, idcase, COUNT(*) FROM events_log WHERE cost = 0 GROUP BY resource, idcase;
SELECT resource, idcase, COUNT(*) FROM events_log WHERE cost = 0 GROUP BY resource, idcase;
SELECT resource, COUNT(*) AS interventions_without_cost FROM events_log WHERE cost = 0 GROUP BY resource;
SELECT resource, COUNT(*) as num_interventions FROM events_log WHERE activity = 'intervention' AND cost = 0 GROUP BY resource;
SELECT * FROM events_log WHERE activity = 'permit rejected by director';
SELECT * FROM events_log WHERE activity = 'permit rejected by director';
SELECT * FROM events_log WHERE activity = 'permit rejected by director';
SELECT * FROM events_log WHERE activity = 'permit rejected by the director';
SELECT * FROM events_log WHERE activity = 'permit rejected by director';
SELECT * FROM events_log WHERE activity = 'permit rejected by director';
SELECT activity FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log WHERE activity = 'declaration processing' AND resource = 'permit' AND cost = 'rejected' ) AND activity = 'intervention';
SELECT activity FROM events_log WHERE activity = 'intervention' AND resource = 'director' AND cost = 'reject' AND idcase = 'permit';
SELECT strftime('%Y-%m-%d', timestamp) as day, sum(cost) as total_cost FROM events_log GROUP BY day;
SELECT strftime('%Y-%m-%d', timestamp) as day, sum(cost) as total_cost FROM events_log GROUP BY day;
SELECT strftime('%Y-%m-%d', timestamp) as day, sum(cost) as total_cost FROM events_log GROUP BY day;
SELECT strftime('%Y-%m-%d', timestamp) as day, sum(cost) as total_cost FROM events_log GROUP BY day;
SELECT strftime('%Y-%m-%d', timestamp) as day, sum(cost) as total_cost FROM events_log GROUP BY day;
SELECT strftime('%Y-%m-%d', timestamp) as day, sum(cost) as total_cost FROM events_log GROUP BY day;
SELECT strftime('%Y-%m-%d', timestamp) as day, count(*) as total_events FROM events_log GROUP BY day;
SELECT strftime('%Y-%m-%d', timestamp) as day, sum(cost) as total_cost FROM events_log WHERE activity = 'declaration handling' GROUP BY day;
SELECT activity FROM events_log WHERE cost > 1000 AND resource IN ('supervisor', 'director');
SELECT activity FROM events_log WHERE activity IN ('supervisor', 'director') AND cost > 1000;
SELECT activity FROM events_log WHERE cost > 1000 AND resource IN ('supervisor', 'director');
SELECT activity FROM events_log WHERE (activity LIKE '%supervisor%' OR activity LIKE '%director%') AND cost > 1000;
SELECT activity FROM events_log WHERE cost > 1000 AND resource IN ('supervisor', 'director');
SELECT activity FROM events_log WHERE activity IN ('supervisor', 'director') AND cost > 1000;
SELECT idcase, COUNT(id) as num_events FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(id) as event_count FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(id) as num_events FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(id) as num_events FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(*) AS num_events FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(activity) AS events_performed FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT id) AS interventions_count FROM events_log WHERE activity = 'intervention' GROUP BY idcase;
SELECT resource, COUNT(activity) AS tasks_assigned FROM events_log GROUP BY resource;
SELECT resource, COUNT(activity) as tasks_assigned FROM events_log GROUP BY resource;
SELECT resource, COUNT(activity) AS num_activities FROM events_log GROUP BY resource;
SELECT resource, COUNT(activity) AS activity_count FROM events_log GROUP BY resource;
SELECT resource, COUNT(activity) AS num_activities FROM events_log GROUP BY resource;
SELECT resource, COUNT(activity) AS num_tasks FROM events_log GROUP BY resource;
SELECT resource, COUNT(activity) as num_actions FROM events_log GROUP BY resource;
SELECT idcase, COUNT(DISTINCT activity) as num_activities FROM events_log WHERE resource = 'Alexis' GROUP BY idcase;
SELECT idcase, COUNT(activity) FROM events_log WHERE resource = 'Alexis' GROUP BY idcase;
SELECT idcase, COUNT(activity) as activities_count FROM events_log WHERE resource = 'Alexis' GROUP BY idcase;
SELECT idcase, COUNT(activity) as num_activities FROM events_log WHERE resource = 'Alexis' GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT activity) AS activities_worked FROM events_log WHERE resource = 'Alexis' GROUP BY idcase;
SELECT activity, COUNT(activity), idcase FROM events_log WHERE resource = 'Alexis' GROUP BY idcase;
SELECT activity, idcase FROM events_log WHERE resource = 'Alexis';
SELECT resource, activity, COUNT(activity) as num_actions FROM events_log WHERE resource = 'Alexis' GROUP BY resource, activity;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'permit final approved by supervisor' AND idcase IN ( SELECT idcase FROM events_log WHERE activity = 'start trip' )
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'permit final approved by supervisor' AND timestamp < (SELECT MIN(timestamp) FROM events_log WHERE activity = 'start trip');
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'start trip' AND idcase IN ( SELECT idcase FROM events_log WHERE activity = 'permit final approved by supervisor' )
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'permit final approved by supervisor' AND timestamp < (SELECT MIN(timestamp) FROM events_log WHERE activity = 'start trip');
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'start trip' AND timestamp > (SELECT timestamp FROM events_log WHERE activity = 'permit final approved by supervisor' AND idcase = events_log.idcase);
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'start of the trip' AND timestamp > ( SELECT MAX(timestamp) FROM events_log WHERE activity = 'final approval from supervisor' AND idcase = events_log.idcase )
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'final approval from supervisor' AND timestamp < (SELECT MIN(timestamp) FROM events_log WHERE activity = 'start of the trip' AND idcase = events_log.idcase)
SELECT COUNT(*) FROM events_log WHERE activity = 'final approval' AND timestamp < (SELECT MIN(timestamp) FROM events_log WHERE activity = 'start of trip');
SELECT id, activity, timestamp, resource, cost, idcase FROM events_log WHERE activity = 'end trip' AND date(timestamp) != '2017-12-12';
SELECT * FROM events_log WHERE activity = 'end trip' AND timestamp < '2017-12-12' OR activity = 'end trip' AND timestamp > '2017-12-12';
SELECT * FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2017-12-12' AND '2017-12-13';
SELECT * FROM events_log WHERE activity = 'end trip' AND timestamp < '2017-12-12' OR timestamp > '2017-12-12';
SELECT * FROM events_log WHERE timestamp NOT LIKE '2017-12-12%' AND activity = 'end trip';
SELECT * FROM events_log WHERE activity = 'end trip' AND date(timestamp) != '2017-12-12';
SELECT COUNT(*) FROM events_log WHERE activity = 'end_trip' AND timestamp NOT LIKE '2017-12-12%';
SELECT resource, COUNT(*) AS event_count FROM events_log GROUP BY resource;
SELECT resource, COUNT(*) AS num_events FROM events_log GROUP BY resource;
SELECT resource, COUNT(*) AS event_count FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) as num_activities FROM events_log GROUP BY resource;
SELECT resource, COUNT(activity) AS num_events FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT id) as num_actions FROM events_log WHERE activity = 'processing declarations' GROUP BY resource;
SELECT resource, COUNT(activity) as num_actions FROM events_log WHERE activity LIKE '%trip declaration%' GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) AS num_activities FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) AS num_activities FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) as num_activities FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) as num_activities FROM events_log GROUP BY resource;
SELECT resource, COUNT(activity) AS num_activities FROM events_log GROUP BY resource;
SELECT DISTINCT activity, resource FROM events_log;
SELECT DISTINCT activity FROM events_log WHERE resource = 'Virginia' AND activity NOT IN ( SELECT DISTINCT activity FROM events_log WHERE resource = 'Virginia' )
SELECT DISTINCT activity FROM events_log WHERE resource = 'Virginia' AND activity NOT IN ( SELECT activity FROM events_log WHERE resource = 'Virginia' )
SELECT DISTINCT activity FROM events_log WHERE resource = 'Virginia' AND activity NOT IN ( SELECT DISTINCT activity FROM events_log WHERE resource = 'Virginia' )
SELECT DISTINCT activity FROM events_log WHERE activity NOT IN ( SELECT activity FROM events_log WHERE resource = 'Virginia' )
SELECT DISTINCT activity FROM events_log WHERE activity NOT IN ( SELECT activity FROM events_log WHERE resource = 'Virginia' )
SELECT DISTINCT activity FROM events_log WHERE resource = 'Virginia' EXCEPT SELECT DISTINCT activity FROM events_log WHERE resource = 'Virginia';
SELECT AVG(cost) FROM events_log WHERE activity = 'rejected';
SELECT AVG(cost) FROM events_log WHERE activity = 'rejected';
SELECT AVG(cost) FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log WHERE activity = 'rejected' )
SELECT AVG(cost) FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log WHERE activity = 'rejected' )
SELECT AVG(cost) FROM events_log WHERE activity = 'rejected';
SELECT AVG(cost) FROM events_log WHERE activity = 'travel declaration' AND resource = 'rejected';
SELECT AVG(cost) FROM events_log WHERE activity = 'travel declaration' AND idcase IN ( SELECT idcase FROM events_log WHERE activity = 'process rejected' )
SELECT idcase, MAX(timestamp) - MIN(timestamp) AS duration FROM events_log WHERE activity = 'declaration approved by supervisor' GROUP BY idcase;
SELECT idcase, MAX(timestamp) - MIN(timestamp) AS duration FROM events_log WHERE activity = 'declaration approved by supervisor' GROUP BY idcase;
SELECT idcase, MAX(timestamp) - MIN(timestamp) AS duration FROM events_log WHERE activity = 'declaration approved by supervisor' GROUP BY idcase;
SELECT idcase, MAX(timestamp) - MIN(timestamp) AS duration FROM events_log WHERE activity = 'declaration approved by supervisor' GROUP BY idcase;
SELECT idcase, MAX(timestamp) - MIN(timestamp) AS duration FROM events_log WHERE activity = 'declaration approved by supervisor' GROUP BY idcase;
SELECT activity, COUNT(*) as num_actions FROM events_log WHERE activity = 'declaration approved by supervisor' GROUP BY activity;
SELECT MAX(timestamp) - MIN(timestamp) AS wait_time FROM events_log WHERE activity = 'declaration_approved' AND resource = 'supervisor';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration rejected by pre-approver';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration rejected by pre-approver';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration rejected by pre-approver';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration rejected by pre-approver';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration rejected by pre-approver';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration rejected by pre-approver';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration_rejected' AND resource = 'pre-approval';
SELECT COUNT(*) FROM events_log WHERE activity = 'rejected' AND resource = 'pre-approver';
SELECT resource, timestamp FROM events_log WHERE activity = 'end trip' ORDER BY resource;
SELECT idcase, timestamp FROM events_log WHERE activity = 'end trip' ORDER BY resource;
SELECT idcase, timestamp FROM events_log WHERE activity = 'end trip' ORDER BY resource;
SELECT idcase, timestamp FROM events_log WHERE activity = 'end trip' ORDER BY resource;
SELECT activity, timestamp FROM events_log WHERE activity = 'end of trip' ORDER BY resource;
SELECT events_log.idcase, events_log.timestamp FROM events_log WHERE activity = 'trip ended' ORDER BY resource;
SELECT idcase, COUNT(*) AS event_count FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(*) AS event_count FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(id) as num_events FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(id) AS events_performed FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(*) AS num_events FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(*) AS num_events FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(activity) AS num_actions FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT id) as interventions FROM events_log WHERE activity = 'intervention' GROUP BY idcase;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2017-05-02' AND '2017-05-12';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2017-05-02' AND '2017-05-12';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2017-05-02' AND '2017-05-12';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2017-05-02' AND '2017-05-12';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2017-05-02' AND '2017-05-12';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'end trip' AND timestamp BETWEEN '2017-05-02' AND '2017-05-12';
SELECT COUNT(*) FROM events_log WHERE activity = 'trip ended' AND timestamp BETWEEN '2017-05-02' AND '2017-05-12';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'end of trip' AND timestamp BETWEEN '2017-05-02' AND '2017-05-12';
SELECT idcase, resource, id, MAX(timestamp) as completion_date FROM events_log WHERE activity = 'send reminder' GROUP BY idcase, resource, id ORDER BY completion_date;
SELECT idcase, resource, id, timestamp FROM events_log WHERE activity = 'send reminder' ORDER BY timestamp;
SELECT idcase, resource, id, timestamp FROM events_log WHERE activity = 'send reminder' ORDER BY timestamp;
SELECT idcase, resource, activity, timestamp FROM events_log WHERE activity = 'send reminder' ORDER BY timestamp;
SELECT idcase, id, resource, timestamp FROM events_log WHERE activity = 'send reminder' ORDER BY timestamp;
SELECT idcase, resource, id, timestamp FROM events_log WHERE activity = 'send reminder' ORDER BY timestamp;
SELECT id, activity, timestamp, resource, cost, idcase FROM events_log WHERE activity = 'send reminders' ORDER BY timestamp;
SELECT DISTINCT resource FROM events_log ORDER BY resource ASC;
SELECT DISTINCT resource FROM events_log ORDER BY resource ASC;
SELECT DISTINCT resource FROM events_log ORDER BY resource ASC;
SELECT DISTINCT resource FROM events_log ORDER BY resource ASC;
SELECT DISTINCT resource FROM events_log ORDER BY resource ASC;
SELECT DISTINCT resource FROM events_log ORDER BY resource ASC;
SELECT DISTINCT resource FROM events_log WHERE activity = 'declaration processes' ORDER BY resource ASC;
SELECT resource FROM events_log GROUP BY resource HAVING COUNT(DISTINCT idcase) > 200;
SELECT resource FROM events_log GROUP BY resource HAVING COUNT(DISTINCT idcase) > 200;
SELECT resource FROM events_log WHERE activity = 'travel declaration' GROUP BY resource HAVING COUNT(*) > 200;
SELECT resource FROM events_log WHERE activity = 'travel declaration' GROUP BY resource HAVING COUNT(*) > 200;
SELECT activity FROM events_log WHERE activity = 'travel declaration' GROUP BY resource HAVING COUNT(resource) > 200;
SELECT activity FROM events_log WHERE activity = 'travel declaration' GROUP BY resource HAVING COUNT(resource) > 200;
SELECT resource FROM events_log WHERE activity = 'travel declaration' GROUP BY resource HAVING COUNT(*) > 200;
SELECT COUNT(DISTINCT resource) FROM events_log;
SELECT COUNT(DISTINCT resource) FROM events_log;
SELECT COUNT(DISTINCT resource) FROM events_log WHERE activity = 'handling declarations';
SELECT COUNT(DISTINCT resource) FROM events_log WHERE activity = 'handling declarations';
SELECT COUNT(DISTINCT resource) FROM events_log;
SELECT COUNT(DISTINCT resource) FROM events_log;
SELECT COUNT(DISTINCT resource) FROM events_log WHERE activity = 'declaration management';
SELECT COUNT(DISTINCT resource) FROM events_log WHERE activity = 'declaration';
SELECT COUNT(DISTINCT resource) FROM events_log WHERE activity = 'declaration handling';
SELECT activity FROM events_log WHERE activity LIKE '%declaration%';
SELECT activity FROM events_log WHERE activity LIKE '%declaration%';
SELECT activity FROM events_log WHERE activity LIKE '%declaration%';
SELECT activity FROM events_log WHERE activity LIKE '%declaration%';
SELECT activity FROM events_log WHERE activity LIKE '%declaration%';
SELECT activity FROM events_log WHERE activity LIKE '%declaration%';
SELECT DISTINCT activity FROM events_log WHERE activity LIKE '%declaration%' AND activity LIKE '%travel%';
SELECT activity FROM events_log WHERE activity LIKE '%declaration%';
SELECT activity, AVG(cost) as mean_cost FROM events_log GROUP BY activity;
SELECT activity, AVG(cost) as average_cost FROM events_log GROUP BY activity;
SELECT activity, AVG(cost) as average_cost FROM events_log GROUP BY activity;
SELECT activity, AVG(cost) as mean_cost FROM events_log GROUP BY activity;
SELECT activity, AVG(cost) AS mean_cost FROM events_log GROUP BY activity;
SELECT activity, AVG(cost) as average_cost FROM events_log GROUP BY activity;
SELECT activity, AVG(cost) as avg_cost FROM events_log GROUP BY activity;
SELECT activity, AVG(cost) as mean_cost FROM events_log GROUP BY activity;
SELECT activity, AVG(cost) as mean_cost FROM events_log WHERE activity = 'process travel declarations' GROUP BY activity;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE cost IS NULL;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE cost IS NULL;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE cost IS NULL;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE cost IS NULL;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE cost IS NULL;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE cost = 0;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE cost IS NULL;
SELECT COUNT(*) FROM events_log WHERE cost = 0;
SELECT COUNT(*) FROM events_log WHERE cost IS NULL;
SELECT activity FROM events_log WHERE activity LIKE '%permit%' OR activity LIKE '%declaration%';
SELECT DISTINCT activity FROM events_log WHERE activity LIKE '%permit%' OR activity LIKE '%declaration%';
SELECT DISTINCT activity FROM events_log WHERE activity LIKE '%permit%' OR activity LIKE '%declaration%';
SELECT activity FROM events_log WHERE activity LIKE '%permit%' OR activity LIKE '%declare%';
SELECT DISTINCT activity FROM events_log WHERE activity LIKE '%permit%' OR activity LIKE '%declaration%';
SELECT activity FROM events_log WHERE activity LIKE '%permit%' OR activity LIKE '%declaration%';
SELECT activity FROM events_log WHERE activity LIKE '%permit%' OR activity LIKE '%declaration%';
SELECT activity FROM events_log WHERE activity LIKE '%permit%' OR activity LIKE '%declaration%';
SELECT activity FROM events_log WHERE activity LIKE '%permit%' OR activity LIKE '%explicit declaration%';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration rejected by director';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration rejected by director';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration rejected by director';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration rejected by director';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration rejected by director';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration rejected by director';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration of rejection of responsibility of the director';
SELECT AVG(cost) FROM events_log;
SELECT AVG(cost) FROM events_log;
SELECT AVG(cost) FROM events_log;
SELECT AVG(cost) FROM events_log;
SELECT AVG(cost) FROM events_log;
SELECT AVG(cost) FROM events_log;
SELECT activity, AVG(cost) AS mean_cost FROM events_log GROUP BY activity;
SELECT AVG(cost) FROM events_log;
SELECT AVG(cost) FROM events_log;
SELECT AVG(cost) FROM events_log WHERE activity = 'process_declaration';
SELECT resource, COUNT(DISTINCT idcase) as num_cases FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) as cases_associated FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY resource;
SELECT employee, COUNT(DISTINCT idcase) AS declarations_acted_on FROM events_log WHERE activity = 'declaration' GROUP BY employee;
SELECT COUNT(*) FROM events_log WHERE resource = 'Peter';
SELECT COUNT(*) FROM events_log WHERE resource = 'Peter';
SELECT COUNT(*) FROM events_log WHERE resource = 'Peter';
SELECT COUNT(activity) FROM events_log WHERE resource = 'Peter';
SELECT resource FROM events_log GROUP BY resource HAVING COUNT(DISTINCT idcase) > 3;
SELECT resource FROM events_log WHERE activity = 'processing' GROUP BY resource HAVING COUNT(DISTINCT idcase) > 3;
SELECT DISTINCT id FROM events_log GROUP BY id HAVING COUNT(DISTINCT idcase) > 3;
SELECT id FROM events_log GROUP BY id HAVING COUNT(DISTINCT idcase) > 3;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT idcase) > 3;
SELECT employee FROM events_log GROUP BY employee HAVING COUNT(DISTINCT idcase) > 3;
SELECT idcase FROM events_log WHERE activity = 'request for payment' GROUP BY idcase ORDER BY COUNT(*) ASC;
SELECT idcase FROM events_log WHERE activity = 'request payment' GROUP BY idcase ORDER BY COUNT(*) ASC;
SELECT idcase FROM events_log WHERE activity LIKE '%request payment%' GROUP BY idcase ORDER BY COUNT(*) ASC;
SELECT idcase FROM events_log WHERE activity = 'request payment' GROUP BY idcase ORDER BY COUNT(*) ASC;
SELECT idcase FROM events_log WHERE activity = 'request payment' GROUP BY idcase ORDER BY COUNT(id) ASC;
SELECT idcase FROM events_log WHERE activity = 'request payment' GROUP BY idcase ORDER BY COUNT(id) ASC;
SELECT idcase, COUNT(activity) as total_activities FROM events_log WHERE activity = 'payment_requested' GROUP BY idcase ORDER BY total_activities;
SELECT idcase, COUNT(id) as num_actions FROM events_log WHERE activity = 'payment request' GROUP BY idcase ORDER BY num_actions;
SELECT MIN(timestamp) as start_date, MAX(timestamp) as end_date FROM events_log WHERE activity IN ('end trip', 'declaration rejected by employee') GROUP BY idcase ORDER BY start_date;
SELECT timestamp FROM events_log WHERE activity = 'end trip' OR activity = 'declaration rejected by employee' ORDER BY timestamp;
SELECT timestamp FROM events_log WHERE activity = 'end trip' OR activity = 'declaration rejected by employee' ORDER BY timestamp;
SELECT MIN(timestamp) as date FROM events_log WHERE activity = 'end trip' OR activity = 'declaration rejected by employee' GROUP BY timestamp;
SELECT timestamp FROM events_log WHERE activity = 'end trip' OR activity = 'closed' ORDER BY timestamp;
SELECT MIN(timestamp) as date FROM events_log WHERE activity IN ('end trip', 'declaration rejected by employee') GROUP BY timestamp ORDER BY timestamp;
SELECT DISTINCT date(timestamp) FROM events_log WHERE activity = 'end of trip' OR activity = 'declaration rejected by employee' ORDER BY date(timestamp) ASC;
SELECT timestamp FROM events_log WHERE activity IN ('end of trip', 'rejection of declaration by employee') ORDER BY timestamp;
SELECT resource, activity, COUNT(activity) as occurrences FROM events_log GROUP BY resource, activity ORDER BY resource;
SELECT resource, COUNT(activity) AS num_performances FROM events_log GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(activity) AS activity_performances FROM events_log GROUP BY resource ORDER BY resource ASC;
SELECT resource, COUNT(activity) AS activity_performances FROM events_log GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(activity) AS activity_performances FROM events_log GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(activity) AS num_activities FROM events_log GROUP BY resource ORDER BY resource ASC;
SELECT activity, resource, COUNT(activity) as occurrences FROM events_log GROUP BY resource, activity ORDER BY resource;
SELECT resource, COUNT(activity) AS activity_occurrences FROM events_log GROUP BY resource ORDER BY resource;
SELECT resource, activity, COUNT(activity) as activity_occurrences FROM events_log GROUP BY resource ORDER BY resource;
SELECT resource, activity, COUNT(DISTINCT idcase) FROM events_log GROUP BY resource, activity ORDER BY resource, activity;
SELECT activity, COUNT(activity) AS num_times_performed FROM events_log GROUP BY activity;
SELECT * FROM events_log WHERE activity LIKE 'E%';
SELECT * FROM events_log WHERE activity LIKE 'E%';
SELECT * FROM events_log WHERE activity LIKE 'E%';
SELECT * FROM events_log WHERE activity LIKE 'E%';
SELECT * FROM events_log WHERE activity LIKE 'E%'
SELECT * FROM events_log WHERE activity LIKE 'E%';
SELECT activity FROM events_log WHERE activity LIKE 'E%'
SELECT activity FROM events_log WHERE activity LIKE 'E%';
SELECT id, activity, resource, cost FROM events_log WHERE cost BETWEEN 50 AND 400;
SELECT id, activity, resource, cost FROM events_log WHERE cost BETWEEN 50 AND 400;
SELECT id, activity, resource, cost FROM events_log WHERE cost BETWEEN 50 AND 400;
SELECT id, activity, resource, cost FROM events_log WHERE cost BETWEEN 50 AND 400;
SELECT id, activity, resource, cost FROM events_log WHERE cost BETWEEN 50 AND 400;
SELECT id, activity, resource, cost FROM events_log WHERE cost BETWEEN 50 AND 400;
SELECT id, activity, resource, cost FROM events_log WHERE cost BETWEEN 50 AND 400;
SELECT id, activity, resource, cost FROM events_log WHERE cost BETWEEN 50 AND 400;
SELECT id, activity, resource, cost FROM events_log WHERE activity = 'declaration processing' AND cost BETWEEN 50 AND 400;
SELECT DISTINCT resource FROM events_log WHERE activity = 'declaration saved by employee';
SELECT DISTINCT resource FROM events_log WHERE activity = 'declaration saved by employee';
SELECT DISTINCT resource FROM events_log WHERE activity = 'saved declaration';
SELECT DISTINCT resource FROM events_log WHERE activity = 'save_declaration';
SELECT activity FROM events_log WHERE date(timestamp) = '2018-04-12';
SELECT activity FROM events_log WHERE date(timestamp) = '2018-04-12';
SELECT activity FROM events_log WHERE date(timestamp) = '2018-04-12';
SELECT activity FROM events_log WHERE date(timestamp) = '2018-04-12';
SELECT activity FROM events_log WHERE date(timestamp) = '2018-04-12'
SELECT DISTINCT activity FROM events_log WHERE timestamp LIKE '2018-04-12%';
SELECT DISTINCT activity FROM events_log WHERE date(timestamp) = '2018-04-12';
SELECT DISTINCT activity FROM events_log WHERE date(timestamp) = '2018-04-12';
SELECT activity FROM events_log WHERE date(timestamp) = '2018-04-12' AND activity LIKE '%declaration processing%';
SELECT id, activity, timestamp FROM events_log WHERE activity IN ('permit final approved by supervisor', 'declaration approved by supervisor') ORDER BY timestamp;
SELECT id, activity, timestamp FROM events_log WHERE activity IN ('permit final approved by supervisor', 'declaration approved by supervisor') ORDER BY timestamp;
SELECT id, activity, timestamp FROM events_log WHERE activity IN ('permit final approved by the supervisor', 'declaration approved by the supervisor') ORDER BY timestamp;
SELECT id, activity, timestamp FROM events_log WHERE activity IN ('permit final approved by supervisor', 'declaration approved by supervisor') ORDER BY timestamp;
SELECT id, activity, timestamp FROM events_log WHERE activity IN ('permit final approved by supervisor', 'declaration approved by supervisor') ORDER BY timestamp;
SELECT id, activity, timestamp FROM events_log WHERE activity = 'permit final approved by supervisor' OR activity = 'declaration approved by supervisor' ORDER BY timestamp;
SELECT id, activity, timestamp FROM events_log WHERE activity IN ('final approval of a permit', 'approval of a declaration by a supervisor') ORDER BY timestamp;
SELECT id, activity, timestamp FROM events_log WHERE activity = 'final approval of a permit' OR activity = 'approval of a declaration by a supervisor' ORDER BY timestamp;
SELECT * FROM events_log WHERE cost <> 0;
SELECT * FROM events_log WHERE cost <> 0;
SELECT * FROM events_log WHERE cost IS NOT NULL;
SELECT * FROM events_log WHERE cost IS NOT NULL;
SELECT * FROM events_log WHERE cost IS NOT NULL;
SELECT * FROM events_log WHERE cost IS NOT NULL;
SELECT * FROM events_log WHERE cost IS NOT NULL;
SELECT activity, cost FROM events_log WHERE cost <> 0;
SELECT COUNT(*) FROM events_log WHERE activity = 'permit final approved by director';
SELECT COUNT(*) FROM events_log WHERE activity = 'permit final approved by director';
SELECT COUNT(*) FROM events_log WHERE activity = 'permit final approved by director';
SELECT COUNT(*) FROM events_log WHERE activity = 'permit final approved by director';
SELECT COUNT(*) FROM events_log WHERE activity = 'permit final approved by director';
SELECT COUNT(*) FROM events_log WHERE activity = 'permit final approved by director';
SELECT COUNT(*) FROM events_log WHERE activity = 'permit final approved by director';
SELECT COUNT(*) FROM events_log WHERE activity = 'permit final approved by director';
SELECT COUNT(*) FROM events_log WHERE activity = 'permit final approved by director';
SELECT COUNT(*) FROM events_log WHERE activity = 'permit final approved by a director';
SELECT COUNT(*) FROM events_log WHERE activity = 'final permit granted' AND resource = 'director' AND idcase IN ( SELECT idcase FROM events_log WHERE activity = 'processing of declarations' )
SELECT COUNT(*) FROM events_log WHERE activity = 'final permit approved' AND resource = 'director';
SELECT timestamp FROM events_log WHERE activity = 'start trip' AND resource LIKE '%s';
SELECT timestamp FROM events_log WHERE activity = 'start trip' AND resource LIKE '%s' ORDER BY timestamp;
SELECT MAX(timestamp) as start_time, MIN(timestamp) as end_time FROM events_log WHERE activity = 'start trip' AND resource LIKE '%s';
SELECT timestamp FROM events_log WHERE activity = 'start trip' AND resource LIKE '%s';
SELECT * FROM events_log WHERE activity = 'start trip' AND resource LIKE '%s' ORDER BY timestamp;
SELECT MIN(timestamp) as start_time, MAX(timestamp) as end_time FROM events_log WHERE activity = 'start trip' AND resource LIKE '%s';
SELECT timestamp FROM events_log WHERE activity = 'start trip' AND resource LIKE '%s';
SELECT MIN(timestamp) as start_time, MAX(timestamp) as end_time FROM events_log WHERE activity = 'start trip' AND resource LIKE '%s';
SELECT DISTINCT date(timestamp) FROM events_log WHERE resource LIKE '%s' AND activity = 'start_trip';
SELECT DISTINCT date(timestamp) FROM events_log WHERE activity = 'trip start' AND resource LIKE '%s';
SELECT activity, resource, SUM(cost) FROM events_log GROUP BY activity, resource;
SELECT SUM(cost) FROM events_log WHERE activity = 'activity_name' AND resource = 'resource_name';
SELECT activity, resource, SUM(cost) AS total_cost FROM events_log GROUP BY activity, resource;
SELECT activity, resource, SUM(cost) AS total_cost FROM events_log GROUP BY activity, resource;
SELECT activity, resource, SUM(cost) AS total_cost FROM events_log GROUP BY activity, resource;
SELECT activity, resource, SUM(cost) as total_cost FROM events_log GROUP BY activity, resource;
SELECT activity, resource, SUM(cost) FROM events_log GROUP BY activity, resource;
SELECT activity, resource, SUM(cost) as total_cost FROM events_log GROUP BY activity, resource;
SELECT COUNT(*) FROM events_log WHERE activity IN ('start trip', 'end trip');
SELECT activity, COUNT(*) FROM events_log WHERE activity IN ('start trip', 'end trip') GROUP BY activity;
SELECT COUNT(*) FROM events_log WHERE activity = 'start trip' OR activity = 'trip end';
SELECT COUNT(*) FROM events_log WHERE activity IN ('start trip', 'trip end');
SELECT activity, COUNT(*) FROM events_log WHERE activity IN ('start trip', 'end trip') GROUP BY activity;
SELECT COUNT(*) FROM events_log WHERE activity IN ('start trip', 'end trip');
SELECT activity, COUNT(*) FROM events_log WHERE activity IN ('start trip', 'trip end') GROUP BY activity;
SELECT activity, COUNT(*) FROM events_log WHERE activity IN ('start trip', 'end trip') GROUP BY activity;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'beginning of trip' OR activity = 'end of trip';
SELECT COUNT(*) FROM events_log WHERE activity = 'beginning of a trip' OR activity = 'end of a trip';
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 3;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(activity) > 3;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 3;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 3;
SELECT activity, COUNT(activity) as activity_count FROM events_log GROUP BY activity HAVING COUNT(activity) > 3;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 3;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 3;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 3;
SELECT activity, COUNT(activity) as num_occurrences FROM events_log GROUP BY activity HAVING COUNT(activity) > 3;
SELECT activity FROM events_log WHERE activity = 'travel declarations' GROUP BY activity HAVING COUNT(*) > 3;
SELECT activity, resource FROM events_log ORDER BY timestamp DESC LIMIT 1;
SELECT activity, resource FROM events_log ORDER BY timestamp DESC LIMIT 1;
SELECT activity, resource FROM events_log ORDER BY timestamp DESC LIMIT 1;
SELECT activity, resource FROM events_log ORDER BY timestamp DESC LIMIT 1;
SELECT activity, resource FROM events_log ORDER BY timestamp DESC LIMIT 1;
SELECT activity, resource FROM events_log ORDER BY timestamp DESC LIMIT 1;
SELECT activity, resource FROM events_log ORDER BY timestamp DESC LIMIT 1;
SELECT resource, activity FROM events_log WHERE activity = 'travel declaration processing' ORDER BY timestamp DESC LIMIT 1;
SELECT resource, activity FROM events_log WHERE activity = 'travel declaration process' ORDER BY timestamp DESC LIMIT 1;
SELECT e1.activity, e1.resource FROM events_log e1 JOIN events_log e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'end trip' AND e1.timestamp > e2.timestamp;
SELECT events_log.idcase, events_log.activity, events_log.resource FROM events_log WHERE events_log.timestamp > ( SELECT MAX(timestamp) FROM events_log WHERE activity = 'end trip' )
SELECT events_log.idcase, events_log.activity, events_log.timestamp FROM events_log WHERE events_log.timestamp > (SELECT timestamp FROM events_log WHERE activity = 'end trip') ORDER BY events_log.timestamp;
SELECT events_log.activity, events_log.resource FROM events_log WHERE events_log.idcase = (SELECT idcase FROM events_log WHERE activity = 'end trip' AND id > events_log.id) AND events_log.timestamp > (SELECT timestamp FROM events_log WHERE activity = 'end trip' AND id > events_log.id);
SELECT e.activity, e.timestamp, e.resource, e.cost, e.idcase FROM events_log e WHERE e.idcase IN ( SELECT idcase FROM events_log WHERE activity = 'end trip' ) AND e.timestamp > ( SELECT timestamp FROM events_log WHERE activity = 'end trip' AND idcase = e.idcase )
SELECT events_log.activity, events_log.timestamp, events_log.resource FROM events_log WHERE events_log.idcase IN (SELECT idcase FROM events_log WHERE activity = 'end trip') ORDER BY events_log.timestamp;
SELECT events_log.activity, events_log.resource FROM events_log WHERE events_log.timestamp > (SELECT timestamp FROM events_log WHERE activity = 'end trip') ORDER BY events_log.timestamp;
SELECT events_log.activity, events_log.timestamp FROM events_log WHERE events_log.timestamp > (SELECT timestamp FROM events_log WHERE activity = 'end trip') ORDER BY events_log.timestamp;
SELECT e1.activity, e1.resource FROM events_log e1 WHERE e1.timestamp > ( SELECT timestamp FROM events_log WHERE activity = 'end trip' AND idcase = e1.idcase )
SELECT e.activity, e.timestamp, e.resource, e.cost, e.idcase, p.person_responsible FROM events_log e JOIN events_log e2 ON e.idcase = e2.idcase JOIN person_responsible p ON e.activity = p.activity WHERE e2.activity = 'end trip' AND e.timestamp > e2.timestamp;
SELECT events_log.activity, events_log.timestamp, events_log.resource FROM events_log WHERE events_log.idcase IN (SELECT idcase FROM events_log WHERE activity = 'end trip') ORDER BY events_log.timestamp;
SELECT events_log.activity, events_log.resource FROM events_log WHERE events_log.timestamp > (SELECT timestamp FROM events_log WHERE activity = 'end trip') ORDER BY events_log.timestamp;
SELECT events_log.activity, events_log.resource FROM events_log WHERE events_log.idcase IN ( SELECT idcase FROM events_log WHERE activity = 'end trip' ) AND events_log.timestamp > ( SELECT timestamp FROM events_log WHERE activity = 'end trip' )
SELECT events_log.activity, events_log.timestamp, events_log.resource FROM events_log WHERE events_log.idcase IN ( SELECT idcase FROM events_log WHERE activity = 'end trip' ) AND events_log.timestamp > ( SELECT timestamp FROM events_log WHERE activity = 'end trip' )
SELECT events_log.activity, events_log.timestamp, events_log.resource FROM events_log WHERE events_log.timestamp > (SELECT timestamp FROM events_log WHERE activity = 'end trip') ORDER BY events_log.timestamp;
SELECT events_log.activity, events_log.timestamp, events_log.resource FROM events_log WHERE events_log.timestamp > (SELECT MAX(timestamp) FROM events_log WHERE activity = 'trip registration') AND events_log.activity <> 'trip registration';
SELECT activity, resource FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log WHERE activity = 'end of trip' ) AND timestamp > ( SELECT timestamp FROM events_log WHERE activity = 'end of trip' ) AND activity != 'end of trip';
SELECT resource, COUNT(*) as num_events FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) as num_events FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) as num_events FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT COUNT(*) FROM events_log WHERE activity != 'end trip';
SELECT resource, COUNT(*) as num_events FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT COUNT(*) FROM events_log WHERE activity != 'end trip';
SELECT resource, COUNT(*) as events_amount FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) AS events_amount FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) AS events_amount FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) AS events_amount FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) AS events_amount FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) AS events_amount FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT COUNT(*) FROM events_log WHERE activity != 'end trip';
SELECT resource, COUNT(*) as events_amount FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) AS events_amount FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT resource, COUNT(*) as events_amount FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT COUNT(*) FROM events_log WHERE activity != 'end trip';
SELECT resource, COUNT(*) AS events_amount FROM events_log WHERE activity != 'end trip' GROUP BY resource;
SELECT COUNT(*) FROM events_log WHERE activity = 'processing travel declaration' AND resource = 'employee' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'recording end of trip' AND resource = 'employee' )
SELECT resource, COUNT(activity) as num_actions FROM events_log WHERE activity != 'end_trip' GROUP BY resource;
SELECT idcase FROM events_log GROUP BY idcase ORDER BY MIN(timestamp) DESC;
SELECT DISTINCT idcase FROM events_log ORDER BY MIN(timestamp) DESC;
SELECT DISTINCT idcase FROM events_log ORDER BY MIN(timestamp) DESC;
SELECT DISTINCT idcase FROM events_log ORDER BY MIN(timestamp) DESC;
SELECT id FROM events_log WHERE activity = 'travel_declaration' GROUP BY id ORDER BY MIN(timestamp);
SELECT id FROM events_log WHERE activity = 'travel_declaration' ORDER BY timestamp;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'request payment';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'request payment';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'request payment';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'request payment';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'request payment';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'payment request';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'payment request';
SELECT idcase FROM events_log WHERE activity = 'declaration final approved by director' ORDER BY timestamp DESC LIMIT 1;
SELECT idcase FROM events_log WHERE activity = 'declaration final approved by director' ORDER BY timestamp DESC LIMIT 1;
SELECT idcase FROM events_log WHERE activity = 'declaration final approved by director' ORDER BY timestamp DESC LIMIT 1;
SELECT idcase FROM events_log WHERE activity = 'declaration final approved by director' ORDER BY timestamp DESC LIMIT 1;
SELECT idcase FROM events_log WHERE activity = 'declaration final approved by director' ORDER BY timestamp DESC LIMIT 1;
SELECT activity FROM events_log WHERE activity = 'final approval' ORDER BY timestamp DESC LIMIT 1;
SELECT activity FROM events_log WHERE activity = 'final approval' ORDER BY timestamp DESC LIMIT 1;
SELECT resource FROM events_log WHERE activity = 'declaration approved by administration' GROUP BY resource ORDER BY COUNT(*) DESC LIMIT 1;
SELECT resource FROM events_log WHERE activity = 'declaration approved by administration' GROUP BY resource ORDER BY COUNT(*) DESC LIMIT 1;
SELECT resource FROM events_log WHERE activity = 'declaration approved by administration' GROUP BY resource ORDER BY COUNT(*) DESC LIMIT 1;
SELECT resource, COUNT(*) AS num_events FROM events_log WHERE activity = 'declaration approved by administration' GROUP BY resource ORDER BY num_events DESC LIMIT 1;
SELECT resource FROM events_log WHERE activity = 'declaration approved by administration' GROUP BY resource ORDER BY COUNT(*) DESC LIMIT 1;
SELECT activity, COUNT(activity) as num_approvals FROM events_log WHERE activity = 'approve declaration' GROUP BY activity ORDER BY num_approvals DESC LIMIT 1;
SELECT resource, COUNT(*) as num_approvals FROM events_log WHERE activity = 'approve' GROUP BY resource ORDER BY num_approvals DESC LIMIT 1;
SELECT resource, COUNT(DISTINCT idcase) AS cases_count FROM events_log WHERE timestamp = (SELECT MIN(timestamp) FROM events_log) GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS num_cases FROM events_log WHERE timestamp = (SELECT MIN(timestamp) FROM events_log AS e WHERE e.resource = events_log.resource) GROUP BY resource;
SELECT resource, activity, COUNT(*) as num_times FROM events_log WHERE activity = (SELECT MIN(timestamp) FROM events_log WHERE idcase = events_log.idcase) GROUP BY resource, activity;
SELECT resource, COUNT(*) FROM events_log WHERE id IN ( SELECT MIN(id) FROM events_log GROUP BY idcase ) GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS num_first_actions FROM events_log WHERE timestamp = (SELECT MIN(timestamp) FROM events_log AS e2 WHERE e2.idcase = events_log.idcase) GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS declaration_count FROM events_log WHERE activity = 'first action' GROUP BY resource;
SELECT activity, COUNT(DISTINCT idcase) AS num_declaration_processes FROM events_log WHERE activity = 'declaration' GROUP BY activity;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity LIKE '%approved%';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity LIKE '%approved%';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity LIKE '%approved%';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity LIKE '%approved%';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity LIKE '%approved%';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity LIKE '%approved%';
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration_approved';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'Approval';
SELECT COUNT(DISTINCT idcase) AS cases_rejected_per_day FROM events_log WHERE activity = 'rejected' GROUP BY DATE(timestamp);
SELECT DATE(timestamp) as day, COUNT(DISTINCT idcase) as cases FROM events_log WHERE activity = 'rejected' GROUP BY day;
SELECT DATE(timestamp) as day, COUNT(DISTINCT idcase) as num_instances FROM events_log WHERE activity = 'rejected' GROUP BY day;
SELECT strftime('%Y-%m-%d', timestamp) as day, count(distinct idcase) as cases FROM events_log WHERE activity = 'Rejected' GROUP BY day;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'rejected';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'rejected';
SELECT date(timestamp) as day, count(*) as rejected_declarations FROM events_log WHERE activity = 'rejected' GROUP BY day;
SELECT timestamp, COUNT(DISTINCT idcase) AS num_declarations FROM events_log WHERE activity = 'Rejection' GROUP BY timestamp;
SELECT idcase, COUNT(id) as event_count, MAX(timestamp) - MIN(timestamp) as duration FROM events_log GROUP BY idcase ORDER BY event_count DESC LIMIT 5;
SELECT idcase, COUNT(*) as num_events, MAX(timestamp) - MIN(timestamp) as duration FROM events_log GROUP BY idcase ORDER BY num_events DESC LIMIT 5;
SELECT idcase, MAX(timestamp) - MIN(timestamp) as duration FROM events_log GROUP BY idcase ORDER BY COUNT(*) DESC LIMIT 5;
SELECT idcase, COUNT(*) as event_count, MAX(timestamp) - MIN(timestamp) as duration FROM events_log GROUP BY idcase ORDER BY event_count DESC LIMIT 5;
SELECT idcase, COUNT(activity) as activity_count, MAX(timestamp) - MIN(timestamp) as duration FROM events_log GROUP BY idcase ORDER BY activity_count DESC LIMIT 5;
SELECT idcase, COUNT(id) as event_count, MAX(timestamp) - MIN(timestamp) as duration FROM events_log GROUP BY idcase ORDER BY event_count DESC LIMIT 5;
SELECT idcase, COUNT(id) as num_events, MAX(timestamp) - MIN(timestamp) as duration FROM events_log GROUP BY idcase ORDER BY num_events DESC;
SELECT activity, COUNT(*) AS num_actions, MAX(timestamp) - MIN(timestamp) AS processing_time FROM events_log GROUP BY activity ORDER BY num_actions DESC LIMIT 5;
SELECT activity, SUM(cost) AS total_cost FROM events_log WHERE activity LIKE '%declaration%' GROUP BY activity ORDER BY total_cost DESC LIMIT 5;
SELECT idcase, COUNT(*) as num_events, MAX(timestamp) - MIN(timestamp) as duration FROM events_log GROUP BY idcase HAVING num_events >= 20 ORDER BY duration DESC LIMIT 5;
SELECT idcase, COUNT(*) as event_count, MAX(timestamp) - MIN(timestamp) as duration FROM events_log GROUP BY idcase HAVING COUNT(*) >= 20 ORDER BY event_count DESC LIMIT 5;
SELECT idcase, COUNT(activity) as activity_count, MAX(timestamp) - MIN(timestamp) as duration FROM events_log GROUP BY idcase HAVING COUNT(activity) >= 20 ORDER BY activity_count DESC LIMIT 5;
SELECT idcase, COUNT(*) as event_count, MAX(timestamp) - MIN(timestamp) as duration FROM events_log GROUP BY idcase HAVING event_count >= 20 ORDER BY duration DESC LIMIT 5;
SELECT idcase, COUNT(*) as event_count, MAX(timestamp) - MIN(timestamp) as duration FROM events_log GROUP BY idcase HAVING COUNT(*) >= 20 ORDER BY event_count DESC LIMIT 5;
SELECT idcase, COUNT(*) as num_events, MAX(timestamp) - MIN(timestamp) as duration FROM events_log GROUP BY idcase HAVING COUNT(*) >= 20 ORDER BY num_events DESC LIMIT 5;
SELECT idcase, COUNT(*) as num_events, MAX(timestamp) - MIN(timestamp) as duration FROM events_log GROUP BY idcase HAVING num_events >= 20 ORDER BY duration DESC LIMIT 5;
SELECT activity, COUNT(activity) as num_actions, MAX(timestamp) - MIN(timestamp) as processing_time FROM events_log GROUP BY activity HAVING num_actions >= 20 ORDER BY num_actions DESC LIMIT 5;
SELECT idcase FROM events_log WHERE activity != 'request payment' ORDER BY timestamp DESC LIMIT 10;
SELECT * FROM events_log WHERE activity = 'travel declaration' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'request payment' ) ORDER BY timestamp DESC LIMIT 10;
SELECT idcase FROM events_log WHERE activity != 'request payment' ORDER BY timestamp DESC LIMIT 10;
SELECT idcase FROM events_log WHERE activity != 'request payment' ORDER BY timestamp DESC LIMIT 10;
SELECT idcase FROM events_log WHERE activity != 'request payment' ORDER BY timestamp DESC LIMIT 10;
SELECT DISTINCT idcase FROM events_log WHERE activity != 'request payment' ORDER BY timestamp DESC LIMIT 10;
SELECT idcase FROM events_log WHERE activity != 'request payment' ORDER BY timestamp DESC LIMIT 10;
SELECT idcase FROM events_log WHERE activity != 'request payment' ORDER BY timestamp DESC LIMIT 10;
SELECT idcase FROM events_log WHERE activity != 'request payment' GROUP BY idcase ORDER BY timestamp DESC LIMIT 10;
SELECT idcase FROM events_log WHERE activity != 'request payment' GROUP BY idcase ORDER BY timestamp DESC LIMIT 10;
SELECT idcase FROM events_log WHERE activity != 'request payment' GROUP BY idcase ORDER BY timestamp DESC LIMIT 10;
SELECT * FROM events_log WHERE activity = 'processing declaration' AND id NOT IN ( SELECT id FROM events_log WHERE activity = 'payment request' ) ORDER BY timestamp DESC LIMIT 10;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) <= 10;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) <= 10;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(id) <= 10;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(activity) <= 10;
SELECT idcase, COUNT(id) as num_events FROM events_log GROUP BY idcase HAVING COUNT(id) <= 10;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(activity) <= 10;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) <= 10;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) <= 10;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) <= 10;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) <= 10;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) >= 10;
SELECT activity, COUNT(*) as event_count FROM events_log GROUP BY activity HAVING event_count <= 10;
SELECT AVG(cost) FROM events_log WHERE activity = 'payment handled' AND timestamp < '2018-01-01';
SELECT AVG(cost) FROM events_log WHERE activity = 'payment handled' AND timestamp < '2018-01-01';
SELECT AVG(cost) FROM events_log WHERE activity = 'payment handled' AND timestamp < '2018-01-01';
SELECT AVG(cost) FROM events_log WHERE activity = 'payment handled' AND timestamp < '2018-01-01';
SELECT AVG(cost) FROM events_log WHERE activity = 'payment handled' AND timestamp < '2018-01-01';
SELECT AVG(cost) FROM events_log WHERE activity = 'payment handled' AND timestamp < '2018-01-01';
SELECT AVG(cost) FROM events_log WHERE activity = 'payment handled' AND strftime('%Y', timestamp) < '2018';
SELECT AVG(cost) FROM events_log WHERE activity = 'payment handled' AND timestamp < '2018-01-01';
SELECT AVG(cost) FROM events_log WHERE activity = 'payment' AND timestamp < '2018-01-01';
SELECT idcase, COUNT(activity) FROM events_log WHERE activity = 'permit' GROUP BY idcase;
SELECT idcase, COUNT(activity) FROM events_log WHERE activity = 'permit' GROUP BY idcase;
SELECT idcase, COUNT(*) FROM events_log WHERE activity = 'permit' GROUP BY idcase;
SELECT idcase, COUNT(*) FROM events_log WHERE activity = 'permit' GROUP BY idcase;
SELECT idcase, COUNT(*) FROM events_log WHERE activity = 'permit' GROUP BY idcase;
SELECT idcase, COUNT(*) as permit_activity_count FROM events_log WHERE activity = 'permit' GROUP BY idcase;
SELECT idcase, COUNT(activity) FROM events_log WHERE activity = 'permit' GROUP BY idcase;
SELECT idcase, COUNT(*) FROM events_log WHERE activity = 'permit' GROUP BY idcase;
SELECT activity, COUNT(activity) AS permit_count FROM events_log WHERE activity = 'permit_registered' GROUP BY activity;
SELECT activity, COUNT(*) AS permit_count FROM events_log WHERE activity = 'permit' GROUP BY activity;
SELECT idcase, resource FROM events_log WHERE activity = 'declaration rejected by supervisor';
SELECT COUNT(DISTINCT idcase), resource FROM events_log WHERE activity = 'declaration rejected by supervisor' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'declaration rejected by supervisor' GROUP BY resource;
SELECT resource, COUNT(idcase) FROM events_log WHERE activity = 'declaration rejected by supervisor' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'declaration rejected by supervisor' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'declaration rejected by supervisor' GROUP BY resource;
SELECT COUNT(DISTINCT idcase) AS declarations_count, supervisor FROM events_log WHERE activity = 'Rejection' GROUP BY supervisor;
SELECT COUNT(*), supervisor FROM events_log WHERE activity = 'rejected' GROUP BY supervisor;
SELECT activity, COUNT(DISTINCT idcase) as num_cases FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS cases_recorded FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS cases_carried_out FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) as case_count FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY activity;
SELECT activity, COUNT(idcase) AS num_declarations FROM events_log GROUP BY activity;
SELECT activity, COUNT(id) as declaration_count FROM events_log WHERE activity LIKE '%travel declaration%' GROUP BY activity;
SELECT e1.activity, e1.timestamp, e1.resource, e1.cost, e1.idcase FROM events_log e1 WHERE e1.activity LIKE 'R%' AND NOT EXISTS ( SELECT * FROM events_log e2 WHERE e2.activity LIKE 'D%' AND e2.timestamp > e1.timestamp );
SELECT * FROM events_log WHERE activity LIKE 'R%' AND timestamp > ALL ( SELECT timestamp FROM events_log WHERE activity LIKE 'D%' )
SELECT * FROM events_log WHERE activity LIKE 'R%' AND timestamp > ALL ( SELECT timestamp FROM events_log WHERE activity LIKE 'D%' )
SELECT * FROM events_log WHERE activity LIKE 'R%' AND timestamp > ALL (SELECT timestamp FROM events_log WHERE activity LIKE 'D%');
SELECT * FROM events_log WHERE activity LIKE 'R%' AND timestamp > ALL (SELECT timestamp FROM events_log WHERE activity LIKE 'D%');
SELECT * FROM events_log WHERE activity LIKE 'R%' AND timestamp > ALL (SELECT timestamp FROM events_log WHERE activity LIKE 'D%');
SELECT activity FROM events_log WHERE activity LIKE 'R%' AND idcase IN ( SELECT idcase FROM events_log WHERE activity LIKE 'D%' )
SELECT * FROM events_log WHERE activity LIKE 'R%' AND timestamp > (SELECT MAX(timestamp) FROM events_log WHERE activity LIKE 'D%');
SELECT activity, resource, COUNT(*) as activity_count FROM events_log GROUP BY activity, resource;
SELECT activity, resource, COUNT(*) as num_times FROM events_log GROUP BY activity, resource;
SELECT activity, resource, COUNT(*) as activity_count FROM events_log GROUP BY activity, resource;
SELECT resource, activity, COUNT(*) as num_times FROM events_log GROUP BY resource, activity;
SELECT activity, resource, COUNT(*) as count FROM events_log GROUP BY activity, resource;
SELECT activity, resource, COUNT(*) as num_times FROM events_log WHERE activity LIKE 'declaration processing%' GROUP BY activity, resource;
SELECT activity, resource, COUNT(*) as activity_count FROM events_log GROUP BY activity, resource;
SELECT DISTINCT activity FROM events_log WHERE timestamp BETWEEN '2018-01-01' AND '2018-06-30';
SELECT activity FROM events_log WHERE timestamp >= '2018-01-01' AND timestamp < '2018-07-01';
SELECT DISTINCT activity FROM events_log WHERE timestamp >= '2018-01-01' AND timestamp < '2018-07-01';
SELECT DISTINCT activity FROM events_log WHERE timestamp >= '2018-01-01' AND timestamp <= '2018-07-31';
SELECT activity FROM events_log WHERE timestamp >= '2018-01-01' AND timestamp < '2018-07-01';
SELECT activity FROM events_log WHERE timestamp >= '2018-01-01' AND timestamp < '2018-07-01';
SELECT activity FROM events_log WHERE timestamp >= '2018-01-01' AND timestamp < '2018-07-01';
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Wayne' ORDER BY idcase;
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Wayne' ORDER BY idcase;
SELECT idcase FROM events_log WHERE resource = 'Wayne' ORDER BY idcase;
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Wayne' ORDER BY idcase;
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Wayne' ORDER BY idcase;
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Wayne' ORDER BY idcase;
SELECT idcase FROM events_log WHERE resource = 'Wayne' ORDER BY idcase;
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Wayne' ORDER BY idcase;
SELECT DISTINCT activity FROM events_log WHERE resource = 'Wayne' ORDER BY activity;
SELECT activity FROM events_log WHERE resource = 'Wayne' ORDER BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS cases_performed FROM events_log WHERE date(timestamp) = '2018-03-12' GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS process_instances FROM events_log WHERE date(timestamp) = '2018-03-12' GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) as case_count FROM events_log WHERE date(timestamp) = '2018-03-02' GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS num_cases FROM events_log WHERE date(timestamp) = '2018-03-02' GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS num_cases FROM events_log WHERE timestamp = '2018-03-02' GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) as num_cases FROM events_log WHERE date(timestamp) = '2018-03-02' GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) FROM events_log WHERE timestamp >= '2018-03-02 00:00:00' AND timestamp < '2018-03-03 00:00:00' GROUP BY activity;
SELECT activity, COUNT(*) FROM events_log WHERE timestamp >= '2018-03-02 00:00:00' AND timestamp < '2018-03-03 00:00:00' GROUP BY activity;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity LIKE 'permit%' AND timestamp = (SELECT MIN(timestamp) FROM events_log WHERE idcase = events_log.idcase);
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity LIKE 'permit%';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity LIKE 'permit%';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity LIKE 'permit%';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE id = (SELECT MIN(id) FROM events_log WHERE idcase = events_log.idcase) AND activity LIKE 'permit%';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity LIKE 'permit%'
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity LIKE 'permit%'
SELECT COUNT(*) FROM events_log WHERE activity LIKE '%permit%' AND activity LIKE '%travel declaration%' AND activity LIKE '%started%';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'permit' AND timestamp = (SELECT MIN(timestamp) FROM events_log WHERE activity = 'permit' AND idcase = events_log.idcase)
SELECT DISTINCT idcase FROM events_log WHERE idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'request payment' OR activity = 'payment handled' )
SELECT DISTINCT idcase FROM events_log WHERE activity NOT IN ('request payment', 'payment handled');
SELECT DISTINCT idcase FROM events_log WHERE activity NOT IN ('request payment', 'payment handled');
SELECT DISTINCT idcase FROM events_log WHERE activity NOT IN ('request payment', 'payment handled');
SELECT DISTINCT idcase FROM events_log WHERE idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'request payment' OR activity = 'payment handled' )
SELECT DISTINCT idcase FROM events_log WHERE idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'request payment' OR activity = 'payment handled' )
SELECT DISTINCT idcase FROM events_log WHERE idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'request payment' OR activity = 'payment handled' )
SELECT DISTINCT idcase FROM events_log WHERE idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'request payment' OR activity = 'payment handled' )
SELECT DISTINCT idcase FROM events_log WHERE activity NOT IN ('request payment', 'payment handled');
SELECT DISTINCT idcase FROM events_log WHERE activity = 'request payment' OR activity = 'payment handled' EXCEPT SELECT DISTINCT idcase FROM events_log WHERE activity = 'request payment' OR activity = 'payment handled';
SELECT COUNT(*) FROM events_log WHERE activity NOT IN ('payment made', 'payment request');
SELECT DISTINCT activity FROM events_log WHERE activity LIKE '%payment%';
SELECT activity, timestamp, resource FROM events_log WHERE activity IN ('start trip', 'declaration submitted by employee') ORDER BY timestamp, resource;
SELECT * FROM events_log WHERE activity IN ('start trip', 'declaration submitted by employee') ORDER BY timestamp ASC, resource ASC;
SELECT * FROM events_log WHERE activity IN ('start trip', 'declaration submitted by employee') ORDER BY timestamp, resource;
SELECT * FROM events_log WHERE activity IN ('start trip', 'declaration submitted by employee') ORDER BY timestamp, resource;
SELECT * FROM events_log WHERE activity IN ('start trip', 'declaration submitted by employee') ORDER BY timestamp, resource;
SELECT * FROM events_log WHERE activity IN ('start trip', 'declaration submitted by employee') ORDER BY timestamp ASC, resource ASC;
SELECT * FROM events_log WHERE activity IN ('start trip', 'declaration submitted by employee') ORDER BY timestamp, resource;
SELECT * FROM events_log WHERE activity IN ('start trip', 'declaration submitted by employee') ORDER BY timestamp, resource;
SELECT * FROM events_log WHERE activity IN ('start trip', 'declaration submitted by employee') ORDER BY timestamp, resource;
SELECT activity, timestamp, resource FROM events_log WHERE activity IN ('initiate travel', 'request declaration') ORDER BY timestamp, resource;
SELECT activity, timestamp, resource FROM events_log WHERE activity = 'start_processing_declaration' ORDER BY timestamp ASC, resource;
SELECT resource, COUNT(*) AS occurrences FROM events_log WHERE activity = 'declaration saved by employee' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) AS num_records FROM events_log WHERE activity = 'declaration saved by employee' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity = 'declaration saved by employee' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity = 'declaration saved by employee' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) AS occurrences FROM events_log WHERE activity = 'declaration saved by employee' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) AS num_associations FROM events_log WHERE activity = 'declaration saved by employee' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) AS num_executions FROM events_log WHERE activity = 'declaration saved by employee' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) AS num_associations FROM events_log WHERE activity = 'declaration saved by employee' GROUP BY resource ORDER BY num_associations;
SELECT resource, COUNT(*) AS frequency FROM events_log WHERE activity = 'declaration saved by employee' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(activity) AS num_actions FROM events_log WHERE activity = 'saving a travel declaration' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) AS declaration_count FROM events_log WHERE activity = 'save_declaration' GROUP BY resource ORDER BY resource;
SELECT activity, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) as process_instances FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS process_instances FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS num_cases FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS num_declarations FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS num_declarations FROM events_log GROUP BY activity;
SELECT resource, COUNT(DISTINCT activity) as num_activities FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) AS num_activities FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) as num_activities FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) AS num_activities FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) AS num_activities FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) AS num_activities FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) as num_activities FROM events_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) as num_actions FROM events_log WHERE activity LIKE '%travel declaration%' GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) AS num_actions FROM events_log WHERE activity = 'travel declaration' GROUP BY resource;
SELECT resource, COUNT(*) as occurrences FROM events_log WHERE activity IN ('end trip', 'payment handled') GROUP BY resource;
SELECT resource, COUNT(activity) AS final_activities_count FROM events_log WHERE activity IN ('end trip', 'payment handled') GROUP BY resource;
SELECT resource, activity, COUNT(*) as num_occurrences FROM events_log WHERE activity IN ('end trip', 'payment handled') GROUP BY resource;
SELECT resource, COUNT(activity) FROM events_log WHERE activity IN ('end trip', 'payment handled') GROUP BY resource;
SELECT resource, COUNT(*) AS num_associations FROM events_log WHERE activity IN ('end trip', 'payment handled') GROUP BY resource;
SELECT resource, COUNT(*) FROM events_log WHERE activity IN ('end trip', 'payment handled') GROUP BY resource;
SELECT resource, COUNT(activity) FROM events_log WHERE activity IN ('end of trip', 'payment') GROUP BY resource;
SELECT resource, COUNT(activity) AS completion_activities_count FROM events_log WHERE activity IN ('end_trip', 'make_payment') GROUP BY resource;
SELECT resource, COUNT(*) as count FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND idcase IN ( SELECT MIN(idcase) FROM events_log WHERE activity = 'declaration rejected by pre-approver' GROUP BY idcase ) GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) as num_cases FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND timestamp = (SELECT MIN(timestamp) FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND resource = events_log.resource) GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) AS process_instances FROM events_log WHERE activity = 'declaration rejected by pre-approver' GROUP BY resource;
SELECT resource, COUNT(*) AS first_occurrence_count FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND timestamp = (SELECT MIN(timestamp) FROM events_log WHERE activity = 'declaration rejected by pre-approver' AND idcase = events_log.idcase) GROUP BY resource;
SELECT resource, COUNT(*) as num_occurrences FROM events_log WHERE activity = 'declaration rejected by pre-approver' GROUP BY resource;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'pre-approver' AND resource = 'employee' AND cost = 'rejected';
SELECT COUNT(DISTINCT idcase) AS num_rejected_declarations, resource FROM events_log WHERE activity = 'declaration_rejected' AND resource IN ( SELECT resource FROM events_log WHERE activity = 'declaration_submitted' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'declaration_rejected' ) ) GROUP BY resource;
SELECT idcase, activity, COUNT(*) as occurrences FROM events_log WHERE activity != 'end trip' GROUP BY idcase, activity;
SELECT idcase, COUNT(DISTINCT activity) AS activity_occurrences FROM events_log WHERE timestamp <= (SELECT timestamp FROM events_log WHERE activity = 'end trip') GROUP BY idcase;
SELECT idcase, activity, COUNT(*) FROM events_log WHERE activity <> 'end trip' GROUP BY idcase, activity;
SELECT idcase, COUNT(*) FROM events_log WHERE activity <> 'end trip' GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT activity) FROM events_log WHERE activity <> 'end trip' GROUP BY idcase;
SELECT idcase, COUNT(activity) FROM events_log WHERE activity != 'end trip' GROUP BY idcase;
SELECT idcase, COUNT(*) as num_events FROM events_log WHERE activity != 'end trip' GROUP BY idcase;
SELECT idcase, COUNT(*) as num_events FROM events_log WHERE activity = 'end trip' GROUP BY idcase;
SELECT idcase, COUNT(*) as num_events FROM events_log WHERE activity = 'end trip' GROUP BY idcase;
SELECT idcase, COUNT(activity) AS actions_performed FROM events_log WHERE activity = 'end of trip' GROUP BY idcase;
SELECT idcase, COUNT(*) AS actions_until_end FROM events_log WHERE activity = 'end of trip' GROUP BY idcase;
SELECT activity FROM events_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2018-01-01' AND '2018-06-30';
SELECT activity FROM events_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2018-01-01' AND '2018-06-30';
SELECT activity FROM events_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2018-01-01' AND '2018-06-30';
SELECT DISTINCT activity FROM events_log WHERE timestamp BETWEEN '2018-01-01' AND '2018-06-30' AND resource = 'Thomas';
SELECT activity FROM events_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2018-01-01' AND '2018-07-31';
SELECT activity FROM events_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2018-01-01' AND '2018-07-31';
SELECT activity FROM events_log WHERE resource = 'Thomas' AND timestamp >= '2018-01-01' AND timestamp < '2018-07-01';
SELECT DISTINCT activity FROM events_log WHERE timestamp BETWEEN '2018-01-01' AND '2018-06-30' AND resource = 'Thomas';
SELECT DISTINCT activity FROM events_log WHERE timestamp BETWEEN '2018-01-01' AND '2018-06-30' AND resource = 'Thomas';
SELECT idcase FROM events_log WHERE activity = 'declaration rejected by supervisor' ORDER BY timestamp ASC;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'declaration rejected by supervisor' ORDER BY timestamp;
SELECT idcase FROM events_log WHERE activity = 'declaration rejected by supervisor' ORDER BY timestamp;
SELECT idcase FROM events_log WHERE activity = 'declaration rejected by supervisor' ORDER BY timestamp ASC;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'declaration rejected by supervisor' ORDER BY timestamp;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'declaration rejected by supervisor' ORDER BY timestamp ASC;
SELECT idcase FROM events_log WHERE activity = 'declaration rejected by supervisor' ORDER BY timestamp ASC;
SELECT idcase FROM events_log WHERE activity = 'declaration rejected by supervisor' ORDER BY timestamp ASC;
SELECT activity, timestamp, resource, cost, idcase FROM events_log WHERE activity = 'Rejection determined by supervisor' ORDER BY timestamp;
SELECT activity FROM events_log WHERE activity = 'rejected' ORDER BY timestamp;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'start trip' AND timestamp NOT LIKE '2018-03%'
SELECT DISTINCT idcase FROM events_log WHERE activity = 'start trip' AND timestamp < '2018-03-01' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'finish trip' )
SELECT DISTINCT idcase FROM events_log WHERE activity = 'start trip' AND timestamp NOT LIKE '2018-03%'
SELECT DISTINCT idcase FROM events_log WHERE activity = 'start trip' AND timestamp < '2018-03-31' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'end trip' )
SELECT DISTINCT idcase FROM events_log WHERE activity = 'start trip' AND timestamp < '2018-03-31' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'finish trip' )
SELECT idcase FROM events_log WHERE activity = 'start trip' AND timestamp < '2018-03-31';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'start trip' AND timestamp < '2018-03-31'
SELECT DISTINCT idcase FROM events_log WHERE activity = 'start trip' AND timestamp < '2018-03-31' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'finish trip' )
SELECT DISTINCT idcase FROM events_log WHERE activity = 'start trip' AND timestamp < '2018-03-31' EXCEPT SELECT DISTINCT idcase FROM events_log WHERE activity = 'finish trip' AND timestamp < '2018-03-31';
SELECT activity FROM events_log WHERE timestamp < '2018-03-31' AND activity = 'start of the trip';
SELECT id, activity, timestamp, resource, cost, idcase FROM events_log WHERE activity = 'start of the trip' AND timestamp < '2018-03-31';
SELECT idcase FROM events_log WHERE activity = 'end trip' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity IN ('request payment', 'payment handled') ) AND idcase IN ( SELECT idcase FROM events_log WHERE activity = 'end trip' GROUP BY idcase HAVING COUNT(DISTINCT resource) > 1 )
SELECT DISTINCT idcase FROM events_log WHERE activity = 'end trip' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'request payment' OR activity = 'payment handled' ) GROUP BY idcase HAVING COUNT(DISTINCT resource) > 1;
SELECT idcase FROM events_log WHERE activity = 'end trip' AND activity NOT IN ('request payment', 'payment handled') GROUP BY idcase HAVING COUNT(DISTINCT resource) > 1;
SELECT idcase FROM events_log WHERE activity = 'end trip' GROUP BY idcase HAVING COUNT(DISTINCT resource) > 1 AND SUM(CASE WHEN activity = 'request payment' OR activity = 'payment handled' THEN 1 ELSE 0 END) = 0;
SELECT idcase FROM events_log WHERE activity = 'end trip' GROUP BY idcase HAVING COUNT(DISTINCT resource) > 1 AND SUM(CASE WHEN activity = 'request payment' THEN 1 ELSE 0 END) = 0 AND SUM(CASE WHEN activity = 'payment handled' THEN 1 ELSE 0 END) = 0;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'end trip' AND idcase IN ( SELECT idcase FROM events_log WHERE activity != 'request payment' AND activity != 'payment handled' GROUP BY idcase HAVING COUNT(DISTINCT resource) > 1 )
SELECT DISTINCT idcase FROM events_log WHERE resource IN ( SELECT resource FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT resource) > 1 ) AND activity = 'end trip' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'request payment' OR activity = 'payment handled' )
SELECT activity FROM events_log WHERE activity = 'declaration finalized' AND cost = 0;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'end of trip registration' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'payment request' )
SELECT idcase, COUNT(DISTINCT resource) AS num_resources, SUM(cost) AS total_cost FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT resource) AS num_resources, SUM(cost) AS total_cost FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT resource) AS num_resources, SUM(cost) AS total_cost FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT resource) as unique_resources, SUM(cost) as total_cost FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT resource) AS num_resources, SUM(cost) AS total_cost FROM events_log GROUP BY idcase;
SELECT idcase, SUM(cost) as total_cost, COUNT(DISTINCT resource) as num_resources FROM events_log GROUP BY idcase;
SELECT idcase, SUM(cost) as total_cost, COUNT(DISTINCT resource) as num_resources FROM events_log GROUP BY idcase;
SELECT idcase, SUM(cost) as total_cost, COUNT(DISTINCT resource) as num_resources FROM events_log GROUP BY idcase;
SELECT idcase, SUM(cost) as total_cost, COUNT(DISTINCT resource) as num_resources FROM events_log GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT resource) AS num_people, SUM(cost) AS total_cost FROM events_log GROUP BY idcase;
SELECT idcase FROM events_log WHERE activity LIKE 'permit%' GROUP BY idcase HAVING COUNT(DISTINCT activity) > 1;
SELECT idcase FROM events_log WHERE activity LIKE 'permit%' GROUP BY idcase HAVING COUNT(DISTINCT activity) > 1;
SELECT idcase FROM events_log WHERE activity LIKE 'permit%' GROUP BY idcase HAVING COUNT(DISTINCT activity) >= 2;
SELECT idcase FROM events_log WHERE activity LIKE 'permit%' GROUP BY idcase HAVING COUNT(DISTINCT activity) > 1;
SELECT idcase FROM events_log WHERE activity LIKE 'permit%' GROUP BY idcase HAVING COUNT(DISTINCT activity) > 1;
SELECT idcase FROM events_log WHERE activity LIKE 'permit%' GROUP BY idcase HAVING COUNT(*) > 1;
SELECT idcase FROM events_log WHERE activity LIKE 'permit%' GROUP BY idcase HAVING COUNT(DISTINCT activity) > 1;
SELECT idcase FROM events_log WHERE activity LIKE 'permit%' GROUP BY idcase HAVING COUNT(*) > 1;
SELECT DISTINCT idcase FROM events_log WHERE activity LIKE '%permit%';
SELECT idcase, activity, COUNT(DISTINCT activity) as num_actions FROM events_log WHERE activity LIKE '%permit%' GROUP BY idcase HAVING COUNT(DISTINCT activity) > 1;
SELECT id FROM events_log WHERE (idcase, timestamp) IN ( SELECT idcase, MAX(timestamp) FROM events_log GROUP BY idcase )
SELECT idcase, MAX(timestamp) AS last_event_id FROM events_log GROUP BY idcase;
SELECT id FROM events_log WHERE (idcase, timestamp) IN ( SELECT idcase, MAX(timestamp) FROM events_log GROUP BY idcase ) ORDER BY timestamp;
SELECT id, activity, timestamp, resource, cost, idcase FROM events_log ORDER BY idcase, timestamp DESC;
SELECT id, activity FROM events_log WHERE (idcase, timestamp) IN ( SELECT idcase, MAX(timestamp) FROM events_log GROUP BY idcase ) ORDER BY timestamp;
SELECT idcase, MAX(timestamp) as last_event_timestamp FROM events_log GROUP BY idcase;
SELECT id FROM events_log WHERE (idcase, timestamp) IN ( SELECT idcase, MAX(timestamp) FROM events_log GROUP BY idcase ) ORDER BY timestamp;
SELECT id, activity, timestamp, resource, cost, idcase FROM events_log ORDER BY timestamp DESC;
SELECT id FROM events_log WHERE activity = 'intervention' ORDER BY timestamp DESC;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT DISTINCT activity FROM events_log GROUP BY activity HAVING COUNT(activity) >= 100;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT DISTINCT activity FROM events_log GROUP BY activity HAVING COUNT(activity) >= 100;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 100;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 100;
SELECT activity, COUNT(activity) as occurrences FROM events_log GROUP BY activity HAVING COUNT(activity) > 100;
SELECT activity, COUNT(activity) as num_actions FROM events_log WHERE activity LIKE '%processing declarations%' GROUP BY activity HAVING COUNT(activity) > 100;
SELECT COUNT(DISTINCT idcase) AS num_cases, employee, supervisor, administration, pre_approver, budget_owner, director FROM events_log GROUP BY employee, supervisor, administration, pre_approver, budget_owner, director;
SELECT COUNT(DISTINCT idcase) as num_cases FROM events_log WHERE activity IN ('employee', 'supervisor', 'administration', 'pre-approver', 'budget owner', 'supervisor', 'director');
SELECT COUNT(DISTINCT idcase) AS num_cases, employee, supervisor, administration, pre_approver, budget_owner, supervisor, director FROM events_log GROUP BY employee, supervisor, administration, pre_approver, budget_owner, supervisor, director;
SELECT COUNT(DISTINCT idcase) as num_cases, SUM(CASE WHEN activity IN ('employee', 'supervisor', 'administration', 'pre-approver', 'budget owner', 'supervisor', 'director') THEN 1 ELSE 0 END) as num_activities FROM events_log GROUP BY idcase;
SELECT COUNT(DISTINCT idcase) AS num_declarations, CASE WHEN activity IN ('activity1', 'activity2') THEN 'employee' WHEN activity IN ('activity3', 'activity4') THEN 'supervisor' WHEN activity IN ('activity5', 'activity6') THEN 'administration' WHEN activity IN ('activity7', 'activity8') THEN 'pre-approver' WHEN activity IN ('activity9', 'activity10') THEN 'budget owner' WHEN activity IN ('activity11', 'activity12') THEN 'director' END AS employee_group FROM events_log GROUP BY employee_group;
SELECT activity, COUNT(activity) as activity_count FROM events_log WHERE resource = 'resource_group' GROUP BY activity ORDER BY CASE WHEN activity = 'employee' THEN 1 WHEN activity = 'supervisor' THEN 2 WHEN activity = 'administration' THEN 3 WHEN activity = 'pre-approver' THEN 4 WHEN activity = 'budget owner' THEN 5 WHEN activity = 'supervisor' THEN 6 WHEN activity = 'director' THEN 7 END, activity_count DESC;
SELECT activity, COUNT(activity) as activity_count FROM events_log WHERE resource IN ('employee', 'supervisor', 'administration', 'pre-approver', 'budget owner', 'supervisor', 'director') GROUP BY activity ORDER BY activity_count DESC;
SELECT activity, COUNT(activity) AS num_times FROM events_log GROUP BY activity ORDER BY num_times DESC;
SELECT DISTINCT idcase FROM events_log WHERE timestamp > (SELECT MAX(timestamp) FROM events_log WHERE activity = 'trip ended');
SELECT DISTINCT idcase FROM events_log WHERE timestamp > (SELECT MAX(timestamp) FROM events_log WHERE activity = 'end of trip');
SELECT idcase FROM events_log WHERE activity = 'trip completed'
SELECT DISTINCT idcase FROM events_log WHERE timestamp > (SELECT MAX(timestamp) FROM events_log WHERE activity = 'end of trip');
SELECT DISTINCT idcase FROM events_log WHERE timestamp > (SELECT MAX(timestamp) FROM events_log WHERE activity = 'end of trip');
SELECT DISTINCT resource FROM events_log WHERE activity = 'end of the trip' AND resource IN ( SELECT resource FROM events_log WHERE activity = 'register of actions' AND timestamp > ( SELECT timestamp FROM events_log WHERE activity = 'end of the trip' ) )
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'send reminder' AND timestamp = (SELECT MAX(timestamp) FROM events_log WHERE idcase = events_log.idcase);
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'send reminder' AND timestamp = (SELECT MAX(timestamp) FROM events_log)
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'send reminder' AND timestamp = (SELECT MAX(timestamp) FROM events_log WHERE idcase = events_log.idcase);
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'send reminder' AND timestamp = (SELECT MAX(timestamp) FROM events_log WHERE idcase = events_log.idcase);
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'send reminder' AND timestamp = (SELECT MAX(timestamp) FROM events_log WHERE activity = 'send reminder');
SELECT COUNT(*) FROM events_log WHERE activity = 'send reminder';
SELECT DISTINCT resource FROM events_log WHERE timestamp = '2018-03-31' AND activity <> 'working';
SELECT DISTINCT resource FROM events_log WHERE timestamp = '2018-03-31' AND resource NOT IN (SELECT DISTINCT resource FROM events_log WHERE timestamp = '2018-03-31');
SELECT DISTINCT resource FROM events_log WHERE timestamp NOT LIKE '2018-03-31%';
SELECT resource FROM events_log WHERE timestamp >= '2018-03-31 00:00:00' AND timestamp < '2018-04-01 00:00:00' AND activity = 'idle';
SELECT DISTINCT resource FROM events_log WHERE activity = 'idle' AND timestamp >= '2018-03-31 00:00:00' AND timestamp < '2018-04-01 00:00:00' AND resource IN ( SELECT resource FROM events_log WHERE activity = 'travel declaration' AND timestamp >= '2018-03-31 00:00:00' AND timestamp < '2018-04-01 00:00:00' )
SELECT DISTINCT resource FROM events_log WHERE activity != 'declaration processing' AND timestamp = '2018-03-31';
SELECT activity, COUNT(id) as num_events FROM events_log WHERE timestamp BETWEEN '2018-12-01' AND '2018-12-05' GROUP BY activity;
SELECT activity, COUNT(activity) as frequency FROM events_log WHERE timestamp BETWEEN '2018-12-01' AND '2018-12-05' GROUP BY activity;
SELECT activity, COUNT(activity) as frequency FROM events_log WHERE timestamp BETWEEN '2018-12-01' AND '2018-12-05' GROUP BY activity;
SELECT activity, COUNT(activity) as frequency FROM events_log WHERE timestamp BETWEEN '2018-12-01' AND '2018-12-05' GROUP BY activity;
SELECT activity, COUNT(activity) FROM events_log WHERE timestamp BETWEEN '2018-12-01' AND '2018-12-05' GROUP BY activity;
SELECT activity, COUNT(activity) as frequency FROM events_log WHERE activity = 'processing declarations completed' AND timestamp BETWEEN '2018-12-01' AND '2018-12-05' GROUP BY activity;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'payment handled';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity != 'payment handled';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'payment handled' AND cost IS NULL;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity != 'payment handled';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'payment handled' AND idcase NOT IN (SELECT idcase FROM events_log WHERE activity = 'performance recorded');
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'declaration' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'payment' )
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'declaration' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'payment' )
SELECT idcase, MAX(timestamp) FROM events_log WHERE activity != 'payment' GROUP BY idcase;
SELECT activity, COUNT(DISTINCT resource) AS num_resources FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT resource) as distinct_resources FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT resource) AS num_resources FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT resource) AS unique_resources FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT resource) as distinct_resources FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT resource) AS num_employees FROM events_log GROUP BY activity;
SELECT DISTINCT activity FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log WHERE activity = 'send reminder' ) AND timestamp < ( SELECT timestamp FROM events_log WHERE activity = 'send reminder' )
SELECT activity FROM events_log WHERE timestamp < (SELECT MIN(timestamp) FROM events_log WHERE activity = 'send reminder');
SELECT activity FROM events_log WHERE activity = 'reminder' AND idcase IN ( SELECT idcase FROM events_log WHERE activity = 'sending' AND resource = 'travel declaration' )
SELECT idcase, COUNT(id) as num_events FROM events_log GROUP BY idcase;
SELECT COUNT(idcase) as num_cases, COUNT(id) as num_events FROM events_log GROUP BY idcase;
SELECT COUNT(idcase) AS num_cases, COUNT(id) AS num_events FROM ( SELECT idcase, COUNT(id) AS num_events FROM events_log GROUP BY idcase ) AS event_counts GROUP BY num_events;
SELECT COUNT(DISTINCT idcase) as num_cases, COUNT(*) as event_count FROM ( SELECT idcase, COUNT(*) as event_count FROM events_log GROUP BY idcase ) as subquery GROUP BY event_count;
SELECT COUNT(id) as num_events, COUNT(DISTINCT idcase) as num_declarations FROM events_log GROUP BY idcase;
SELECT AVG(total_cost) FROM ( SELECT idcase, SUM(cost) as total_cost FROM events_log GROUP BY idcase ) as total_costs;
SELECT AVG(total_cost) AS mean_total_costs FROM ( SELECT idcase, SUM(cost) AS total_cost FROM events_log GROUP BY idcase ) subquery;
SELECT AVG(total_cost) FROM ( SELECT idcase, SUM(cost) as total_cost FROM events_log GROUP BY idcase ) as total_costs;
SELECT AVG(total_cost) as mean_total_costs FROM ( SELECT idcase, SUM(cost) as total_cost FROM events_log GROUP BY idcase ) subquery;
SELECT AVG(total_cost) AS mean_total_cost FROM ( SELECT idcase, SUM(cost) AS total_cost FROM events_log GROUP BY idcase ) subquery;
SELECT AVG(cost) FROM events_log WHERE activity = 'processing' AND resource = 'declarations';
SELECT resource, AVG(cost) AS mean_cost FROM events_log GROUP BY resource;
SELECT resource, AVG(cost) as mean_cost FROM events_log GROUP BY resource;
SELECT resource, AVG(cost) as mean_cost FROM events_log GROUP BY resource;
SELECT resource, AVG(cost) as mean_cost FROM events_log GROUP BY resource;
SELECT resource, AVG(cost) as mean_cost FROM events_log GROUP BY resource;
SELECT resource, AVG(cost) as mean_cost FROM events_log GROUP BY resource;
SELECT resource, COUNT(resource) as frequency FROM events_log GROUP BY resource ORDER BY frequency DESC LIMIT 10;
SELECT resource, COUNT(resource) as frequency FROM events_log GROUP BY resource ORDER BY frequency DESC LIMIT 10;
SELECT resource, COUNT(resource) as frequency FROM events_log GROUP BY resource ORDER BY frequency DESC LIMIT 10;
SELECT resource, COUNT(resource) as frequency FROM events_log GROUP BY resource ORDER BY frequency DESC LIMIT 10;
SELECT resource, COUNT(resource) as num_events FROM events_log GROUP BY resource ORDER BY num_events DESC LIMIT 10;
SELECT resource, COUNT(resource) as num_requests FROM events_log WHERE activity = 'processing travel declarations' GROUP BY resource ORDER BY num_requests DESC LIMIT 10;
SELECT strftime('%Y-%m-%d', timestamp) as day, count(*) as num_events FROM events_log GROUP BY day;
SELECT strftime('%Y-%m-%d', timestamp) as day, activity, count(*) as occurrences FROM events_log GROUP BY day, activity;
SELECT strftime('%Y-%m-%d', timestamp) as day, count(activity) as actions_performed FROM events_log WHERE activity = 'processing the declarations' GROUP BY day;
SELECT DISTINCT idcase FROM events_log WHERE activity IN ( SELECT activity FROM events_log GROUP BY activity HAVING COUNT(DISTINCT resource) > 1 )
SELECT DISTINCT e1.idcase FROM events_log e1 JOIN events_log e2 ON e1.idcase = e2.idcase AND e1.timestamp = e2.timestamp - 1 WHERE e1.activity = e2.activity AND e1.resource <> e2.resource;
SELECT idcase, activity, timestamp, resource FROM events_log WHERE id IN ( SELECT id FROM events_log GROUP BY idcase, activity HAVING COUNT(DISTINCT resource) > 1 )
SELECT idcase, COUNT(*) as num_events_before_declaration FROM events_log WHERE activity = 'declaration final approved by director' GROUP BY idcase;
SELECT COUNT(*) FROM events_log WHERE activity = 'declaration final approved by director';
SELECT idcase, COUNT(*) AS interventions_before_approval FROM events_log WHERE activity = 'final approval from director' GROUP BY idcase;
SELECT idcase, MAX(CASE WHEN activity = 'permit approved by administration' THEN timestamp END) - MAX(CASE WHEN activity = 'permit submitted by employee' THEN timestamp END) AS time_passed FROM events_log WHERE activity IN ('permit submitted by employee', 'permit approved by administration') GROUP BY idcase;
SELECT MAX(timestamp) - MIN(timestamp) AS time_interval FROM events_log WHERE activity = 'permit submitted by employee' OR activity = 'permit approved by administration' GROUP BY idcase HAVING COUNT(DISTINCT activity) = 2;
SELECT MAX(timestamp) - MIN(timestamp) AS time_passed FROM events_log WHERE activity = 'permit requested' OR activity = 'permit approved' GROUP BY idcase HAVING COUNT(DISTINCT activity) = 2;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'rework';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'rework';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'rework';
SELECT idcase, COUNT(DISTINCT id) AS rework_count FROM events_log WHERE activity = 'declaration' GROUP BY idcase HAVING COUNT(DISTINCT activity) > 1;
SELECT idcase, activity FROM events_log WHERE activity = 'declaration' AND resource = 'rework' GROUP BY idcase;
SELECT activity, COUNT(activity) as num_occurrences FROM events_log GROUP BY activity HAVING COUNT(activity) > 1;
SELECT DISTINCT idcase FROM events_log WHERE activity = (SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 1) AND timestamp = (SELECT MAX(timestamp) FROM events_log e2 WHERE e2.idcase = events_log.idcase AND e2.activity = events_log.activity AND e2.timestamp < events_log.timestamp);
SELECT DISTINCT idcase FROM events_log e1 WHERE EXISTS ( SELECT 1 FROM events_log e2 WHERE e1.idcase = e2.idcase AND e1.activity = e2.activity AND e1.timestamp = e2.timestamp - 1 )
SELECT DISTINCT idcase FROM events_log WHERE activity IN ( SELECT activity FROM events_log GROUP BY activity, idcase HAVING COUNT(DISTINCT timestamp) > 1 ) ORDER BY idcase;
SELECT idcase, activity FROM events_log WHERE activity = (SELECT activity FROM events_log GROUP BY activity HAVING COUNT(DISTINCT timestamp) > 1) ORDER BY idcase, timestamp;
SELECT idcase FROM events_log WHERE activity = 'declaration' AND idcase IN ( SELECT idcase FROM events_log WHERE activity = 'intervention' GROUP BY idcase HAVING COUNT(DISTINCT timestamp) > 1 )
SELECT DISTINCT e1.idcase, e1.activity FROM events_log e1 JOIN events_log e2 ON e1.idcase = e2.idcase WHERE e1.timestamp = e2.timestamp - 1 AND e1.activity = e2.activity;
SELECT DISTINCT employee FROM employees WHERE supervisor = 1;
SELECT DISTINCT resource FROM events_log WHERE activity = 'supervisor'
SELECT DISTINCT resource FROM events_log WHERE activity = 'budget'
SELECT DISTINCT resource FROM events_log WHERE activity = 'budget owner'
