SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT activity FROM event_log WHERE cost IS NOT NULL;
SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT event_log.activity FROM event_log WHERE event_log.activity = 'declaration_processed' AND event_log.cost > 0;
SELECT activity, COUNT(*) AS count FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log WHERE activity = 'Declaration' ) GROUP BY activity ORDER BY count DESC;
SELECT idcase, COUNT(*) AS activity_count FROM event_log GROUP BY idcase ORDER BY activity_count DESC LIMIT 10;
SELECT activity, COUNT(*) AS num_actions FROM event_log GROUP BY activity ORDER BY num_actions DESC LIMIT 10;
SELECT activity, COUNT(*) AS num_actions FROM event_log GROUP BY activity ORDER BY num_actions DESC LIMIT 10;
SELECT idcase, COUNT(*) AS event_count FROM event_log GROUP BY idcase ORDER BY event_count DESC LIMIT 10;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) >= 100 ORDER BY COUNT(*) DESC;
SELECT DISTINCT e1.activity FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e1.activity LIKE '%Sara%' AND e2.activity LIKE '%Thomas%';
SELECT COUNT(*) FROM event_log WHERE idcase = 56300;
SELECT resource FROM event_log GROUP BY idcase HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY idcase HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY idcase, resource HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY idcase HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY idcase, resource HAVING COUNT(*) > 5;
SELECT resource FROM event_log WHERE activity = 'declaration' GROUP BY resource HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 5;
SELECT resource, idcase, COUNT(*) AS null_cost_events FROM event_log WHERE cost IS NULL GROUP BY resource, idcase;
SELECT resource, COUNT(*) AS null_cost_events FROM event_log WHERE cost IS NULL GROUP BY resource;
SELECT resource, idcase, COUNT(*) AS null_cost_events FROM event_log WHERE cost IS NULL GROUP BY resource, idcase;
SELECT resource, COUNT(*) AS null_cost_events FROM event_log WHERE cost IS NULL GROUP BY resource;
SELECT resource, idcase, COUNT(*) AS null_cost_events FROM event_log WHERE cost IS NULL GROUP BY resource, idcase;
SELECT idcase, COUNT(*) AS null_cost_events FROM event_log WHERE cost IS NULL GROUP BY idcase;
SELECT COUNT(*) AS interventions_without_cost FROM event_log WHERE activity = 'process_declaration' AND cost IS NULL GROUP BY idcase;
SELECT e.employee_id, e.name, COUNT(el.id) AS interventions_without_cost FROM employee AS e LEFT JOIN event_log AS el ON e.employee_id = el.employee_id WHERE el.activity = 'process_declaration' AND el.cost IS NULL GROUP BY e.employee_id, e.name ORDER BY interventions_without_cost DESC;
SELECT activity FROM event_log WHERE activity LIKE '%end%' AND date(timestamp) = '2017-12-12' AND id NOT IN ( SELECT id FROM event_log WHERE activity LIKE '%start%' AND date(timestamp) = '2017-12-12' );
SELECT timestamp, JULIANDAY(timestamp) - JULIANDAY(event_log.timestamp) AS time_spent FROM event_log WHERE activity = 'Declaration submitted' AND idcase IN ( SELECT idcase FROM event_log WHERE activity = 'Declaration approved by supervisor' );
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE NOT EXISTS ( SELECT 1 FROM event_log WHERE idcase = event_log.idcase AND cost IS NOT NULL );
SELECT COUNT(*) FROM event_log WHERE cost IS NULL;
SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT event_log.id, event_log.activity, event_log.timestamp, event_log.resource, event_log.cost, event_log.idcase FROM event_log WHERE event_log.cost IS NOT NULL;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) <= 10;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity FROM event_log WHERE activity LIKE '%processing%' GROUP BY activity HAVING COUNT(*) >= 100;
