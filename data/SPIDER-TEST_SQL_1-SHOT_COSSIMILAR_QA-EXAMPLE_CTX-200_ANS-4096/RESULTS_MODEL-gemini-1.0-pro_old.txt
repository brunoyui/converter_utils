SELECT COUNT(*) FROM event_log WHERE activity = 'End trip';
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip';
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip';
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip'
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip';
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip';
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip';
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip';
SELECT COUNT(*) FROM events_log WHERE activity = 'End trip'
SELECT count(*) FROM event_log WHERE activity = 'End trip'
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip';
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip' AND resource = 'James';
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip' AND resource = 'James';
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip' AND resource = 'James' AND timestamp LIKE '2016%';
SELECT count(*) FROM events_log WHERE activity = 'End trip' AND resource = 'James'
SELECT count(*) FROM events_log WHERE activity = 'End trip' AND resource = 'James'
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip' AND resource = 'James';
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip' AND resource = 'James';
SELECT count(*) FROM events_log WHERE activity = 'End trip' AND resource = 'James'
SELECT count(*) FROM events_log WHERE activity = 'End trip' AND resource = 'James'
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip' AND resource = 'James';
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip' AND resource = 'James';
SELECT COUNT(*) AS "Number of Events", resource FROM event_log GROUP BY resource;
SELECT COUNT(*) AS "Number of Events", resource FROM event_log GROUP BY resource;
SELECT COUNT(*), resource FROM event_log GROUP BY resource;
SELECT COUNT(DISTINCT id), resource FROM event_log GROUP BY resource
SELECT COUNT(*) AS "Number of Events", resource FROM event_log GROUP BY resource
SELECT resource, COUNT(*) AS count FROM events_log GROUP BY resource ORDER BY count DESC;
SELECT resource, COUNT(*) AS count FROM events_log GROUP BY resource ORDER BY count DESC;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource
SELECT resource, COUNT(DISTINCT(activity)) FROM events_log GROUP BY resource
SELECT resource, COUNT(DISTINCT(activity)) FROM events_log GROUP BY resource
SELECT resource, count(*) AS action_count FROM events_log WHERE activity LIKE '%travel declaration%' GROUP BY resource ORDER BY action_count DESC;
SELECT COUNT(*) FROM event_log WHERE resource = 'Peter';
SELECT COUNT(*) AS "Number of Activities" FROM event_log WHERE resource = 'Peter';
SELECT COUNT(*) FROM event_log WHERE resource = 'Peter';
SELECT COUNT(*) FROM event_log WHERE resource = 'Peter';
SELECT COUNT(*) FROM event_log WHERE resource = 'Peter';
SELECT COUNT(*) FROM event_log WHERE resource = 'Peter';
SELECT resource,COUNT(*) FROM events_log WHERE resource = 'Peter' GROUP BY resource
SELECT idcase FROM events_log GROUP BY idcase HAVING max(timestamp) BETWEEN '2018-03-01' AND '2018-03-31';
SELECT idcase FROM events_log GROUP BY idcase HAVING max(timestamp) BETWEEN '2018-03-01' AND '2018-03-31';
SELECT idcase FROM event_log WHERE activity = 'Terminated' AND timestamp BETWEEN '2018-03-01' AND '2018-04-01';
SELECT idcase FROM events_log WHERE timestamp BETWEEN '2018-03-01' AND '2018-04-01';
SELECT idcase FROM event_log WHERE timestamp IN ( SELECT MAX(timestamp) FROM event_log WHERE STRFTIME('%Y-%m', timestamp) = '2018-03' )
SELECT idcase FROM events_log GROUP BY idcase HAVING max(timestamp) BETWEEN '2018-03-01' AND '2018-03-31';
SELECT idcase FROM events_log GROUP BY idcase HAVING max(timestamp) BETWEEN '2018-03-01' AND '2018-03-31';
SELECT idcase FROM events_log GROUP BY idcase HAVING max(timestamp) BETWEEN '2018-03-01' AND '2018-03-31';
SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' EXCEPT SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' AND resource = 'Douglas'
SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' AND resource <> 'Douglas';
SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' EXCEPT SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' AND resource = 'Douglas'
SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' EXCEPT SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' AND resource = 'Douglas'
SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' AND resource <> 'Douglas'
SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' EXCEPT SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' AND resource = 'Douglas';
SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' AND resource <> 'Douglas'
SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' EXCEPT SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' AND resource = 'Douglas'
SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' EXCEPT SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' AND resource = 'Douglas';
SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' EXCEPT SELECT DISTINCT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' AND resource = 'Douglas';
SELECT idcase FROM event_log WHERE activity = 'Declaration rejected by pre-approver' AND resource <> 'Douglas'
SELECT DISTINCT resource FROM events_log WHERE activity = 'Declaration rejected by pre-approver' AND resource NOT IN ( SELECT resource FROM events_log WHERE activity = 'Declaration rejected by pre-approver' AND resource = 'Douglas' );
SELECT * FROM event_log WHERE activity = 'Declaration rejected by pre-approver' AND resource != 'Douglas';
SELECT COUNT (DISTINCT resource) FROM event_log
SELECT COUNT(DISTINCT resource) FROM event_log
SELECT COUNT(DISTINCT resource) FROM event_log;
SELECT count (DISTINCT resource) FROM events_log
SELECT COUNT(DISTINCT resource) FROM event_log
SELECT COUNT (DISTINCT resource) FROM event_log
SELECT COUNT(DISTINCT(resource)) FROM events_log
SELECT COUNT(DISTINCT resource) FROM event_log;
SELECT COUNT(DISTINCT resource) FROM event_log
SELECT COUNT(DISTINCT resource) FROM events_log
SELECT COUNT(DISTINCT idcase) FROM event_log
SELECT COUNT(DISTINCT resource) FROM events_log WHERE activity = 'Processing Declarations';
SELECT COUNT(DISTINCT resource) FROM event_log;
SELECT resource, COUNT(*) AS total_events FROM event_log GROUP BY resource;
SELECT COUNT(*) AS "Total Events", resource FROM event_log GROUP BY resource;
SELECT resource,COUNT(*) FROM event_log GROUP BY resource
SELECT COUNT(*) AS "Total Actions", resource AS "Employee" FROM events_log GROUP BY resource;
SELECT DISTINCT idcase FROM events_log WHERE cost > 2225
SELECT DISTINCT idcase FROM event_log WHERE cost > 2225;
SELECT "idcase" FROM "event_log" WHERE "cost" > 2225
SELECT DISTINCT idcase FROM event_log WHERE cost > 2225;
SELECT id, activity, resource, cost FROM events_log WHERE cost > 2225;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS num_events FROM events_log WHERE activity LIKE '%declaration%' GROUP BY resource ORDER BY num_events DESC LIMIT 10;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS count FROM events_log WHERE activity = 'Processing declaration' GROUP BY resource ORDER BY count DESC LIMIT 10;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC;
SELECT resource,COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC;
SELECT resource, COUNT(*) AS num_activities FROM event_log GROUP BY resource ORDER BY num_activities DESC;
SELECT resource, COUNT(*) AS count FROM event_log GROUP BY resource ORDER BY count DESC;
SELECT * FROM event_log WHERE cost <> 0;
SELECT * FROM event_log WHERE cost > 0;
SELECT * FROM events_log WHERE cost > 0;
SELECT activity FROM event_log WHERE cost IS NOT NULL;
SELECT * FROM event_log WHERE cost <> 0;
SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT activity, cost FROM event_log WHERE cost IS NOT NULL;
SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT id, activity, resource, cost FROM event_log WHERE cost IS NOT NULL;
SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT * FROM event_log WHERE activity IN ('Start trip', 'Request payment');
SELECT * FROM event_log WHERE activity = 'Start trip' OR activity = 'Request payment';
SELECT * FROM event_log WHERE activity = 'Start trip' OR activity = 'Request payment'
SELECT * FROM event_log WHERE activity IN ('Start trip', 'Request payment');
SELECT el1.id, el1.activity AS start_trip_activity, el1.timestamp AS start_trip_timestamp, el2.id, el2.activity AS payment_request_activity, el2.timestamp AS payment_request_timestamp FROM event_log el1 JOIN event_log el2 ON el1.idcase = el2.idcase WHERE el1.activity = 'Start trip' AND el2.activity = 'Request payment'
SELECT activity, COUNT(*) AS count FROM event_log GROUP BY activity ORDER BY count DESC LIMIT 10;
SELECT activity, COUNT(*) AS count FROM event_log GROUP BY activity ORDER BY count DESC LIMIT 10;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) = ( SELECT COUNT(*) FROM event_log GROUP BY activity ORDER BY COUNT(*) DESC LIMIT 1 );
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) = ( SELECT COUNT(*) FROM event_log GROUP BY activity ORDER BY COUNT(*) DESC LIMIT 1 );
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) = (SELECT COUNT(*) FROM events_log GROUP BY activity ORDER BY COUNT(*) DESC LIMIT 1)
SELECT activity, COUNT(*) AS activity_count FROM event_log GROUP BY activity ORDER BY activity_count DESC;
SELECT activity, COUNT(*) AS count FROM event_log GROUP BY activity ORDER BY count DESC;
SELECT activity, COUNT(*) AS event_count FROM events_log GROUP BY activity ORDER BY event_count DESC;
SELECT activity, COUNT(*) AS count FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) IN ( SELECT COUNT(*) FROM event_log GROUP BY idcase ORDER BY COUNT(*) DESC LIMIT 10 ) ) GROUP BY activity ORDER BY count DESC;
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03';
SELECT * FROM event_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-12-31';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03';
SELECT * FROM event_log WHERE STRFTIME('%Y', timestamp) = '2017';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03';
SELECT DISTINCT activity FROM event_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-12-31';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03';
SELECT DISTINCT activity FROM event_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-12-31';
SELECT activity FROM event_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-12-31';
SELECT * FROM event_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-12-31';
SELECT * FROM events_log WHERE idcase LIKE '%declaration%' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31'
SELECT el.activity, el.timestamp, el.resource, el.cost, el.idcase FROM event_log AS el JOIN cases AS c ON el.idcase = c.id WHERE c.year = 2017 AND el.activity LIKE '%Declaration%' ORDER BY el.timestamp;
SELECT activity FROM event_log WHERE activity LIKE '%declaration%' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31';
SELECT activity, COUNT(*) AS count FROM event_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-12-31' AND activity LIKE '%processing declarations%' GROUP BY activity ORDER BY count DESC;
SELECT activity, COUNT(*) AS count FROM event_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-12-31' AND activity LIKE '%declaration%' GROUP BY activity ORDER BY count DESC;
SELECT idcase FROM events_log group by idcase having count(*) <= 20
SELECT idcase FROM events_log group by idcase having count(*) <= 20
SELECT idcase FROM events_log group by idcase having count(*) <= 20
SELECT idcase FROM events_log GROUP BY idcase HAVING count(*) <= 20
SELECT idcase, COUNT(*) AS event_count FROM event_log GROUP BY idcase HAVING event_count <= 20;
SELECT idcase, COUNT(*) AS event_count FROM event_log GROUP BY idcase HAVING event_count <= 20;
SELECT DISTINCT resource, COUNT(*) AS num_events FROM events_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource from event_log GROUP BY resource HAVING COUNT(*) IN (SELECT COUNT(*) FROM event_log GROUP BY resource ORDER BY COUNT(*) desc LIMIT 5)
SELECT resource from event_log GROUP BY resource HAVING COUNT(*) IN (SELECT COUNT(*) FROM event_log GROUP BY resource ORDER BY COUNT(*) desc LIMIT 5)
SELECT resource from event_log GROUP BY resource HAVING COUNT(*) IN (SELECT COUNT(*) FROM event_log GROUP BY resource ORDER BY COUNT(*) desc LIMIT 5)
SELECT resource from event_log GROUP BY resource HAVING COUNT(*) IN (SELECT COUNT(*) FROM event_log GROUP BY resource ORDER BY COUNT(*) desc LIMIT 5)
SELECT resource from event_log GROUP BY resource HAVING COUNT(*) IN (SELECT COUNT(*) FROM event_log GROUP BY resource ORDER BY COUNT(*) desc LIMIT 5)
SELECT resource FROM event_log GROUP BY resource ORDER BY COUNT(*) DESC LIMIT 5;
SELECT resource from event_log GROUP BY resource HAVING COUNT(*) IN (SELECT COUNT(*) FROM event_log GROUP BY resource ORDER BY COUNT(*) desc LIMIT 5)
SELECT resource FROM event_log GROUP BY resource ORDER BY COUNT(*) DESC LIMIT 5;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 5;
SELECT resource, COUNT(*) AS count FROM events_log GROUP BY resource ORDER BY count DESC LIMIT 5;
SELECT resource, COUNT(CASE WHEN activity = 'Start trip' THEN 1 END) AS start_trip_count FROM event_log WHERE timestamp BETWEEN '2016-01-01' AND '2016-12-31' GROUP BY resource;
SELECT resource, COUNT(CASE WHEN activity = 'Start trip' THEN 1 END) AS start_trip_count FROM event_log WHERE timestamp BETWEEN '2016-01-01' AND '2016-12-31' GROUP BY resource;
SELECT resource, COUNT(CASE WHEN activity = 'Start trip' THEN 1 END) AS start_trip_count FROM event_log WHERE timestamp BETWEEN '2016-01-01' AND '2016-12-31' GROUP BY resource;
SELECT resource, COUNT(*) AS num_occurrences FROM event_log WHERE activity = 'Start trip' AND timestamp BETWEEN '2016-01-01' AND '2016-12-31' GROUP BY resource ORDER BY num_occurrences DESC;
SELECT resource, COUNT(CASE WHEN activity = 'Start trip' THEN 1 END) AS start_trip_count FROM event_log WHERE timestamp BETWEEN '2016-01-01' AND '2016-12-31' GROUP BY resource;
SELECT resource, COUNT(*) AS num_start_trips FROM event_log WHERE activity = 'Start trip' AND timestamp BETWEEN '2016-01-01' AND '2016-12-31' GROUP BY resource ORDER BY num_start_trips DESC;
SELECT resource, COUNT(*) AS total_start_trips FROM event_log WHERE activity = 'Start trip' AND timestamp BETWEEN '2016-01-01' AND '2016-12-31' GROUP BY resource;
SELECT COUNT(*), resource FROM events_log WHERE activity = 'Start trip' AND timestamp BETWEEN '2016-01-01' AND '2016-12-31' GROUP BY resource
SELECT COUNT(DISTINCT activity) AS num_activities, resource FROM event_log WHERE activity LIKE '%start%' AND timestamp BETWEEN '2016-01-01' AND '2016-12-31' GROUP BY resource
SELECT COUNT(*) AS "Number of Occurrences", resource FROM events_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource;
SELECT COUNT(*) AS occurrences, resource FROM events_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource;
SELECT COUNT(*) AS num_performances, resource FROM events_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource;
SELECT COUNT(*) AS occurrences, resource FROM event_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource;
SELECT COUNT(*) AS num_performances, resource FROM events_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource;
SELECT COUNT(*) AS "Occurrences", resource FROM events_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource;
SELECT COUNT(*) AS num_performances, resource FROM events_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource;
SELECT COUNT(*), resource FROM event_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource;
SELECT COUNT(*), resource FROM event_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource;
SELECT COUNT(*), resource FROM events_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource
SELECT COUNT(DISTINCT idcase) AS "Number of Declarations Rejected", resource AS "Supervisor" FROM events_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource ORDER BY "Number of Declarations Rejected" DESC;
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING count(activity) > 20
SELECT DISTINCT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) > 20;
SELECT activity, COUNT(*) AS count FROM event_log GROUP BY activity HAVING count > 20;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) > 20
SELECT idcase FROM events_log group by idcase having count(*) > 20
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) > 20;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) > 20;
SELECT idcase, COUNT(DISTINCT activity) AS num_activities FROM event_log GROUP BY idcase HAVING num_activities > 20;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 20;
SELECT idcase, COUNT(*) AS event_count FROM event_log GROUP BY idcase ORDER BY event_count DESC LIMIT 10;
SELECT idcase, COUNT(DISTINCT activity) AS activity_count FROM event_log GROUP BY idcase ORDER BY activity_count DESC LIMIT 10;
SELECT idcase FROM events_log GROUP BY idcase ORDER BY COUNT(*) DESC LIMIT 10;
SELECT idcase, COUNT(DISTINCT id) AS activity_count FROM event_log GROUP BY idcase ORDER BY activity_count DESC LIMIT 1;
SELECT idcase, COUNT(*) AS event_count FROM event_log GROUP BY idcase ORDER BY event_count DESC LIMIT 5;
SELECT idcase, COUNT(*) AS num_activities FROM event_log GROUP BY idcase ORDER BY num_activities DESC LIMIT 5;
SELECT idcase, COUNT(*) from events_log GROUP BY idcase HAVING COUNT(*) IN (SELECT COUNT(*) FROM events_log GROUP BY idcase ORDER BY COUNT(*) desc LIMIT 10) ORDER BY COUNT(*) DESC
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Sara' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'Request payment' );
SELECT DISTINCT idcase FROM event_log WHERE resource = 'Sara' AND activity <> 'Request payment';
SELECT DISTINCT idcase FROM event_log WHERE resource = 'Sara' AND activity <> 'Request payment';
SELECT idcase FROM event_log WHERE resource = 'Sara' AND activity = 'Start trip' AND idcase NOT IN ( SELECT idcase FROM event_log WHERE activity = 'Request payment' );
SELECT DISTINCT idcase FROM events_log WHERE idcase NOT IN (SELECT idcase FROM events_log WHERE activity = 'Request payment') AND resource = 'Sara';
SELECT e.idcase FROM event_log AS e JOIN resources AS r ON e.resource = r.name WHERE r.employee = 'Sara' AND e.activity = 'Declare expense' EXCEPT SELECT idcase FROM event_log WHERE activity = 'Request payment';
SELECT * FROM event_log WHERE timestamp BETWEEN '2017-01-10' AND '2017-02-01' AND idcase = 'declaration 143598';
SELECT id, activity, timestamp, resource, cost FROM event_log WHERE idcase = 'declaration 143598' AND timestamp BETWEEN '2017-01-10' AND '2017-02-01' ORDER BY timestamp;
SELECT id, activity, resource, cost FROM event_log WHERE idcase = 'declaration 143598' AND timestamp BETWEEN '2017-01-10' AND '2017-02-01';
SELECT cost FROM event_log WHERE idcase = 'declaration 143598' AND timestamp BETWEEN '2017-01-10' AND '2017-02-01';
SELECT * FROM event_log WHERE timestamp BETWEEN '2017-01-10' AND '2017-02-01' AND idcase = '143598';
SELECT COUNT(DISTINCT idcase), resource FROM event_log WHERE timestamp between '2017-01-01' and '2017-05-31' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM event_log WHERE timestamp between '2017-01-01' and '2017-05-31' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM event_log WHERE timestamp between '2017-01-01' and '2017-05-31' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-05-31' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM event_log WHERE timestamp between '2017-01-01' and '2017-05-31' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM event_log WHERE timestamp between '2017-01-01' and '2017-05-31' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-05-31' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM event_log WHERE timestamp between '2017-01-01' and '2017-05-31' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM event_log WHERE timestamp between '2017-01-01' and '2017-05-31' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM events_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-05-31' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM event_log WHERE timestamp BETWEEN '2017-01-01' AND '2017-05-31' GROUP BY resource;
SELECT idcase, COUNT(*) AS activity_count FROM event_log GROUP BY idcase ORDER BY activity_count DESC LIMIT 10;
SELECT idcase, COUNT(*) AS num_activities FROM event_log GROUP BY idcase ORDER BY num_activities DESC LIMIT 10;
SELECT idcase, COUNT(*) AS activity_count FROM event_log GROUP BY idcase ORDER BY activity_count DESC LIMIT 10;
SELECT idcase, COUNT(*) AS activity_count FROM event_log GROUP BY idcase ORDER BY activity_count DESC LIMIT 10;
SELECT idcase, COUNT(*) AS activity_count FROM event_log GROUP BY idcase ORDER BY activity_count DESC LIMIT 10;
SELECT idcase, COUNT(*) from event_log GROUP BY idcase HAVING COUNT(*) IN (SELECT COUNT(*) FROM event_log GROUP BY idcase ORDER BY COUNT(*) desc LIMIT 10) ORDER BY COUNT(*) DESC
SELECT idcase, COUNT(*) AS activity_count FROM event_log GROUP BY idcase ORDER BY activity_count DESC LIMIT 10;
SELECT idcase, COUNT(*) AS activity_count FROM event_log GROUP BY idcase ORDER BY activity_count DESC LIMIT 10;
SELECT idcase, COUNT(*) AS activity_count FROM event_log GROUP BY idcase ORDER BY activity_count DESC LIMIT 10;
SELECT idcase, COUNT(DISTINCT activity) AS num_actions FROM event_log GROUP BY idcase ORDER BY num_actions DESC LIMIT 10;
SELECT idcase, COUNT(DISTINCT activity) AS action_diversity FROM event_log GROUP BY idcase ORDER BY action_diversity DESC LIMIT 10;
SELECT idcase, COUNT(*) AS event_count FROM event_log GROUP BY idcase ORDER BY event_count DESC LIMIT 10;
SELECT idcase, COUNT(*) AS event_count FROM event_log GROUP BY idcase ORDER BY event_count DESC LIMIT 10;
SELECT idcase, COUNT(*) AS event_count FROM event_log GROUP BY idcase ORDER BY event_count DESC LIMIT 10;
SELECT idcase, COUNT(*) AS event_count FROM event_log GROUP BY idcase ORDER BY event_count DESC LIMIT 10;
SELECT idcase, COUNT(*) AS event_count FROM event_log GROUP BY idcase ORDER BY event_count DESC LIMIT 10;
SELECT idcase, COUNT(*) AS event_count FROM event_log GROUP BY idcase ORDER BY event_count DESC LIMIT 10;
SELECT idcase FROM events_log GROUP BY idcase ORDER BY Count(DISTINCT activity) DESC LIMIT 10;
SELECT idcase, SUM(cost) AS total_cost FROM events_log GROUP BY idcase;
SELECT SUM(cost) AS total_cost, idcase FROM event_log GROUP BY idcase;
SELECT SUM(cost) AS total_cost, idcase FROM event_log GROUP BY idcase;
SELECT idcase, SUM(cost) AS total_cost FROM event_log GROUP BY idcase;
SELECT idcase, SUM(cost) AS total_cost FROM event_log GROUP BY idcase
SELECT idcase, SUM(cost) AS total_cost FROM event_log GROUP BY idcase
SELECT idcase, SUM(cost) AS total_cost FROM event_log GROUP BY idcase;
SELECT idcase, SUM(cost) AS total_cost FROM events_log GROUP BY idcase ORDER BY total_cost DESC;
SELECT SUM(cost) AS total_cost, idcase FROM event_log WHERE activity = 'Processing Declaration' GROUP BY idcase;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource HAVING event_count >= 100 ORDER BY event_count DESC;
SELECT resource,COUNT(*) AS event_count FROM events_log GROUP BY resource HAVING event_count >= 100 ORDER BY event_count DESC
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) >= 100 ORDER BY COUNT(*) DESC;
SELECT idcase, activity, timestamp, resource, cost FROM event_log ORDER BY idcase, timestamp;
SELECT idcase, activity, timestamp FROM event_log ORDER BY idcase, timestamp;
SELECT idcase, activity, timestamp FROM event_log ORDER BY idcase, timestamp;
SELECT idcase, activity, timestamp FROM event_log ORDER BY idcase, timestamp;
SELECT idcase, activity, timestamp FROM event_log ORDER BY idcase, timestamp;
SELECT activity, COUNT(*) AS count_activity FROM events_log GROUP BY activity ORDER BY count_activity DESC;
SELECT COUNT(*), resource FROM event_log WHERE activity = 'Declaration approved by administration' GROUP BY resource;
SELECT COUNT(*), resource FROM event_log WHERE activity = 'Declaration approved by administration' GROUP BY resource;
SELECT COUNT(*) AS "Total Occurrences", resource FROM event_log WHERE activity = 'Declaration approved by administration' GROUP BY resource;
SELECT COUNT(*) AS "Number of Occurrences", resource FROM event_log WHERE activity = 'Declaration approved by administration' GROUP BY resource;
SELECT COUNT(*) AS "Number of Approvals", resource FROM events_log WHERE activity = 'Declaration approved by administration' GROUP BY resource;
SELECT COUNT(*) AS "Number of Performance Events", resource FROM event_log WHERE activity = 'Declaration approved by administration' GROUP BY resource;
SELECT COUNT(*) AS "Total Occurrences", resource FROM event_log WHERE activity = 'Declaration approved by administration' GROUP BY resource;
SELECT COUNT(*) AS "Number of Approvals", resource FROM events_log WHERE activity = 'Declaration approved by administration' GROUP BY resource;
SELECT activity, count(*) AS activity_count FROM events_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2017-01-01' AND '2018-01-01' GROUP BY activity;
SELECT activity, COUNT(*) AS count FROM event_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31' GROUP BY activity;
SELECT activity, COUNT(*) AS count FROM event_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2017-01-01' AND '2018-01-01' GROUP BY activity;
SELECT COUNT(*), activity FROM events_log WHERE timestamp < '2017-01-10' AND resource = 'Thomas' GROUP BY activity HAVING COUNT(*) > 1
SELECT count(*) FROM events_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2017-01-01' AND '2018-01-01'
SELECT COUNT(*) AS "Number of Occurrences" FROM event_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31';
SELECT COUNT(*) FROM event_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2017-01-01' AND '2018-01-01';
SELECT count(*) FROM events_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2017-01-01' AND '2018-01-01'
SELECT COUNT(*) FROM event_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31';
SELECT COUNT(*) AS "Number of Declarations Processed" FROM events_log WHERE resource = 'Thomas' AND activity LIKE '%Declaration%' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31';
SELECT activity, MAX(timestamp) AS most_recent_date FROM event_log GROUP BY activity;
SELECT activity, MAX(timestamp) AS latest_timestamp FROM event_log GROUP BY activity;
SELECT activity, MAX(timestamp) AS latest_performance_date FROM event_log GROUP BY activity ORDER BY latest_performance_date DESC;
SELECT activity, MAX(timestamp) AS last_performance FROM event_log GROUP BY activity;
SELECT activity, MAX(timestamp) AS latest_performance FROM event_log GROUP BY activity;
SELECT activity, MAX(timestamp) AS last_occurrence FROM event_log GROUP BY activity;
SELECT activity, MAX(timestamp) AS most_recent_date FROM event_log GROUP BY activity ORDER BY most_recent_date DESC;
SELECT MAX(timestamp) AS last_timestamp, activity FROM events_log GROUP BY activity;
SELECT COUNT(*) AS "Number of Occurrences" FROM events_log WHERE activity = 'Permit final approved by director';
SELECT COUNT(*) AS "Number of 'declaration approved by supervisor' activities in 2017" FROM event_log WHERE activity = 'Declaration approved by supervisor' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31'; SELECT COUNT(*) AS "Number of 'permit rejected by employee' activities in 2018" FROM event_log WHERE activity = 'Permit rejected by employee' AND timestamp BETWEEN '2018-01-01' AND '2018-12-31';
SELECT COUNT(DISTINCT idcase) AS "declaration approved by supervisor" FROM event_log WHERE activity = 'Declaration approved by supervisor' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31'; SELECT COUNT(DISTINCT idcase) AS "permit rejected by employee" FROM event_log WHERE activity = 'Permit rejected by employee' AND timestamp BETWEEN '2018-01-01' AND '2018-12-31';
SELECT COUNT(*) AS "Number of Occurrences" FROM event_log WHERE activity = 'Declaration approved by supervisor' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31'; SELECT COUNT(*) AS "Number of Occurrences" FROM event_log WHERE activity = 'Permit rejected by employee' AND timestamp BETWEEN '2018-01-01' AND '2018-12-31';
SELECT COUNT(*) AS "Number of times 'declaration approved by supervisor' activity was performed in 2017" FROM event_log WHERE activity = 'Declaration approved by supervisor' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31'; SELECT COUNT(*) AS "Number of times 'permit rejected by employee' activity was performed in 2018" FROM event_log WHERE activity = 'Permit rejected by employee' AND timestamp BETWEEN '2018-01-01' AND '2018-12-31';
SELECT COUNT(*) AS "Number of Declaration Approvals", resource AS "Supervisor" FROM event_log WHERE activity = 'Declaration approved by supervisor' AND timestamp BETWEEN '2017-01-01' AND '2017-12-31' GROUP BY resource UNION SELECT COUNT(*) AS "Number of Permit Rejections", resource AS "Employee" FROM event_log WHERE activity = 'Permit rejected by employee' AND timestamp BETWEEN '2018-01-01' AND '2018-12-31' GROUP BY resource;
SELECT activity, COUNT(*) AS activity_count FROM events_log GROUP BY activity ORDER BY activity_count DESC;
SELECT activity, MAX(timestamp) AS performance_end_date, id FROM event_log GROUP BY id ORDER BY performance_end_date;
SELECT activity, MAX(timestamp) AS end_date, id FROM event_log WHERE activity LIKE '%declaration%' GROUP BY activity, id ORDER BY end_date;
SELECT count(*) FROM event_log WHERE resource = 'Thomas' AND activity = 'declaration submitted by employee';
SELECT count(*) FROM event_log WHERE activity = 'declaration submitted by employee' AND resource = 'Thomas' AND timestamp BETWEEN '2017-01-01' AND '2018-01-01';
SELECT count(*) FROM event_log WHERE activity = 'declaration submitted by employee' AND resource = 'Thomas'
SELECT COUNT(*) FROM events_log WHERE activity = 'Declaration submitted by employee' AND resource = 'Thomas';
SELECT COUNT(*) FROM events_log WHERE activity = 'Declaration submitted by employee' AND resource = 'Thomas';
SELECT COUNT(*) FROM event_log WHERE activity = 'Declaration Request' AND resource = 'Thomas';
SELECT COUNT(*) FROM events_log WHERE resource = 'Diana' AND cost IS NOT NULL
SELECT activity, count(*) FROM events_log WHERE resource = 'Diana' AND cost IS NOT NULL GROUP BY activity;
SELECT COUNT(*) FROM events_log WHERE resource = 'Diana' AND cost IS NOT NULL;
SELECT * FROM event_log WHERE resource = 'Diana' AND cost IS NOT NULL;
SELECT activity, COUNT(*) AS event_count FROM events_log WHERE resource = 'Diana' AND cost IS NOT NULL GROUP BY activity
SELECT activity, count(*) AS event_count FROM event_log WHERE resource = 'Diana' AND cost IS NOT NULL GROUP BY activity;
SELECT activity FROM event_log WHERE resource = 'Diana' AND cost IS NOT NULL
SELECT COUNT(DISTINCT resource) FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) > 3 );
SELECT COUNT(DISTINCT resource) FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) > 3 );
SELECT COUNT(DISTINCT resource) FROM events_log GROUP BY idcase HAVING COUNT(*) > 3;
SELECT COUNT(DISTINCT resource) FROM event_log GROUP BY idcase HAVING COUNT(*) > 3;
SELECT COUNT(DISTINCT resource) FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) > 3 );
SELECT DISTINCT resource FROM events_log WHERE activity = 'Declaration rejected by pre-approver';
SELECT DISTINCT resource FROM events_log WHERE activity = 'Declaration rejected by pre-approver';
SELECT DISTINCT resource FROM events_log WHERE activity = 'Declaration rejected by pre-approver';
SELECT resource FROM events_log WHERE activity = 'Declaration rejected by pre-approver';
SELECT DISTINCT resource FROM events_log WHERE activity = 'Declaration rejected by pre-approver';
SELECT DISTINCT resource FROM event_log WHERE activity = 'Declaration rejected by pre-approver';
SELECT resource FROM event_log WHERE activity = 'Declaration rejected by pre-approver';
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Declaration final approved by director' AND timestamp BETWEEN '2017-01-01' AND '2017-05-31';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity='Declaration final approved by director' AND timestamp BETWEEN '2017-01-01' AND '2017-05-31';
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Declaration final approved by director' AND timestamp BETWEEN '2017-01-01' AND '2017-05-31';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity LIKE '%approved%' AND resource LIKE '%director%' AND timestamp BETWEEN '2017-01-01' AND '2017-05-31';
SELECT idcase FROM event_log WHERE resource = 'Charles' AND NOT EXISTS ( SELECT 1 FROM event_log WHERE idcase = event_log.idcase AND strftime('%Y-%m', timestamp) = '2018-01' );
SELECT DISTINCT idcase FROM event_log WHERE resource = 'Charles' AND NOT EXISTS ( SELECT 1 FROM event_log WHERE idcase = event_log.idcase AND strftime('%Y-%m', timestamp) = '2018-01' );
SELECT DISTINCT idcase FROM event_log WHERE idcase NOT IN ( SELECT idcase FROM event_log WHERE strftime('%Y-%m', timestamp) = '2018-01' ) AND resource = 'Charles';
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Charles' AND NOT idcase IN ( SELECT idcase FROM events_log WHERE timestamp BETWEEN '2018-01-01' AND '2018-01-31' );
SELECT DISTINCT idcase FROM events_log WHERE activity LIKE '%intervention%' AND resource = 'Charles' AND timestamp NOT BETWEEN '2018-01-01' AND '2018-01-31';
SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT idcase, MAX(timestamp) - MIN(timestamp) AS duration FROM event_log GROUP BY idcase;
SELECT idcase, SUM(duration) AS total_duration FROM ( SELECT idcase, activity, (strftime('%s', next_timestamp) - strftime('%s', timestamp)) AS duration FROM RankedEvents WHERE next_timestamp IS NOT NULL ) GROUP BY idcase
SELECT e.idcase, e.activity, e.timestamp, ( SELECT timestamp FROM event_log WHERE idcase = e.idcase AND activity = 'End trip' ) AS end_timestamp, ( SELECT timestamp FROM event_log WHERE idcase = e.idcase AND activity = 'Declaration rejected by employee' ) AS rejected_timestamp, ( SELECT timestamp FROM event_log WHERE idcase = e.idcase AND activity = 'Payment handled' ) AS payment_timestamp FROM event_log AS e WHERE e.activity = 'Start trip';
SELECT idcase, MAX(timestamp) - MIN(timestamp) AS duration FROM event_log GROUP BY idcase
SELECT idcase, (MAX(timestamp) - MIN(timestamp)) AS duration FROM event_log GROUP BY idcase;
SELECT WITH RankedEvents AS ( SELECT id, activity, timestamp, LEAD(timestamp) OVER (PARTITION BY idcase ORDER BY timestamp) AS next_timestamp, idcase FROM event_log ), DurationEvents AS ( SELECT activity, ( strftime('%s', next_timestamp) - strftime('%s', timestamp) ) AS duration FROM RankedEvents WHERE next_timestamp IS NOT NULL ) SELECT idcase, SUM(duration) AS processing_duration FROM DurationEvents GROUP BY idcase;
SELECT idcase, resource FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase, resource FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase, resource FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase, resource FROM event_log GROUP BY idcase, resource HAVING COUNT(DISTINCT activity) = 1;
SELECT idcase, resource FROM event_log GROUP BY idcase, resource HAVING COUNT(DISTINCT activity) = 1;
SELECT idcase, resource FROM event_log GROUP BY idcase, resource HAVING COUNT(DISTINCT activity) = 1;
SELECT idcase, resource FROM event_log GROUP BY idcase, resource HAVING COUNT(DISTINCT activity) = 1;
SELECT idcase, resource FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase, resource FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT resource, COUNT(DISTINCT activity) AS num_activities FROM events_log GROUP BY resource HAVING COUNT(DISTINCT activity) = 1;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'End trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT idcase FROM events_log WHERE activity = 'End trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'End trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT idcase FROM event_log WHERE activity = 'End trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'End trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'End trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT idcase, timestamp FROM events_log WHERE activity = 'End trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31' ORDER BY resource;
SELECT DISTINCT idcase FROM event_log WHERE activity = 'End trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT DISTINCT idcase FROM event_log WHERE activity = 'End trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT DISTINCT idcase FROM event_log WHERE activity = 'End trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31';
SELECT el.timestamp FROM event_log AS el WHERE el.activity = 'End trip' AND el.timestamp BETWEEN '2016-01-01' AND '2017-12-31' ORDER BY el.timestamp;
SELECT * FROM event_log WHERE activity LIKE '%rejected%'
SELECT * FROM event_log WHERE activity LIKE '%rejected%'
SELECT * FROM event_log WHERE activity LIKE '%rejected%'
SELECT * FROM event_log WHERE activity LIKE '%rejected%'
SELECT * FROM event_log WHERE activity LIKE '%rejected%'
SELECT * FROM event_log WHERE activity LIKE '%rejected%'
SELECT * FROM event_log WHERE activity = 'Declaration rejected by pre-approver';
SELECT activity, COUNT(*) AS intervention_count FROM events_log WHERE activity LIKE '%rejection%' GROUP BY activity;
SELECT idcase, MIN(cost) AS min_cost, MAX(cost) AS max_cost FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log GROUP BY idcase HAVING MAX(cost) > 0 ) GROUP BY idcase
SELECT idcase, MIN(cost) AS min_cost, MAX(cost) AS max_cost FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log GROUP BY idcase HAVING MAX(cost) > 0 ) GROUP BY idcase
SELECT idcase, MIN(cost) AS min_cost, MAX(cost) AS max_cost FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log GROUP BY idcase HAVING MAX(cost) > 0 ) GROUP BY idcase;
SELECT idcase, MIN(cost) AS min_cost, MAX(cost) AS max_cost FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log GROUP BY idcase HAVING MAX(cost) > 0 ) GROUP BY idcase
SELECT idcase, MIN(cost) AS min_cost, MAX(cost) AS max_cost FROM event_log WHERE cost > 0 GROUP BY idcase
SELECT idcase, MIN(cost) AS min_cost, MAX(cost) AS max_cost FROM event_log WHERE cost > 0 GROUP BY idcase
SELECT idcase, MIN(cost) AS min_cost, MAX(cost) AS max_cost FROM event_log WHERE cost > 0 GROUP BY idcase
SELECT idcase, MIN(cost) AS min_cost, MAX(cost) AS max_cost FROM event_log WHERE cost > 0 GROUP BY idcase
SELECT idcase, MIN(cost) AS min_cost, MAX(cost) AS max_cost FROM event_log WHERE cost > 0 GROUP BY idcase
SELECT idcase, MIN(cost) AS min_cost, MAX(cost) AS max_cost FROM events_log WHERE cost > 0 GROUP BY idcase
SELECT idcase, MIN(cost) AS min_cost, MAX(cost) AS max_cost FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log GROUP BY idcase HAVING MAX(cost) > 0 ) GROUP BY idcase;
SELECT idcase, MIN(cost) AS min_cost, MAX(cost) AS max_cost FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log GROUP BY idcase HAVING MAX(cost) > 0 ) GROUP BY idcase;
SELECT e.idcase, MIN(e.cost) AS min_cost, MAX(e.cost) AS max_cost FROM event_log e WHERE e.cost > 0 GROUP BY e.idcase ORDER BY max_cost DESC;
SELECT idcase, MIN(cost) AS min_cost, MAX(cost) AS max_cost FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log WHERE activity = 'Reimbursement' AND cost > 0 ) GROUP BY idcase
SELECT strftime('%s', p.timestamp) - strftime('%s', e.start_time) AS time_taken, p.activity, p.idcase FROM event_log p INNER JOIN ( SELECT MIN(timestamp) AS start_time, idcase FROM event_log GROUP BY idcase ) e ON e.idcase = p.idcase WHERE p.activity IN ('End trip', 'Declaration rejected by employee', 'Payment handled');
SELECT strftime('%s', p.timestamp) - strftime('%s', e.start_time) AS time_taken, p.activity, p.idcase FROM event_log AS p INNER JOIN ( SELECT MIN(timestamp) AS start_time, idcase FROM event_log GROUP BY idcase ) AS e ON e.idcase = p.idcase WHERE p.activity IN ('Declaration rejected by employee', 'Payment handled', 'End trip');
SELECT strftime('%s', p.timestamp) - strftime('%s', e.start_time) AS elapsed_time, p.activity, p.idcase FROM event_log AS p INNER JOIN ( SELECT MIN(timestamp) AS start_time, idcase FROM event_log GROUP BY idcase ) AS e ON e.idcase = p.idcase WHERE p.activity IN ('Declaration rejected by employee', 'Payment handled', 'End trip');
SELECT strftime('%s', p.timestamp) - strftime('%s', e.start_time) AS duration_seconds, p.activity, p.idcase FROM event_log AS p INNER JOIN ( SELECT MIN(timestamp) AS start_time, idcase FROM event_log GROUP BY idcase ) AS e ON e.idcase = p.idcase WHERE p.activity IN ('Declaration rejected by employee', 'Payment handled', 'End trip');
SELECT strftime('%s', p.timestamp) - strftime('%s', e.start_time) AS time_to_end, p.activity AS end_activity, p.idcase FROM event_log p INNER JOIN ( SELECT MIN(timestamp) AS start_time, idcase FROM event_log WHERE activity LIKE '%intervention%' GROUP BY idcase ) e ON e.idcase = p.idcase WHERE p.activity IN ('End trip', 'Declaration rejected by employee', 'Payment handled');
SELECT strftime('%s', p.timestamp) - strftime('%s', e.start_time) AS time_to_final_activity, p.activity AS final_activity, p.idcase FROM events_log AS p INNER JOIN ( SELECT MIN(timestamp) AS start_time, idcase FROM events_log GROUP BY idcase ) AS e ON e.idcase = p.idcase WHERE p.activity IN ('End trip', 'Declaration rejected by employee', 'Payment handled');
SELECT strftime('%s', p.timestamp) - strftime('%s', e.start_time) AS time_taken, p.activity, p.idcase FROM event_log AS p INNER JOIN ( SELECT MIN(timestamp) AS start_time, idcase FROM event_log GROUP BY idcase ) AS e ON e.idcase = p.idcase WHERE p.activity IN ('Declaration rejected by employee', 'Payment handled', 'End trip');
SELECT strftime('%s', p.timestamp) - strftime('%s', e.start_time) AS time_diff, p.activity, p.idcase FROM event_log AS p INNER JOIN ( SELECT MIN(timestamp) AS start_time, idcase FROM event_log GROUP BY idcase ) AS e ON e.idcase = p.idcase WHERE p.activity IN ('Declaration rejected by employee', 'Payment handled', 'End trip');
SELECT e.idcase, e.activity, strftime('%s', e.timestamp) - strftime('%s', s.start_time) AS elapsed_time FROM event_log e JOIN ( SELECT idcase, MIN(timestamp) AS start_time FROM event_log GROUP BY idcase ) s ON e.idcase = s.idcase WHERE e.activity IN ('End trip', 'Declaration rejected by employee', 'Payment handled')
SELECT strftime('%s', p.timestamp) - strftime('%s', e.start_time) AS time_taken FROM event_log AS p JOIN ( SELECT MIN(timestamp) AS start_time, idcase FROM event_log GROUP BY idcase ) AS e ON e.idcase = p.idcase WHERE p.activity IN ('Declaration rejected by employee', 'Payment handled', 'End trip');
SELECT * FROM event_log WHERE activity = 'Request payment';
SELECT * FROM event_log WHERE activity = 'Request payment';
SELECT el.idcase, el.activity, el.timestamp, el.resource, el.cost FROM event_log AS el WHERE el.idcase IN ( SELECT DISTINCT idcase FROM event_log WHERE activity = 'Request payment' )
SELECT el.cost, el.activity, a.action FROM event_log AS el JOIN actions AS a ON el.activity = a.activity ORDER BY el.cost DESC;
SELECT activity, AVG(timestamp - timestamp) AS avg_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp_end - timestamp_start) AS average_duration FROM event_log GROUP BY activity;
SELECT activity, AVG(timestamp - timestamp) AS avg_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS avg_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS mean_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS avg_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS avg_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS average_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS avg_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS avg_duration FROM event_log GROUP BY activity;
SELECT activity, AVG(timestamp - timestamp) AS avg_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS avg_duration FROM event_log GROUP BY activity;
SELECT activity, AVG(timestamp - timestamp) AS avg_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS mean_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS mean_duration FROM event_log GROUP BY activity;
SELECT activity, AVG(timestamp - timestamp) AS avg_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS mean_duration FROM event_log GROUP BY activity;
SELECT activity, AVG(timestamp - timestamp) AS avg_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS mean_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS mean_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS avg_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS average_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS average_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS avg_duration FROM event_log GROUP BY activity
SELECT activity, AVG(timestamp - timestamp) AS avg_duration FROM event_log GROUP BY activity
SELECT activity, AVG(strftime('%s', timestamp) - strftime('%s', timestamp)) FROM events_log GROUP BY activity
SELECT "idcase" FROM "event_log" WHERE "cost" = (SELECT MAX("cost") FROM "event_log");
SELECT idcase, MAX(cost) AS max_cost FROM events_log GROUP BY idcase HAVING max_cost = (SELECT MAX(cost) FROM events_log);
SELECT "idcase" FROM "event_log" WHERE "cost" = (SELECT MAX("cost") FROM "event_log");
SELECT * FROM event_log WHERE cost = (SELECT MAX(cost) FROM event_log)
SELECT * FROM event_log WHERE cost = (SELECT MAX(cost) FROM event_log);
SELECT * FROM event_log WHERE cost = (SELECT MAX(cost) FROM event_log);
SELECT activity, SUM(cost) AS total_cost FROM event_log GROUP BY activity ORDER BY total_cost DESC LIMIT 1;
SELECT * FROM events_log WHERE cost IN (SELECT DISTINCT cost FROM events_log ORDER BY cost DESC LIMIT 5)
SELECT activity, cost FROM event_log WHERE cost IN (SELECT MAX(cost) FROM event_log);
SELECT * FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT * FROM event_log WHERE cost = (SELECT MAX(cost) FROM event_log);
SELECT * FROM event_log WHERE cost = (SELECT MAX(cost) FROM event_log);
SELECT * FROM event_log WHERE cost = (SELECT MAX(cost) FROM event_log);
SELECT * FROM events_log WHERE cost IN (SELECT DISTINCT cost FROM events_log ORDER BY cost DESC LIMIT 5)
SELECT * FROM events_log WHERE cost IN ( SELECT DISTINCT cost FROM events_log ORDER BY cost DESC LIMIT 5 );
SELECT * FROM event_log WHERE cost = (SELECT MAX(cost) FROM event_log);
SELECT * FROM event_log WHERE cost IN (SELECT DISTINCT cost FROM event_log ORDER BY cost DESC LIMIT 5)
SELECT * FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT id, activity, resource, cost FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT activity, cost FROM event_log WHERE cost = (SELECT MAX(cost) FROM event_log);
SELECT * FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT * FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT * FROM events_log WHERE cost = (SELECT MAX(cost) FROM events_log);
SELECT activity FROM event_log WHERE cost = ( SELECT MAX(cost) FROM event_log );
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT * FROM event_log WHERE activity = 'Start trip';
SELECT id, activity, timestamp, resource, cost, idcase FROM event_log WHERE activity = 'Start trip';
SELECT COUNT(*) AS "Total Records", activity FROM event_log GROUP BY activity;
SELECT count(DISTINCT idcase), activity FROM events_log GROUP BY activity
SELECT activity,COUNT(*) FROM events_log GROUP BY activity
SELECT activity, COUNT(*) AS event_count FROM event_log GROUP BY activity ORDER BY event_count DESC;
SELECT COUNT(DISTINCT id) AS "Number of Times Performed", activity FROM event_log GROUP BY activity;
SELECT COUNT(DISTINCT id) AS "Number of Performances", activity FROM event_log GROUP BY activity;
SELECT count(*) AS "Number of Events", activity FROM event_log GROUP BY activity
SELECT activity, COUNT(*) FROM events_log GROUP BY activity
SELECT activity, COUNT(*) AS event_count FROM event_log GROUP BY activity;
SELECT count(id), activity FROM events_log GROUP BY activity
SELECT count(DISTINCT id), activity FROM event_log GROUP BY activity
SELECT count(*) AS "Number of Events", activity FROM event_log GROUP BY activity;
SELECT count(*) AS "Total Performances", activity FROM events_log GROUP BY activity
SELECT count(*) AS "Total Performances", activity FROM events_log GROUP BY activity
SELECT activity, COUNT(*) AS event_count FROM event_log GROUP BY activity ORDER BY event_count DESC;
SELECT activity, COUNT(*) AS count FROM event_log GROUP BY activity;
SELECT count(DISTINCT id) AS "Number of Performances", activity FROM event_log GROUP BY activity;
SELECT activity, COUNT(*) AS num_interventions FROM event_log GROUP BY activity;
SELECT activity, COUNT(*) AS count FROM events_log WHERE activity LIKE '%processing declarations%' GROUP BY activity ORDER BY count DESC;
SELECT activity, COUNT(*) AS num_interventions FROM event_log GROUP BY activity ORDER BY num_interventions DESC;
SELECT COUNT(*) AS "Number of Interventions", activity AS "Type of Intervention" FROM event_log WHERE activity LIKE '%intervention%' GROUP BY activity;
SELECT COUNT(*) AS "Number of Interventions", activity AS "Intervention Type" FROM event_log GROUP BY activity;
SELECT COUNT(*) AS "Number of Interventions", activity AS "Intervention Type" FROM event_log WHERE activity LIKE '%intervention%' GROUP BY activity;
SELECT activity, COUNT(*) AS count_interventions FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) > 3 ) GROUP BY activity ORDER BY count_interventions DESC;
SELECT activity, resource, SUM(cost) FROM events_log GROUP BY activity, resource;
SELECT cost, activity FROM event_log ORDER BY cost DESC;
SELECT activity, resource, SUM(cost) FROM events_log GROUP BY activity, resource;
SELECT activity, cost FROM event_log ORDER BY cost DESC;
SELECT activity, resource, SUM(cost) FROM events_log GROUP BY activity, resource;
SELECT activity, resource, SUM(cost) FROM events_log GROUP BY activity, resource;
SELECT e.activity, COUNT(e.id) AS intervention_count FROM events_log AS e GROUP BY e.activity ORDER BY intervention_count DESC;
SELECT id, activity, resource, cost FROM events_log WHERE cost BETWEEN 50 AND 400 ORDER BY cost DESC;
SELECT * FROM event_log WHERE activity LIKE 'Permit%'
SELECT event_log.activity, event_log.cost FROM event_log WHERE event_log.activity = 'permit' ORDER BY event_log.cost;
SELECT * FROM event_log WHERE activity = 'permit';
SELECT * FROM event_log WHERE activity LIKE 'Permit%'
SELECT * FROM event_log WHERE activity LIKE 'Permit%'
SELECT activity, cost FROM event_log WHERE activity LIKE 'Permit%'
SELECT event_log.id, event_log.activity, event_log.timestamp, event_log.resource, event_log.cost, event_log.idcase FROM event_log WHERE event_log.activity LIKE 'Permit%'
SELECT activity, resource, cost, idcase FROM event_log WHERE activity LIKE 'Permit%'
SELECT cost, activity FROM events_log WHERE activity = 'permit' ORDER BY cost;
SELECT * FROM event_log WHERE activity LIKE 'Permit%'
SELECT event_log.activity, event_log.resource, event_log.cost, event_log.idcase FROM event_log WHERE event_log.activity LIKE '%Permit%' AND event_log.idcase IN ( SELECT idcase FROM event_log WHERE activity LIKE '%Declaration%' );
SELECT e.activity, e.timestamp, e.resource, e.cost, e.idcase FROM event_log e WHERE e.activity LIKE '%Permit%' AND e.idcase IN ( SELECT idcase FROM event_log WHERE activity LIKE '%Declaration%' )
SELECT MAX(cost) FROM event_log
SELECT MAX(cost) FROM event_log
SELECT MAX(cost) FROM event_log
SELECT MAX(cost) AS highest_cost FROM event_log;
SELECT MAX(cost) AS highest_cost FROM event_log;
SELECT MAX(cost) FROM events_log;
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Sara' INTERSECT SELECT DISTINCT idcase FROM events_log WHERE resource = 'Thomas'
SELECT DISTINCT idcase FROM events_log WHERE resource IN ('Thomas', 'Diana', 'Sara');
SELECT DISTINCT idcase FROM events_log WHERE resource IN ('Sara', 'Thomas');
SELECT DISTINCT idcase FROM events_log WHERE resource IN ('Sara', 'Thomas') GROUP BY idcase HAVING COUNT(DISTINCT resource) = 2
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Sara' INTERSECT SELECT DISTINCT idcase FROM events_log WHERE resource = 'Thomas';
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Thomas' INTERSECT SELECT DISTINCT idcase FROM events_log WHERE resource = 'Sara';
SELECT COUNT(*), resource FROM event_log WHERE activity = 'Declaration rejected by administration' GROUP BY resource;
SELECT COUNT(*), resource FROM event_log WHERE activity = 'Declaration rejected by administration' GROUP BY resource;
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY idcase, resource;
SELECT COUNT(*), resource, idcase FROM event_log WHERE activity = 'Declaration rejected by administration' GROUP BY idcase, resource;
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY idcase, resource;
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY idcase, resource;
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY idcase, resource;
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY idcase, resource;
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY idcase, resource;
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY idcase, resource;
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY idcase, resource;
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY resource, idcase
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY resource, idcase
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY resource, idcase
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY resource, idcase
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY resource, idcase
SELECT COUNT(*) AS "Number of Occurrences", resource AS "Resource" FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY resource ORDER BY "Number of Occurrences" DESC;
SELECT COUNT(*) AS "Number of Activities", resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY resource, idcase
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY resource, idcase
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY resource, idcase
SELECT COUNT(*), resource FROM events_log WHERE activity = 'Declaration rejected by administration' AND idcase IN ( SELECT idcase FROM events_log WHERE activity = 'Declaration processed' ) GROUP BY resource;
SELECT AVG(cost) FROM event_log WHERE activity NOT IN ('start trip', 'end trip');
SELECT AVG(cost) FROM event_log WHERE activity NOT IN ('start trip', 'end trip');
SELECT AVG (cost) FROM events_log WHERE activity NOT IN ('start trip', 'end trip')
SELECT strftime('%Y-%m-%d', timestamp) AS event_date, SUM(cost) AS total_cost FROM events_log WHERE activity NOT IN ('start trip', 'end trip') GROUP BY event_date
SELECT AVG(cost) FROM event_log WHERE activity NOT IN ('Start trip', 'End trip');
SELECT AVG(cost) FROM event_log WHERE activity NOT IN ('Start trip', 'End trip');
SELECT AVG(cost) FROM event_log WHERE activity NOT IN ('Start trip', 'End trip');
SELECT AVG(cost) FROM event_log WHERE activity NOT IN ('start trip', 'end trip');
SELECT AVG(cost) FROM event_log WHERE activity NOT IN ('start trip', 'end trip');
SELECT AVG(cost) FROM event_log WHERE activity NOT IN ('START_TRIP', 'END_TRIP') AND activity LIKE '%INTERVENTION%';
SELECT * FROM event_log WHERE cost IN (SELECT DISTINCT cost FROM event_log ORDER BY cost DESC LIMIT 5)
SELECT * FROM event_log WHERE cost IN (SELECT DISTINCT cost FROM event_log ORDER BY cost DESC LIMIT 5)
SELECT * FROM event_log WHERE cost IN ( SELECT DISTINCT cost FROM event_log ORDER BY cost DESC LIMIT 5 )
SELECT activity, timestamp, resource, cost, idcase FROM event_log WHERE cost IN (SELECT DISTINCT cost FROM event_log ORDER BY cost DESC LIMIT 5)
SELECT * FROM event_log WHERE cost IN (SELECT DISTINCT cost FROM event_log ORDER BY cost DESC LIMIT 5)
SELECT * FROM events_log WHERE cost IN (SELECT DISTINCT cost FROM events_log ORDER BY cost DESC LIMIT 5)
SELECT activity, timestamp, resource, cost, idcase FROM event_log WHERE cost IN (SELECT DISTINCT cost FROM event_log ORDER BY cost DESC LIMIT 5)
SELECT activity, cost FROM event_log ORDER BY cost DESC LIMIT 5;
SELECT * FROM event_log WHERE cost IN (SELECT DISTINCT cost FROM event_log ORDER BY cost DESC LIMIT 5)
SELECT * FROM events_log ORDER BY cost DESC LIMIT 5;
SELECT * FROM event_log WHERE cost IN (SELECT DISTINCT cost FROM event_log ORDER BY cost DESC LIMIT 5)
SELECT * FROM event_log WHERE cost IN (SELECT DISTINCT cost FROM event_log ORDER BY cost DESC LIMIT 5)
SELECT * FROM event_log WHERE cost IN (SELECT DISTINCT cost FROM event_log ORDER BY cost DESC LIMIT 5)
SELECT * FROM event_log WHERE cost IN (SELECT DISTINCT cost FROM event_log ORDER BY cost DESC LIMIT 5)
SELECT * FROM event_log WHERE cost IN ( SELECT DISTINCT cost FROM event_log ORDER BY cost DESC LIMIT 5 )
SELECT activity, cost FROM event_log ORDER BY cost DESC LIMIT 5;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 1;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) > 1;
SELECT DISTINCT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) > 1;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 1;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 1;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 1;
SELECT DISTINCT activity FROM events_log GROUP BY activity, idcase HAVING count(activity) > 3;
SELECT DISTINCT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 1;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 1;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 1
SELECT DISTINCT idcase FROM events_log GROUP BY idcase, activity HAVING COUNT(*) > 1;
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-02';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03'
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03'
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03'
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-03'
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-02';
SELECT DISTINCT activity FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-02' AND activity LIKE '%intervention%';
SELECT * FROM event_log WHERE timestamp BETWEEN '2018-10-01' AND '2018-10-02';
SELECT * FROM event_log WHERE resource LIKE 'M%'
SELECT * FROM event_log WHERE resource LIKE 'M%'
SELECT * FROM event_log WHERE resource LIKE 'M%' ORDER BY resource;
SELECT * FROM event_log WHERE resource LIKE 'M%';
SELECT * FROM event_log WHERE resource LIKE 'M%'
SELECT resource, COUNT(*) AS event_count FROM events_log WHERE resource LIKE 'M%' GROUP BY resource;
SELECT activity FROM event_log WHERE resource LIKE 'M%' AND activity LIKE '%processing of declarations%';
SELECT * FROM event_log WHERE resource LIKE 'M%'
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 5
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT DISTINCT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT DISTINCT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT DISTINCT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 5
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 5
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 5
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT activity FROM event_log GROUP BY activity, idcase HAVING COUNT(*) > 3
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 3
SELECT activity, idcase FROM event_log GROUP BY activity, idcase HAVING count(*) > 3;
SELECT activity, COUNT(*) FROM events_log GROUP BY activity, idcase HAVING COUNT(*) > 3
SELECT activity, COUNT(*) FROM event_log GROUP BY activity HAVING COUNT(*) > 3
SELECT activity, COUNT(*) FROM event_log GROUP BY activity, idcase HAVING COUNT(*) > 3
SELECT activity, COUNT(*) FROM event_log GROUP BY activity, idcase HAVING COUNT(*) > 3
SELECT activity, COUNT(*) FROM event_log GROUP BY activity, idcase HAVING COUNT(*) > 3
SELECT activity, COUNT(*) FROM events_log GROUP BY activity, idcase HAVING COUNT(*) > 3
SELECT activity, COUNT(*) AS count FROM event_log GROUP BY activity HAVING count > 3
SELECT activity, COUNT(*) AS count FROM event_log GROUP BY idcase, activity HAVING COUNT(*) > 3 ORDER BY idcase, count DESC;
SELECT COUNT(*) FROM event_log WHERE idcase = 'declaration 56300'
SELECT SUM(cost) AS total_cost FROM event_log WHERE idcase = 'declaration 143598' AND timestamp BETWEEN '2017-01-10' AND '2017-02-01';
SELECT COUNT(*) FROM event_log WHERE idcase = 'declaration 56300'
SELECT COUNT(*) FROM event_log WHERE idcase = 'declaration 56300'
SELECT count(*) FROM event_log WHERE idcase = 'declaration 56300';
SELECT COUNT(*) FROM event_log WHERE idcase = 'declaration 56300'
SELECT * FROM event_log WHERE idcase = '56300'
SELECT activity, COUNT(*) AS count FROM event_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(*) > 1;
SELECT activity, COUNT(DISTINCT id) AS count_activity FROM event_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(DISTINCT id) > 1;
SELECT activity, COUNT(*) AS count FROM event_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(*) > 1 ORDER BY count DESC;
SELECT activity, COUNT(*) AS count FROM event_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(*) > 1 ORDER BY count DESC;
SELECT activity, COUNT(*) AS count FROM event_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(*) > 1 ORDER BY count DESC;
SELECT activity, COUNT(*) AS count FROM event_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING count > 1 ORDER BY count DESC;
SELECT activity, COUNT(*) AS count FROM event_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(*) > 1 ORDER BY count DESC;
SELECT activity, COUNT(DISTINCT idcase) AS num_cases FROM events_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(DISTINCT idcase) > 1 ORDER BY num_cases DESC;
SELECT activity, COUNT(*) AS count FROM event_log WHERE timestamp < '2017-10-01' GROUP BY activity HAVING COUNT(*) > 1 ORDER BY count DESC;
SELECT activity, COUNT(*) AS count FROM event_log WHERE activity LIKE '%process declaration%' AND timestamp < '2017-10-01' GROUP BY activity ORDER BY count DESC;
SELECT activity, COUNT(*) AS count FROM event_log WHERE timestamp < '2017-01-10' GROUP BY activity HAVING COUNT(*) > 1 ORDER BY count DESC;
SELECT resource,COUNT(*) FROM event_log GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM event_log GROUP BY resource
SELECT resource, COUNT(DISTINCT idcase) from events_log GROUP BY resource
SELECT resource, count(distinct idcase) FROM events_log group by resource
SELECT resource, COUNT(DISTINCT idcase) FROM event_log GROUP BY resource;
SELECT resource, count(distinct idcase) FROM events_log group by resource
SELECT resource,COUNT(*) FROM event_log GROUP BY resource
SELECT resource, count(distinct idcase) FROM events_log group by resource
SELECT COUNT(DISTINCT idcase), resource FROM event_log GROUP BY resource
SELECT resource, count(distinct idcase) FROM event_log group by resource
SELECT resource, COUNT(DISTINCT idcase) AS num_declarations FROM events_log GROUP BY resource ORDER BY num_declarations DESC;
SELECT COUNT(*), resource FROM event_log GROUP BY resource
SELECT COUNT(DISTINCT idcase) AS "Number of Cases", resource FROM events_log GROUP BY resource;
SELECT COUNT(*) AS "Number of Actions" FROM events_log GROUP BY resource;
SELECT COUNT(*) AS "Event Count", resource FROM event_log GROUP BY resource;
SELECT resource, COUNT(*) AS num_occurrences FROM event_log GROUP BY resource;
SELECT resource, COUNT(*) AS activity_count FROM event_log GROUP BY resource
SELECT resource, COUNT(*) AS occurrences FROM event_log WHERE activity = 'acting' GROUP BY resource;
SELECT resource, COUNT(*) AS num_interventions FROM event_log WHERE activity = 'intervention' GROUP BY resource;
SELECT DISTINCT idcase FROM event_log WHERE resource IN ('Thomas', 'Diana', 'Sara');
SELECT DISTINCT idcase FROM events_log WHERE resource IN ('Thomas', 'Diana', 'Sara')
SELECT idcase FROM event_log WHERE resource IN ('Thomas', 'Diana', 'Sara')
SELECT idcase FROM events_log WHERE resource IN ('Thomas', 'Diana', 'Sara')
SELECT DISTINCT idcase FROM events_log WHERE resource IN ('Thomas', 'Diana', 'Sara')
SELECT COUNT(DISTINCT idcase), resource FROM event_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource;
SELECT resource, COUNT(DISTINCT idcase) FROM events_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource;
SELECT resource, count(DISTINCT idcase) FROM event_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource
SELECT resource, count(DISTINCT idcase) FROM event_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource
SELECT resource, count(DISTINCT idcase) FROM event_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM events_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM events_log WHERE timestamp BETWEEN '2017-05-01' AND '2017-06-01' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM event_log WHERE timestamp between '2017-05-01' and '2017-06-01' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM events_log WHERE timestamp between '2017-05-01' and '2017-06-01' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM event_log WHERE timestamp between '2017-05-01' and '2017-06-01' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM event_log WHERE timestamp between '2017-05-01' and '2017-06-01' GROUP BY resource
SELECT COUNT(DISTINCT idcase), resource FROM events_log WHERE timestamp between '2017-05-01' and '2017-06-01' AND activity LIKE '%intervention%' GROUP BY resource
SELECT activity, resource FROM event_log WHERE resource NOT IN ('Joshua', 'Teresa')
SELECT activity, resource FROM event_log WHERE resource NOT IN ('Joshua', 'Teresa')
SELECT activity, resource FROM event_log WHERE resource NOT IN ('Joshua', 'Teresa')
SELECT e.activity, e.resource FROM event_log e JOIN cases c ON e.idcase = c.id WHERE c.id NOT IN ( SELECT idcase FROM cases WHERE resource = 'Joshua' OR resource = 'Teresa' ) AND e.activity LIKE '%intervention%';
SELECT e.activity, e.resource FROM event_log AS e JOIN cases AS c ON e.idcase = c.id WHERE c.id NOT IN ( SELECT idcase FROM event_log WHERE resource IN ('Joshua', 'Teresa') ) AND e.activity LIKE '%interveno%' ORDER BY e.activity;
SELECT DISTINCT idcase FROM events_log WHERE activity IN ('Start trip', 'End trip') EXCEPT SELECT DISTINCT idcase FROM events_log WHERE activity IN ('Request payment', 'Payment handled');
SELECT DISTINCT idcase FROM event_log WHERE activity IN ('Start trip', 'End trip') EXCEPT SELECT DISTINCT idcase FROM event_log WHERE activity IN ('Request payment', 'Payment handled');
SELECT DISTINCT idcase FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log WHERE activity IN ('Start trip', 'End trip') ) AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity IN ('Request payment', 'Payment handled') );
SELECT DISTINCT idcase FROM event_log WHERE (activity = 'Start trip' OR activity = 'Trip end') AND idcase NOT IN ( SELECT idcase FROM event_log WHERE activity = 'Request payment' OR activity = 'Payment handled' );
SELECT DISTINCT idcase FROM event_log WHERE (activity = 'Start trip' OR activity = 'End trip') AND idcase NOT IN ( SELECT idcase FROM event_log WHERE activity = 'Request payment' OR activity = 'Payment handled' );
SELECT DISTINCT idcase FROM events_log WHERE activity IN ('Start activity', 'Complete activity') AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity IN ('Request payment', 'Payment handled') );
SELECT DISTINCT idcase FROM events_log WHERE activity IN ('Start trip', 'End trip') EXCEPT SELECT DISTINCT idcase FROM events_log WHERE activity IN ('Request Payment', 'Payment handled');
SELECT DISTINCT idcase FROM events_log WHERE activity IN ('Start trip', 'End trip') EXCEPT SELECT DISTINCT idcase FROM events_log WHERE activity IN ('Request Payment', 'Payment handled');
SELECT DISTINCT idcase FROM events_log WHERE activity IN ('Start trip', 'End trip') EXCEPT SELECT DISTINCT idcase FROM events_log WHERE activity IN ('Request Payment', 'Payment handled');
SELECT DISTINCT idcase FROM events_log WHERE activity IN ('Start trip', 'End trip') EXCEPT SELECT DISTINCT idcase FROM events_log WHERE activity IN ('Request Payment', 'Payment handled');
SELECT * FROM event_log WHERE resource IS NULL;
SELECT resource, COUNT(*) AS event_count FROM events_log GROUP BY resource;
SELECT activity FROM event_log WHERE resource IS NULL;
SELECT activity, resource FROM events_log WHERE resource NOT IN ('Joshua', 'Teresa');
SELECT * FROM event_log WHERE resource IS NULL;
SELECT activity FROM event_log WHERE resource IS NULL;
SELECT * FROM event_log WHERE resource IS NULL;
SELECT resource, COUNT(*) AS interventions_without_cost FROM events_log WHERE cost IS NULL GROUP BY resource;
SELECT idcase FROM event_log GROUP BY idcase HAVING MIN(timestamp) < '2017-03-01'
SELECT idcase FROM events_log GROUP BY idcase HAVING strftime('%Y-%m', MIN(timestamp)) < '2017-03'
SELECT idcase FROM event_log WHERE activity = 'first performance' AND timestamp < '2017-03-01'
SELECT idcase FROM event_log WHERE activity = 'Start trip' AND timestamp < '2017-03-01';
SELECT idcase FROM event_log WHERE timestamp < '2017-03-01' GROUP BY idcase
SELECT idcase FROM event_log WHERE activity = 'Start trip' INTERSECT SELECT idcase FROM event_log GROUP BY idcase HAVING MIN(timestamp) < '2017-03-31';
SELECT DISTINCT resource FROM event_log WHERE activity = 'process_declaration' AND timestamp < '2017-03-01';
SELECT DISTINCT(idcase) FROM (SELECT idcase, strftime('%Y-%m-%d', timestamp) as event_date, COUNT(*) as event_count FROM events_log GROUP BY idcase, event_date HAVING event_count > 1)
SELECT DISTINCT(idcase) FROM event_log WHERE activity = 'intervention' AND timestamp < '2017-03-01'
SELECT "idcase" FROM "event_log" WHERE "activity" = 'Processing' AND "timestamp" < '2017-03-01'
SELECT idcase FROM events_log WHERE activity = 'Start trip' AND timestamp BETWEEN '2017-03-01' AND '2017-03-31';
SELECT el.id, el.activity, el.timestamp, el.resource, el.cost, el.idcase FROM event_log AS el WHERE el.activity = 'Start trip' AND el.timestamp BETWEEN '2017-03-01' AND '2017-03-31' ORDER BY el.timestamp ASC;
SELECT idcase FROM events_log WHERE activity = 'Start trip' AND timestamp BETWEEN '2017-03-01' AND '2017-03-31';
SELECT idcase FROM event_log WHERE activity = 'Start trip' AND timestamp >= '2017-03-01' AND timestamp <= '2017-03-31' AND id IN ( SELECT MIN(id) FROM event_log WHERE activity = 'Start trip' GROUP BY idcase )
SELECT DISTINCT idcase FROM event_log WHERE activity = 'Start trip' AND timestamp BETWEEN '2017-03-01' AND '2017-03-31' AND idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING MIN(activity) = 'Start trip' );
SELECT DISTINCT idcase FROM event_log WHERE activity = 'Start trip' AND timestamp BETWEEN '2017-03-01' AND '2017-03-31'
SELECT idcase FROM events_log GROUP BY idcase HAVING min(timestamp) >= '2017-03-01'
SELECT resource, COUNT(*) AS num_occurrences FROM events_log GROUP BY resource HAVING num_occurrences > 5;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY idcase, resource HAVING COUNT(*) > 5;
SELECT resource, COUNT(*) AS num_actions FROM event_log GROUP BY idcase, resource HAVING COUNT(*) > 5 ORDER BY num_actions DESC;
SELECT resource, COUNT(*) AS num_actions FROM event_log GROUP BY resource HAVING COUNT(*) > 5 ORDER BY num_actions DESC;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource HAVING COUNT(*) > 5;
SELECT resource, COUNT(*) AS num_events FROM event_log GROUP BY resource, idcase HAVING COUNT(*) > 5 ORDER BY num_events DESC;
SELECT resource, idcase, COUNT(*) AS num_allocations FROM event_log GROUP BY resource, idcase HAVING COUNT(*) > 5 ORDER BY num_allocations DESC;
SELECT resource, COUNT(*) AS count FROM event_log WHERE activity = 'declaration' GROUP BY resource HAVING COUNT(*) > 5 ORDER BY count DESC;
SELECT resource, COUNT(*) FROM events_log GROUP BY resource HAVING COUNT(*) > 5
SELECT resource, COUNT(DISTINCT idcase) AS num_declarations FROM events_log GROUP BY resource HAVING num_declarations > 5;
SELECT resource, COUNT(*) AS num_actions FROM event_log WHERE activity = 'declarations' GROUP BY resource HAVING num_actions > 5;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) = ( SELECT COUNT(*) FROM event_log GROUP BY activity ORDER BY COUNT(*) DESC LIMIT 1 )
SELECT activity, COUNT(*) AS count FROM event_log GROUP BY activity ORDER BY count DESC LIMIT 10;
SELECT activity, COUNT(*) AS count FROM event_log GROUP BY activity ORDER BY count DESC LIMIT 1;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) = (SELECT COUNT(*) FROM event_log GROUP BY activity ORDER BY COUNT(*) DESC LIMIT 1)
SELECT activity, COUNT(*) AS count FROM events_log GROUP BY activity ORDER BY count DESC LIMIT 10;
SELECT resource, COUNT(*) AS count FROM event_log WHERE activity = 'Declaration final approved by supervisor' GROUP BY resource ORDER BY count DESC LIMIT 10;
SELECT resource, COUNT(*) AS count FROM event_log WHERE activity = 'Declaration final approved by supervisor' GROUP BY resource ORDER BY count DESC LIMIT 10;
SELECT resource FROM event_log WHERE activity = 'Declaration final approved by supervisor' GROUP BY resource ORDER BY COUNT(*) DESC LIMIT 10;
SELECT resource, COUNT(*) AS count FROM event_log WHERE activity = 'Declaration final approved by supervisor' GROUP BY resource ORDER BY count DESC;
SELECT resource, COUNT(*) AS count FROM event_log WHERE activity = 'Declaration approved by supervisor' GROUP BY resource ORDER BY count DESC LIMIT 10;
SELECT resource, COUNT(*) AS count FROM event_log WHERE activity = 'Declaration approved by supervisor' GROUP BY resource ORDER BY count DESC LIMIT 10;
SELECT resource, COUNT(*) AS num_occurrences FROM events_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource ORDER BY num_occurrences DESC;
SELECT resource FROM event_log WHERE activity = 'Declaration approved by supervisor' GROUP BY resource HAVING COUNT(*) IN ( SELECT COUNT(*) FROM event_log WHERE activity = 'Declaration approved by supervisor' GROUP BY resource ORDER BY COUNT(*) DESC LIMIT 10 ) ORDER BY COUNT(*) DESC;
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Declaration approved by budget owner' AND resource IN ('Eugene', 'Marie')
SELECT COUNT(DISTINCT(idcase)) FROM event_log WHERE activity LIKE '%declaration approved by budget owner%' AND resource IN ('Eugene', 'Marie');
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Declaration approved by budget owner' AND resource IN ('Eugene', 'Marie');
SELECT count(*) FROM events_log WHERE activity = 'Declaration approved by budget owner' AND resource IN ('Eugene', 'Marie');
SELECT COUNT(*) FROM event_log WHERE activity = 'Declaration approved by budget owner' AND resource IN ('Eugene', 'Marie');
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Declaration approved by budget owner' AND resource IN ('Eugine', 'Marie');
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Declaration approved by budget owner' AND resource IN ('Eugine', 'Marie');
SELECT COUNT(DISTINCT(idcase)) AS "Number of Declarations Approved" FROM event_log WHERE activity LIKE '%approved%' AND resource IN ('Eugene', 'Marie') AND activity LIKE '%budget holder%';
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Declaration approved' AND resource IN ('Eugene', 'Marie');
SELECT activity FROM event_log WHERE idcase = 'declaration 49464' EXCEPT SELECT activity FROM event_log WHERE idcase = 'declaration 76667';
SELECT DISTINCT activity FROM event_log WHERE idcase = 'declaration 49464' EXCEPT SELECT DISTINCT activity FROM event_log WHERE idcase = 'declaration 76667';
SELECT DISTINCT activity FROM event_log WHERE idcase = 'declaration 49464' EXCEPT SELECT DISTINCT activity FROM event_log WHERE idcase = 'declaration 76667';
SELECT * FROM event_log WHERE id = 49464 EXCEPT SELECT * FROM event_log WHERE id = 76667;
SELECT resource, count(*) AS num_declarations FROM events_log WHERE activity = 'Declaration submitted by employee' GROUP BY resource HAVING num_declarations > 2 ORDER BY num_declarations DESC;
SELECT resource, COUNT(*) AS performance_count FROM event_log WHERE activity = 'Declaration submitted by employee' GROUP BY resource HAVING performance_count > 2 ORDER BY performance_count DESC;
SELECT resource, COUNT(*) AS performance_count FROM event_log WHERE activity = 'Declaration submitted by employee' GROUP BY resource HAVING performance_count > 2 ORDER BY performance_count DESC;
SELECT resource, COUNT(*) AS count FROM event_log WHERE activity = 'Declaration submitted by employee' GROUP BY resource HAVING COUNT(*) > 2 ORDER BY count DESC;
SELECT resource, COUNT(*) AS count FROM event_log WHERE activity = 'Declaration submitted by employee' GROUP BY resource HAVING COUNT(*) > 2 ORDER BY count DESC;
SELECT resource, COUNT(*) AS event_count FROM event_log WHERE activity = 'Declaration submitted by employee' GROUP BY resource HAVING event_count > 2 ORDER BY event_count DESC;
SELECT resource, COUNT(DISTINCT idcase) AS num_declarations FROM events_log WHERE activity = 'Requested Declaration' GROUP BY resource HAVING num_declarations > 2 ORDER BY num_declarations DESC;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Request payment' AND timestamp BETWEEN '2017-05-01' AND '2017-05-10';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Request payment' AND timestamp BETWEEN '2017-05-01' AND '2017-05-10'
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Request payment' AND timestamp BETWEEN '2017-05-01' AND '2017-05-10'
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Request payment' AND timestamp BETWEEN '2017-05-01' AND '2017-05-10';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Request payment' AND timestamp BETWEEN '2017-05-01' AND '2017-05-10';
SELECT idcase FROM event_log WHERE activity = 'Request payment' AND timestamp BETWEEN '2017-05-01' AND '2017-05-10';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Request payment' AND timestamp BETWEEN '2017-05-01' AND '2017-05-10';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Request payment' AND timestamp BETWEEN '2017-05-01' AND '2017-05-10'
SELECT COUNT(DISTINCT resource), idcase FROM events_log GROUP BY idcase
SELECT idcase, COUNT(DISTINCT resource) FROM event_log GROUP BY idcase
SELECT COUNT(DISTINCT resource) FROM events_log GROUP BY idcase
SELECT idcase, COUNT(DISTINCT resource) from events_log GROUP BY idcase
SELECT COUNT(DISTINCT resource) AS num_resources, idcase FROM event_log GROUP BY idcase;
SELECT COUNT(DISTINCT resource) AS num_resources, idcase FROM events_log GROUP BY idcase
SELECT COUNT(DISTINCT resource) FROM events_log GROUP BY idcase
SELECT COUNT(DISTINCT resource) FROM events_log GROUP BY idcase;
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Christopher' AND NOT EXISTS ( SELECT 1 FROM events_log WHERE idcase = events_log.idcase AND resource <> 'Christopher' );
SELECT DISTINCT idcase FROM events_log where resource = 'Christopher' AND activity = 'Closed'
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1 AND resource = 'Christopher';
SELECT idcase FROM events_log WHERE resource = 'Christopher' AND activity IN ( SELECT activity FROM events_log WHERE idcase = events_log.idcase )
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Christopher' AND NOT EXISTS( SELECT 1 FROM events_log WHERE idcase = events_log.idcase AND resource <> 'Christopher' );
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1 AND resource = 'Christopher';
SELECT idcase FROM event_log WHERE resource = 'Christopher' GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase, resource FROM events_log WHERE resource = 'Christopher' GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT idcase, resource FROM event_log GROUP BY idcase, resource HAVING COUNT(DISTINCT id) > 1;
SELECT resource FROM ( SELECT resource, COUNT(*) AS num_declarations FROM event_log WHERE activity = 'declaration' GROUP BY resource ) WHERE num_declarations = 1;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) > 1 AND DATE(timestamp) = DATE('now', '-1 day');
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) > 1 AND DATE(timestamp) = DATE('now', '-1 day')
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT DATE(timestamp)) > 1;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT DATE(timestamp)) > 1;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) > 1
SELECT DISTINCT(idcase) FROM ( SELECT idcase, activity, DATE(timestamp) AS date, COUNT(*) OVER (PARTITION BY idcase, date) AS count_per_day FROM events_log ) WHERE count_per_day > 1;
SELECT DISTINCT(idcase) FROM ( SELECT idcase, activity, DATE(timestamp) AS date, COUNT(*) OVER (PARTITION BY idcase, date) AS count_per_day FROM events_log ) WHERE count_per_day > 1;
SELECT resource, idcase, COUNT(*) AS zero_cost_events FROM event_log WHERE cost = 0 GROUP BY resource, idcase;
SELECT idcase, resource, COUNT(*) AS zero_cost_events FROM events_log WHERE cost = 0 GROUP BY idcase, resource;
SELECT idcase, resource, COUNT(*) AS zero_cost_events FROM event_log WHERE cost = 0 GROUP BY idcase, resource;
SELECT idcase, resource, COUNT(*) AS num_zero_cost_events FROM event_log WHERE cost = 0 GROUP BY idcase, resource;
SELECT resource, idcase, COUNT(*) AS zero_cost_events FROM event_log WHERE cost = 0 GROUP BY resource, idcase
SELECT resource, idcase, COUNT(*) AS zero_cost_events FROM event_log WHERE cost = 0 GROUP BY resource, idcase HAVING COUNT(*) > 2;
SELECT resource, COUNT(*) AS interventions_without_cost FROM event_log WHERE activity = 'Processing of declarations' AND cost IS NULL GROUP BY resource;
SELECT resource, COUNT(*) AS interventions_without_cost FROM event_log WHERE activity = 'Processing Declaration' AND cost IS NULL GROUP BY resource;
SELECT * FROM event_log WHERE activity = 'Permit rejected by director';
SELECT * FROM event_log WHERE activity = 'Permit rejected by director'
SELECT id, activity, timestamp FROM event_log WHERE activity = 'Permit rejected by director'
SELECT * FROM events_log WHERE activity = 'Permit rejected by the director'
SELECT * FROM event_log WHERE activity LIKE '%Permit rejected by director%'
SELECT * FROM event_log WHERE activity = 'Permit rejected by director';
SELECT * FROM events_log WHERE activity LIKE '%Permit%' AND resource LIKE '%Declaration%' AND cost < 0;
SELECT activity FROM event_log WHERE activity LIKE '%Director rejected a permit%'
SELECT DATE(timestamp) AS event_date, SUM(cost) AS total_cost FROM event_log WHERE activity = 'COMPLETED' GROUP BY event_date ORDER BY event_date;
SELECT DATE(timestamp) AS event_date, SUM(cost) AS total_cost FROM event_log GROUP BY event_date ORDER BY event_date;
SELECT DATE(timestamp) AS event_date, SUM(cost) AS total_cost FROM event_log WHERE cost IS NOT NULL GROUP BY event_date ORDER BY event_date;
SELECT DATE(timestamp) AS event_date, SUM(cost) AS total_cost FROM event_log WHERE cost IS NOT NULL GROUP BY event_date ORDER BY event_date;
SELECT DATE(timestamp) AS day, SUM(cost) AS total_cost FROM event_log GROUP BY day
SELECT DATE(timestamp) AS event_date, SUM(cost) AS total_cost FROM event_log GROUP BY event_date ORDER BY event_date;
SELECT strftime('%Y-%m-%d', timestamp) AS event_date, SUM(cost) AS total_cost FROM event_log GROUP BY event_date ORDER BY event_date;
SELECT DATE(timestamp) AS date, SUM(cost) AS total_cost FROM event_log WHERE activity LIKE '%declaration%' GROUP BY date;
SELECT id, activity, resource, cost FROM events_log WHERE cost > 1000 AND resource IN ( SELECT resource FROM events_log WHERE activity LIKE '%supervisor%' OR activity LIKE '%director%' );
SELECT AVG(cost) AS average_cost, activity FROM events_log WHERE activity IN ( SELECT activity FROM events_log WHERE resource LIKE '%supervisor%' OR resource LIKE '%director%' ) GROUP BY activity HAVING average_cost > 1000;
SELECT id, activity, resource, cost FROM events_log WHERE cost BETWEEN 50 AND 400;
SELECT activity FROM event_log WHERE (activity LIKE '%supervisor%' OR activity LIKE '%diretor%') AND cost > 1000;
SELECT DISTINCT idcase FROM events_log WHERE cost > 1000 AND ( activity LIKE '%supervisor%' OR activity LIKE '%director%' );
SELECT AVG(cost) AS average_cost, activity FROM events_log WHERE activity IN ( SELECT activity FROM events_log WHERE resource LIKE '%supervisor%' OR resource LIKE '%director%' ) GROUP BY activity HAVING average_cost > 1000;
SELECT events_count, COUNT(*) AS case_count FROM ( SELECT COUNT(*) AS events_count, idcase FROM event_log GROUP BY idcase ) GROUP BY events_count;
SELECT COUNT(*) AS "Number of Events", idcase FROM event_log GROUP BY idcase;
SELECT COUNT(*) AS "Number of Events", idcase FROM event_log GROUP BY idcase;
SELECT events_count, COUNT(*) AS case_count FROM ( SELECT COUNT(*) AS events_count, idcase FROM event_log GROUP BY idcase ) GROUP BY events_count;
SELECT COUNT(*) AS "Number of Events", idcase FROM event_log GROUP BY idcase;
SELECT COUNT(*) AS "Number of Events", idcase AS "Process Instance ID" FROM event_log GROUP BY idcase;
SELECT e.idcase, COUNT(*) FROM events_log e GROUP BY e.idcase
SELECT COUNT(*) AS "Number of Tasks", resource FROM event_log GROUP BY resource;
SELECT COUNT(DISTINCT activity) AS "Number of Activities", resource FROM events_log GROUP BY resource;
SELECT COUNT(*) AS "Number of Activities", resource FROM event_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) AS num_activities FROM event_log GROUP BY resource;
SELECT resource, COUNT(DISTINCT activity) AS num_activities FROM events_log GROUP BY resource;
SELECT resource, COUNT(*) AS num_tasks FROM event_log GROUP BY resource;
SELECT COUNT(*) AS "Number of Actions", resource AS "Employee" FROM events_log GROUP BY resource;
SELECT idcase, COUNT(DISTINCT activity) AS num_activities FROM event_log WHERE resource = 'Alexis' GROUP BY idcase
SELECT idcase, COUNT(*) AS activity_count FROM event_log WHERE resource = 'Alexis' GROUP BY idcase
SELECT idcase, COUNT(*) AS num_activities FROM event_log WHERE resource = 'Alexis' GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT activity) AS num_activities FROM event_log WHERE resource = 'Alexis' GROUP BY idcase
SELECT idcase, COUNT(DISTINCT activity) AS num_activities FROM event_log WHERE resource = 'Alexis' GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT activity) AS num_activities FROM event_log WHERE resource = 'Alexis' GROUP BY idcase
SELECT idcase, activity, resource FROM event_log WHERE resource = 'Alexis'
SELECT DISTINCT idcase, COUNT(*) AS num_actions FROM events_log WHERE resource = 'Alexis' GROUP BY idcase;
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Permit final approved by supervisor' AND idcase IN ( SELECT idcase FROM event_log WHERE activity = 'Start trip' );
SELECT COUNT(*) FROM event_log AS el1 JOIN event_log AS el2 ON el1.idcase = el2.idcase WHERE el1.activity = 'Permit final approved by supervisor' AND el2.activity = 'Start trip' AND el1.timestamp < el2.timestamp;
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Start trip' AND idcase IN ( SELECT idcase FROM event_log WHERE activity = 'Permit final approved by supervisor' );
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Permit final approved by supervisor' AND idcase IN ( SELECT idcase FROM event_log WHERE activity = 'Start trip' )
SELECT count(*) FROM events_log WHERE activity = 'Start trip' AND idcase IN ( SELECT idcase FROM events_log WHERE activity = 'Permit final approved by supervisor' )
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'Start of trip' AND timestamp > ( SELECT MAX(timestamp) FROM events_log WHERE activity = 'Permit with final approval from supervisor' AND idcase = events_log.idcase );
SELECT COUNT(*) FROM event_log AS el JOIN event_log AS el2 ON el.idcase = el2.idcase WHERE el.activity LIKE '%Permit%' AND el2.activity LIKE '%Trip%' AND el.timestamp < el2.timestamp;
SELECT COUNT(*) FROM event_log AS e1 INNER JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'Start trip' AND e1.timestamp < e2.timestamp AND e1.activity = 'Declaration allowed' AND e1.resource = 'Supervisor';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'End trip' AND timestamp NOT BETWEEN '2017-12-12 00:00:00' AND '2017-12-12 23:59:59';
SELECT * FROM event_log WHERE activity = 'End trip' AND timestamp < '2017-12-12' UNION SELECT * FROM event_log WHERE activity = 'End trip' AND timestamp > '2017-12-12';
SELECT * FROM event_log WHERE activity = 'End trip' AND timestamp BETWEEN '2016-01-01' AND '2017-12-31'
SELECT * FROM event_log WHERE activity = 'End trip' AND (timestamp < '2017-12-12' OR timestamp > '2017-12-12')
SELECT DISTINCT idcase FROM events_log WHERE activity = 'End trip' AND timestamp NOT BETWEEN '2017-12-12 00:00:00' AND '2017-12-12 23:59:59';
SELECT DISTINCT idcase FROM events_log WHERE activity = 'End trip' AND timestamp NOT BETWEEN '2017-12-12 00:00:00' AND '2017-12-12 23:59:59';
SELECT COUNT(*) FROM event_log WHERE activity = 'End trip' AND DATE(timestamp) = '2017-12-12'
SELECT COUNT(*), resource FROM event_log GROUP BY resource
SELECT COUNT(*) AS "Number of Events", resource FROM events_log GROUP BY resource;
SELECT COUNT(*), resource FROM event_log GROUP BY resource;
SELECT resource, COUNT(*) AS activity_count FROM events_log GROUP BY resource ORDER BY activity_count DESC;
SELECT resource, COUNT(*) AS event_count FROM events_log GROUP BY resource ORDER BY event_count DESC;
SELECT resource, COUNT(*) AS count FROM events_log WHERE activity = 'Declaration' GROUP BY resource ORDER BY count DESC;
SELECT COUNT(*) AS "Number of Actions", "Responsible Person" FROM event_log GROUP BY "Responsible Person" ORDER BY "Number of Actions" DESC;
SELECT resource, GROUP_CONCAT(DISTINCT activity) AS activities FROM event_log GROUP BY resource;
SELECT COUNT(DISTINCT activity) AS num_activities, resource FROM event_log GROUP BY resource;
SELECT COUNT(DISTINCT activity) AS num_activities, resource FROM event_log GROUP BY resource;
SELECT resource, COUNT(*) AS activity_count FROM event_log GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(DISTINCT activity) AS num_activities FROM event_log GROUP BY resource;
SELECT DISTINCT activity, resource FROM events_log ORDER BY resource, activity;
SELECT activity FROM event_log WHERE resource = 'Virginia' EXCEPT SELECT activity FROM event_log WHERE resource <> 'Virginia';
SELECT activity FROM event_log WHERE resource = 'Virginia' AND activity NOT IN (SELECT activity FROM event_log WHERE resource = 'Virginia' AND activity LIKE '%done%')
SELECT activity FROM event_log WHERE activity NOT IN ( SELECT activity FROM event_log WHERE resource = 'Virginia' )
SELECT activity FROM event_log WHERE activity NOT IN ( SELECT activity FROM event_log WHERE resource = 'Virginia' )
SELECT activity FROM event_log WHERE idcase = 'declaration 49464' EXCEPT SELECT activity FROM event_log WHERE idcase = 'declaration 76667';
SELECT DISTINCT activity FROM event_log WHERE resource = 'Virginia' EXCEPT SELECT DISTINCT activity FROM event_log;
SELECT AVG(cost) FROM event_log WHERE activity = 'rejected';
SELECT idcase, AVG(cost) FROM event_log WHERE activity = 'rejected' GROUP BY idcase;
SELECT AVG(total_cost) FROM ( SELECT SUM(cost) AS total_cost, idcase FROM event_log WHERE activity = 'rejected' GROUP BY idcase ) AS rejected_cases;
SELECT AVG(cost) FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log WHERE activity LIKE '%rejected%' );
SELECT AVG(cost) FROM events_log WHERE idcase IN (SELECT idcase FROM events_log WHERE activity = 'Rejected')
SELECT AVG(cost) FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log WHERE activity = 'Travel Declaration' AND resource = 'Rejected' );
SELECT AVG(cost) FROM event_log WHERE activity = 'travel_declaration' AND resource = 'rejection';
SELECT idcase, ( JULIANDAY(MAX(timestamp)) - JULIANDAY(MIN(timestamp)) ) * 24 * 60 * 60 AS duration_in_seconds FROM events_log WHERE activity = 'Payment handled' GROUP BY idcase;
SELECT idcase, MAX(timestamp) - MIN(timestamp) AS duration FROM events_log WHERE activity = 'Payment handled' GROUP BY idcase;
SELECT idcase, MAX(timestamp) - MIN(timestamp) AS duration FROM events_log WHERE activity = 'Payment handled' GROUP BY idcase;
SELECT idcase, activity, timestamp, resource, cost, ( JULIANDAY(timestamp) - JULIANDAY( LAG(timestamp) OVER (PARTITION BY idcase ORDER BY timestamp) ) ) AS duration FROM event_log WHERE activity = 'Payment handled';
SELECT idcase, activity, timestamp, resource, cost, ( SELECT timestamp FROM event_log WHERE idcase = e.idcase AND activity = 'Payment handled' ORDER BY timestamp DESC LIMIT 1 ) - timestamp AS duration FROM event_log AS e WHERE activity = 'Request payment';
SELECT AVG(cost) AS average_cost, activity FROM event_log WHERE activity LIKE '%payment%' GROUP BY activity;
SELECT idcase, ( STRFTIME('%s', MAX(timestamp)) - STRFTIME('%s', MIN(timestamp)) ) AS wait_time FROM events_log WHERE activity = 'End trip' GROUP BY idcase ORDER BY wait_time DESC;
SELECT COUNT (*) FROM event_log WHERE activity = 'Declaration rejected by pre-approver'
SELECT count(*) FROM events_log WHERE activity = 'Declaration rejected by pre-approver'
SELECT count(*) FROM events_log WHERE activity = 'Declaration rejected by pre-approver'
SELECT count(*) FROM events_log where activity = 'Declaration rejected by pre-approver'
SELECT count(*) FROM events_log where activity = 'Declaration rejected by pre-approver'
SELECT count(*) FROM events_log where activity = 'Declaration rejected by pre-approver'
SELECT COUNT(*) FROM events_log WHERE activity = 'Declaration rejected at pre-approval stage'
SELECT count(*) FROM event_log WHERE activity = 'Declaration rejected by pre-approver'
SELECT e1.idcase, e1.timestamp FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' ORDER BY e1.resource;
SELECT idcase, timestamp FROM event_log WHERE activity = 'End trip' ORDER BY resource;
SELECT e1.idcase, e1.resource, e1.timestamp FROM event_log AS e1 INNER JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' ORDER BY e1.resource, e1.timestamp;
SELECT DISTINCT idcase, timestamp, resource FROM events_log WHERE activity = 'End trip' AND timestamp BETWEEN '2016-01-01' AND '2018-01-01' ORDER BY resource;
SELECT e2.resource AS employee_responsible, e1.timestamp AS end_trip_registration_date FROM events_log AS e1 JOIN events_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' ORDER BY e2.resource;
SELECT e1.idcase, e2.timestamp AS end_trip_date, e1.resource AS employee_name FROM events_log AS e1 JOIN events_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' ORDER BY e1.resource;
SELECT COUNT(*) AS "Number of Events", idcase FROM event_log GROUP BY idcase;
SELECT COUNT(*) AS "Number of Events", idcase AS "Process Instance ID" FROM event_log GROUP BY idcase;
SELECT COUNT(*) AS "Number of Events", idcase FROM event_log GROUP BY idcase;
SELECT COUNT(*) AS "Number of Events", idcase AS "Process Instance ID" FROM event_log GROUP BY idcase;
SELECT idcase, COUNT(*) AS event_count FROM event_log GROUP BY idcase ORDER BY event_count DESC;
SELECT COUNT(*) AS "Number of Events", idcase FROM event_log GROUP BY idcase;
SELECT idcase, COUNT(*) AS num_actions FROM events_log GROUP BY idcase HAVING COUNT(*) >= 10;
SELECT idcase, COUNT(*) AS num_interventions FROM events_log WHERE activity LIKE '%intervention%' GROUP BY idcase ORDER BY num_interventions DESC;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'End trip' AND timestamp BETWEEN '2017-02-05' AND '2017-12-05';
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'End trip' AND timestamp BETWEEN '2017-02-05' AND '2017-12-05';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'End trip' AND timestamp BETWEEN '2017-05-02' AND '2017-05-12';
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'End trip' AND timestamp BETWEEN '2017-05-02' AND '2017-05-12';
SELECT count(*) FROM events_log WHERE activity = 'End trip' AND timestamp BETWEEN '2017-02-05' AND '2017-12-05';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'End trip' AND timestamp BETWEEN '2017-02-05' AND '2017-12-05';
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'End trip' AND timestamp BETWEEN '2017-02-05' AND '2017-12-05';
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'End trip' AND timestamp BETWEEN '2017-02-05' AND '2017-12-05';
SELECT idcase, resource, id, MAX(timestamp) AS completion_date FROM event_log WHERE activity = 'Send reminder' GROUP BY idcase, resource, id ORDER BY completion_date;
SELECT idcase, resource, id, timestamp FROM event_log WHERE activity = 'Send reminder' ORDER BY timestamp;
SELECT el1.idcase, el1.activity AS preceding_activity, el1.timestamp AS preceding_activity_timestamp, el2.activity AS subsequent_activity, el2.timestamp AS subsequent_activity_timestamp FROM event_log el1 JOIN event_log el2 ON el1.idcase = el2.idcase WHERE el1.activity = 'Payment handled' AND el2.activity = 'Send reminder' ORDER BY el1.timestamp;
SELECT el.idcase, el.resource, el.activity, el.timestamp AS completion_date FROM event_log AS el WHERE el.activity = 'Send reminder' ORDER BY el.timestamp;
SELECT idcase, id, resource, timestamp FROM event_log WHERE activity = 'Send reminder' ORDER BY timestamp;
SELECT idcase, resource, id, timestamp FROM event_log WHERE activity = 'Send reminder' ORDER BY timestamp;
SELECT e1.idcase, e1.resource, e1.timestamp AS completion_date, e2.activity AS reminder_activity FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e1.activity = 'Declaration submitted' AND e2.activity = 'Reminder sent' ORDER BY e1.timestamp;
SELECT DISTINCT resource FROM events_log ORDER BY resource ASC;
SELECT DISTINCT resource FROM events_log ORDER BY resource ASC
SELECT DISTINCT resource FROM event_log ORDER BY resource ASC;
SELECT DISTINCT resource FROM events_log ORDER BY resource;
SELECT DISTINCT resource FROM events_log ORDER BY resource ASC;
SELECT resource FROM events_log GROUP BY resource ORDER BY resource ASC
SELECT resource FROM events_log WHERE activity LIKE '%declaration%' GROUP BY resource ORDER BY resource;
SELECT resource FROM events_log GROUP BY resource HAVING COUNT(DISTINCT idcase) > 200;
SELECT resource FROM events_log GROUP BY resource HAVING COUNT(DISTINCT idcase) > 200
SELECT resource FROM event_log WHERE idcase IN (SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) > 200)
SELECT resource FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) > 200 ) GROUP BY resource
SELECT resource FROM events_log GROUP BY resource HAVING COUNT(*) > 200
SELECT resource FROM events_log GROUP BY resource HAVING COUNT(*) > 200
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 200;
SELECT COUNT(DISTINCT resource) FROM event_log
SELECT COUNT(DISTINCT resource) FROM event_log;
SELECT COUNT(DISTINCT resource) FROM events_log WHERE activity = 'Processing Declarations';
SELECT COUNT(DISTINCT resource) FROM events_log WHERE activity LIKE '%declaration%';
SELECT COUNT(DISTINCT resource) FROM event_log WHERE activity = 'activity_name'
SELECT COUNT(DISTINCT resource) FROM event_log
SELECT COUNT(DISTINCT resource) FROM event_log WHERE activity LIKE '%declaration%'
SELECT COUNT(DISTINCT resource) FROM events_log WHERE activity = 'Processing Declaration';
SELECT COUNT(DISTINCT(resource)) FROM events_log WHERE activity LIKE '%declaration%'
SELECT DISTINCT activity FROM event_log WHERE activity LIKE '%declaration%'
SELECT DISTINCT activity FROM event_log WHERE activity LIKE '%declaration%'
SELECT DISTINCT activity FROM event_log WHERE activity LIKE '%declaration%'
SELECT DISTINCT activity FROM event_log WHERE activity LIKE '%declaration%'
SELECT DISTINCT activity FROM event_log WHERE activity LIKE '%declaration%'
SELECT activity, timestamp, id FROM events_log WHERE activity LIKE '%declaration%' ORDER BY timestamp;
SELECT DISTINCT activity FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) >= 10 ) AND activity LIKE '%declaration%';
SELECT * FROM events_log WHERE activity LIKE '%declaration%'
SELECT activity, AVG(cost) AS mean_cost FROM event_log GROUP BY activity;
SELECT activity, AVG(cost) AS average_cost FROM event_log GROUP BY activity;
SELECT AVG(cost) AS average_cost FROM event_log GROUP BY activity;
SELECT activity, AVG(cost) AS mean_cost FROM event_log GROUP BY activity;
SELECT activity, AVG(cost) AS mean_cost FROM event_log GROUP BY activity;
SELECT activity, AVG(cost) AS average_cost FROM event_log GROUP BY activity;
SELECT activity, AVG(cost) AS average_cost FROM event_log GROUP BY activity;
SELECT activity, AVG(cost) AS mean_cost FROM event_log GROUP BY activity;
SELECT activity, AVG(cost) AS mean_cost FROM event_log GROUP BY activity;
SELECT COUNT(*) FROM event_log WHERE cost IS NULL
SELECT COUNT(*) FROM event_log WHERE cost IS NULL
SELECT COUNT(*) FROM event_log WHERE cost IS NULL
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE cost IS NULL
SELECT COUNT(*) FROM event_log WHERE cost IS NULL
SELECT COUNT(*) AS "num_cases" FROM ( SELECT "idcase", MIN("cost") AS "min_cost", MAX("cost") AS "max_cost" FROM "event_log" GROUP BY "idcase" ) AS "subquery" WHERE "min_cost" = 0 AND "max_cost" = 0;
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE cost IS NULL;
SELECT COUNT(*) FROM events_log WHERE cost = 0
SELECT COUNT(*) FROM events_log WHERE cost = 0
SELECT activity FROM event_log WHERE activity LIKE '%permit%' OR activity LIKE '%declaration%'
SELECT activity FROM event_log WHERE activity LIKE '%Permit%' OR activity LIKE '%Declaration%' GROUP BY activity
SELECT activity FROM event_log WHERE activity LIKE '%permit%' OR activity LIKE '%declaration%'
SELECT * FROM events_log WHERE activity LIKE '%Permit%' OR activity LIKE '%Declare%';
SELECT DISTINCT activity FROM event_log WHERE activity LIKE '%permit%' OR activity LIKE '%declaration%'
SELECT activity FROM event_log WHERE activity LIKE '%permit%' OR activity LIKE '%declaration%'
SELECT activity FROM event_log WHERE activity LIKE '%permit%' OR activity LIKE '%declaration%'
SELECT DISTINCT activity FROM event_log WHERE activity LIKE '%permit%' OR activity LIKE '%declaration%';
SELECT event_log.activity FROM event_log JOIN declarations ON event_log.idcase = declarations.idcase WHERE event_log.activity LIKE '%Permit%' AND declarations.explicit = 1;
SELECT count(*) FROM event_log WHERE activity = 'Declaration rejected by director'
SELECT COUNT(*) FROM event_log WHERE activity = 'Declaration rejected by director'
SELECT COUNT(*) FROM event_log WHERE activity = 'Declaration rejected by director';
SELECT count(*) FROM event_log WHERE activity = 'Declaration rejected by director'
SELECT count(*) FROM event_log WHERE activity = 'Declaration rejected by director'
SELECT count(*) FROM event_log WHERE activity = 'Declaration rejected by director'
SELECT count(*) FROM events_log WHERE activity = 'Declaration rejected by director'
SELECT AVG(cost) FROM event_log
SELECT AVG(cost) FROM event_log
SELECT AVG(cost) FROM event_log
SELECT AVG(cost) FROM event_log
SELECT AVG(cost) FROM event_log
SELECT avg(cost) FROM event_log
SELECT AVG(cost) AS mean_cost, activity FROM event_log GROUP BY activity;
SELECT AVG(cost) FROM event_log
SELECT AVG(cost) FROM event_log WHERE activity = 'Payment handled'
SELECT AVG(cost) FROM events_log WHERE activity = 'process_declaration';
SELECT COUNT(DISTINCT idcase), resource FROM event_log GROUP BY resource
SELECT resource, COUNT(DISTINCT idcase) AS num_cases FROM event_log GROUP BY resource ORDER BY num_cases DESC;
SELECT resource, COUNT(DISTINCT idcase) AS num_cases FROM event_log GROUP BY resource;
SELECT COUNT(DISTINCT idcase), resource FROM event_log GROUP BY resource;
SELECT COUNT(DISTINCT idcase), resource FROM event_log GROUP BY resource;
SELECT resource, count(DISTINCT idcase) AS num_cases FROM event_log GROUP BY resource;
SELECT resource, count(distinct idcase) FROM events_log group by resource
SELECT COUNT(DISTINCT idcase) AS num_declarations, resource FROM events_log GROUP BY resource;
SELECT COUNT(*) FROM event_log WHERE resource = 'Peter';
SELECT COUNT(*) FROM event_log WHERE resource = 'Peter';
SELECT count(*) FROM event_log WHERE resource = 'Peter'
SELECT COUNT(*) AS "Number of Actions" FROM event_log WHERE resource = 'Peter';
SELECT resource, COUNT(DISTINCT idcase) AS num_declarations FROM events_log GROUP BY resource HAVING num_declarations > 3;
SELECT resource, COUNT(*) AS num_declarations FROM ( SELECT resource, idcase FROM event_log WHERE activity = 'Declaration Processing' GROUP BY idcase ) AS subquery GROUP BY resource HAVING num_declarations > 3;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(DISTINCT idcase) > 3
SELECT employee_id FROM event_log GROUP BY employee_id HAVING COUNT(DISTINCT idcase) > 3;
SELECT resource, COUNT(DISTINCT idcase) AS num_cases FROM event_log GROUP BY resource HAVING num_cases > 3 ORDER BY num_cases DESC;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(DISTINCT idcase) > 3;
SELECT idcase, COUNT(*) AS num_events FROM events_log WHERE activity = 'Request payment' GROUP BY idcase ORDER BY num_events ASC;
SELECT idcase, COUNT(*) AS num_events FROM events_log WHERE activity = 'Request payment' GROUP BY idcase ORDER BY num_events ASC;
SELECT idcase, COUNT(*) AS num_events FROM event_log WHERE activity LIKE '%request payment%' GROUP BY idcase ORDER BY num_events ASC;
SELECT idcase, COUNT(*) AS num_events FROM events_log WHERE activity = 'Request payment' GROUP BY idcase ORDER BY num_events ASC;
SELECT idcase, COUNT(*) AS num_events FROM events_log WHERE activity = 'Request payment' GROUP BY idcase ORDER BY num_events DESC;
SELECT idcase, COUNT(*) AS num_events FROM events_log WHERE activity = 'Request payment' GROUP BY idcase ORDER BY num_events DESC;
SELECT idcase, COUNT(DISTINCT activity) AS num_activities FROM events_log WHERE activity = 'Request payment' GROUP BY idcase ORDER BY num_activities ASC;
SELECT resource FROM events_log WHERE activity = 'Request payment' GROUP BY resource ORDER BY COUNT(*) DESC;
SELECT timestamp FROM events_log WHERE activity = 'End trip' OR activity = 'Declaration rejected by employee' ORDER BY timestamp
SELECT DISTINCT timestamp FROM event_log WHERE activity = 'End trip' OR activity = 'Declaration rejected by employee' ORDER BY timestamp;
SELECT DISTINCT DATE(timestamp) AS event_date FROM event_log WHERE activity = 'End trip' OR activity = 'Declaration rejected by employee' ORDER BY event_date ASC;
SELECT DISTINCT timestamp FROM events_log WHERE activity IN ('End trip', 'Declaration rejected by employee') ORDER BY timestamp ASC;
SELECT timestamp FROM event_log WHERE activity IN ('end trip', 'closed') ORDER BY timestamp ASC;
SELECT DATE(timestamp) AS date FROM event_log WHERE activity IN ('End trip', 'Declaration rejected by employee') GROUP BY date ORDER BY date ASC;
SELECT e1.timestamp FROM events_log AS e1 WHERE e1.activity IN ('End trip', 'Declaration rejected by employee') ORDER BY e1.timestamp ASC;
SELECT DISTINCT timestamp FROM event_log WHERE activity IN ('End trip', 'Rejection of declaration by employee') ORDER BY timestamp;
SELECT resource, COUNT(*) AS activity_count FROM event_log GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) AS num_activities FROM event_log GROUP BY resource ORDER BY resource
SELECT resource, COUNT(*) AS activity_performances FROM event_log GROUP BY resource ORDER BY resource
SELECT resource, COUNT(*) AS activity_count FROM event_log GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) AS activity_count FROM event_log GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(DISTINCT activity) AS num_activities FROM event_log GROUP BY resource ORDER BY resource;
SELECT resource, activity, count (*) FROM events_log group by resource, activity order by resource
SELECT resource, COUNT(*) AS activity_occurrences FROM event_log GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(DISTINCT activity) AS activity_count FROM event_log GROUP BY resource ORDER BY resource;
SELECT resource, activity, COUNT(*) AS count FROM event_log GROUP BY resource, activity ORDER BY resource, activity;
SELECT e.name, COUNT(el.id) AS number_of_actions FROM employees AS e JOIN event_log AS el ON e.id = el.employee_id GROUP BY e.name ORDER BY e.name;
SELECT activity, COUNT(*) FROM events_log WHERE activity LIKE 'S%' GROUP BY activity HAVING COUNT(*) > 5;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) > 5;
SELECT * FROM event_log WHERE activity LIKE 'S%';
SELECT activity, COUNT(*) FROM events_log WHERE activity LIKE 'S%' GROUP BY activity HAVING COUNT(*) > 5;
SELECT * FROM event_log WHERE activity LIKE 'S%'
SELECT DISTINCT activity FROM events_log WHERE activity LIKE '%declaration%' AND resource LIKE 'S%';
SELECT DISTINCT activity FROM events_log WHERE activity LIKE '%declaration%';
SELECT id, activity, resource, cost FROM event_log WHERE cost BETWEEN 50 AND 400;
SELECT id, activity, resource, cost FROM event_log WHERE cost BETWEEN 50 AND 400;
SELECT id, activity, resource, cost FROM event_log WHERE cost BETWEEN 50 AND 400;
SELECT id, activity, resource, cost FROM event_log WHERE cost BETWEEN 50 AND 400 ORDER BY cost;
SELECT id, activity, resource, cost FROM event_log WHERE cost BETWEEN 50 AND 400;
SELECT id, activity, resource, cost FROM event_log WHERE cost BETWEEN 50 AND 400;
SELECT id, activity, resource, cost FROM event_log WHERE cost BETWEEN 50 AND 400;
SELECT id, activity, resource, cost FROM event_log WHERE cost BETWEEN 50 AND 400 ORDER BY cost;
SELECT el.id, el.activity, el.cost, e.name AS employee_name FROM event_log AS el JOIN employees AS e ON el.resource = e.id WHERE el.activity LIKE '%declaration processing%' AND el.cost BETWEEN 50 AND 400 ORDER BY el.cost DESC;
SELECT DISTINCT resource FROM events_log WHERE activity = 'Declaration saved by employee';
SELECT DISTINCT resource FROM event_log WHERE activity = 'Declaration saved by employee';
SELECT resource FROM event_log WHERE activity = 'Saved Declaration' GROUP BY resource
SELECT resource from events_log WHERE activity = 'save declaration' GROUP BY resource
SELECT activity FROM event_log WHERE timestamp BETWEEN '2018-04-12 00:00:00' AND '2018-04-12 23:59:59';
SELECT activity FROM event_log WHERE timestamp BETWEEN '2018-04-12 00:00:00' AND '2018-04-12 23:59:59';
SELECT activity FROM event_log WHERE timestamp BETWEEN '2018-04-12 00:00:00' AND '2018-04-12 23:59:59';
SELECT activity FROM event_log WHERE timestamp BETWEEN '2018-04-12' AND '2018-04-13'
SELECT activity FROM event_log WHERE timestamp IN ( SELECT timestamp FROM event_log WHERE DATE(timestamp) = '2018-04-12' ) GROUP BY activity
SELECT DISTINCT activity FROM event_log WHERE timestamp BETWEEN '2018-01-01' AND '2018-07-31';
SELECT activity FROM event_log WHERE timestamp BETWEEN '2018-04-12' AND '2018-04-13' AND activity = 'End trip';
SELECT activity FROM event_log WHERE timestamp BETWEEN '2018-04-12' AND '2018-04-13' AND activity IN ( SELECT activity FROM event_log WHERE activity LIKE '%Performance%' )
SELECT activity FROM event_log WHERE timestamp BETWEEN '2018-04-12 00:00:00' AND '2018-04-12 23:59:59' AND activity LIKE '%declaration%';
SELECT "id", "activity", "timestamp" FROM "event_log" WHERE "activity" LIKE '%Permit%'
SELECT id, activity, timestamp FROM event_log WHERE activity IN ('Permit final approved by supervisor', 'Declaration approved by supervisor') ORDER BY timestamp DESC;
SELECT id, activity, timestamp FROM event_log WHERE activity IN ('Permit final approved by supervisor', 'Declaration approved by supervisor') ORDER BY timestamp DESC;
SELECT id, activity, timestamp FROM events_log WHERE activity IN ('Permit final approved by supervisor', 'Declaration approved by supervisor') ORDER BY timestamp DESC;
SELECT id, activity, timestamp FROM event_log WHERE activity IN ('Permit final approved by supervisor', 'Declaration approved by supervisor') ORDER BY timestamp DESC;
SELECT "id", "activity", "timestamp" FROM "event_log" WHERE "activity" IN ('Permit final approved by supervisor', 'Declaration approved by supervisor') ORDER BY "timestamp" DESC;
SELECT el.id, el.activity, el.timestamp AS performance_end_date FROM event_log AS el WHERE el.activity IN ('Final approval of a permit', 'Approval of a declaration by a supervisor') ORDER BY el.timestamp DESC;
SELECT "id", "activity", "timestamp" FROM "event_log" WHERE "activity" IN ('Final approval of permit', 'Declaration final approved by supervisor') ORDER BY "timestamp" DESC;
SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT * from event_log WHERE cost IS NOT NULL
SELECT * FROM event_log WHERE cost IS NOT NULL
SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT id, activity, resource, cost FROM events_log WHERE cost <> 0;
SELECT COUNT(*) FROM event_log WHERE activity='Permit final approved by director'
SELECT COUNT(*) FROM event_log WHERE activity = 'Permit final approved by director';
SELECT count(*) FROM event_log WHERE activity = 'Permit final approved by director'
SELECT COUNT(*) FROM events_log WHERE activity = 'Permit final approved by director';
SELECT COUNT(*) FROM event_log WHERE activity='Permit final approved by director'
SELECT COUNT(*) FROM event_log WHERE activity='Permit final approved by director'
SELECT COUNT(*) FROM event_log WHERE activity = 'Permit final approved by director';
SELECT COUNT(*) FROM event_log WHERE activity = 'Permit final approved by director';
SELECT COUNT(*) FROM event_log WHERE activity = 'Permit final approved by director';
SELECT COUNT(*) FROM event_log WHERE activity = 'Permit final approved by a director'
SELECT COUNT(*) FROM events_log WHERE activity LIKE '%Permit%' AND resource LIKE '%Director%';
SELECT COUNT(*) FROM event_log WHERE activity = 'Final permit approved by director'
SELECT timestamp FROM event_log WHERE activity = 'Start trip' AND resource LIKE '%s' ORDER BY timestamp;
SELECT timestamp FROM event_log WHERE activity = 'Start trip' AND resource LIKE '%s' ORDER BY timestamp;
SELECT timestamp FROM event_log WHERE activity = 'Start trip' AND resource LIKE '%s' ORDER BY timestamp;
SELECT timestamp FROM event_log WHERE activity = 'Start trip' AND resource LIKE '%s';
SELECT timestamp FROM event_log WHERE activity = 'Start trip' AND resource LIKE '%s'
SELECT timestamp FROM event_log WHERE activity = 'Start trip' AND resource LIKE '%s'
SELECT timestamp FROM event_log WHERE activity = 'Start trip' AND resource LIKE '%s'
SELECT timestamp FROM event_log WHERE activity = 'Start trip' AND resource LIKE '%s'
SELECT DISTINCT DATE(timestamp) FROM event_log WHERE activity = 'Start trip' AND resource LIKE '%s'
SELECT DISTINCT DATE(timestamp) FROM event_log WHERE activity = 'Start trip' AND resource LIKE '%s';
SELECT activity, resource, SUM(cost) AS total_cost FROM event_log GROUP BY activity, resource;
SELECT SUM(cost) FROM event_log WHERE activity = 'activity_name' AND resource = 'resource_name';
SELECT SUM(cost) FROM event_log GROUP BY activity, resource;
SELECT activity, resource, SUM(cost) AS total_cost FROM event_log GROUP BY activity, resource;
SELECT activity, resource, SUM(cost) AS total_cost FROM event_log GROUP BY activity, resource ORDER BY total_cost DESC;
SELECT activity, resource, SUM(cost) AS total_cost FROM event_log GROUP BY activity, resource;
SELECT SUM(cost) AS total_cost, activity, resource FROM event_log GROUP BY activity, resource;
SELECT activity, resource, SUM(cost) AS total_cost FROM event_log WHERE activity LIKE '%declaration%' GROUP BY 1, 2 ORDER BY 3 DESC;
SELECT COUNT(*) FROM event_log WHERE activity IN ('Start trip', 'End trip');
SELECT COUNT(*) AS "Number of Occurrences", activity FROM event_log WHERE activity IN ('Start trip', 'End trip') GROUP BY activity;
SELECT COUNT(*) AS "Number of Occurrences", e1.activity AS "Activity" FROM events_log AS e1 WHERE e1.activity IN ('Start trip', 'End trip') GROUP BY e1.activity;
SELECT COUNT(*) AS "Number of Events" FROM event_log WHERE activity IN ('Start trip', 'End trip');
SELECT count(*) FROM events_log WHERE activity IN ('Start trip', 'End trip')
SELECT activity, COUNT(*) AS event_count FROM event_log WHERE activity IN ('start trip', 'end trip') GROUP BY activity;
SELECT COUNT(*) AS "Number of Occurrences", activity FROM event_log WHERE activity IN ('Start trip', 'End trip') GROUP BY activity;
SELECT COUNT(*) AS "Total Activities" FROM event_log WHERE activity IN ('Start trip', 'End trip');
SELECT COUNT(DISTINCT e1.idcase) FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e1.activity = 'Start trip' AND e2.activity = 'End trip';
SELECT COUNT(*) FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e1.activity = 'Start trip' AND e2.activity = 'End trip'
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 3
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 3
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 3
SELECT activity, COUNT(*) AS count FROM event_log GROUP BY activity HAVING COUNT(*) > 3 ORDER BY count DESC;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 3;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 3;
SELECT activity, COUNT(*) AS event_count FROM event_log GROUP BY activity HAVING event_count > 3;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) > 3;
SELECT activity, COUNT(*) AS count FROM events_log WHERE activity LIKE '%declaration%' GROUP BY activity HAVING count > 3 ORDER BY count DESC;
SELECT activity, COUNT(id) AS count_activity FROM event_log WHERE idcase LIKE 'travel_declaration%' GROUP BY activity HAVING COUNT(id) > 3 ORDER BY count_activity DESC;
SELECT activity, resource FROM event_log ORDER BY timestamp DESC LIMIT 1;
SELECT activity, resource, MAX(timestamp) AS last_performed_timestamp FROM event_log GROUP BY activity, resource;
SELECT activity, resource, MAX(timestamp) AS last_activity_timestamp FROM event_log GROUP BY resource;
SELECT activity, resource FROM event_log ORDER BY timestamp DESC LIMIT 1;
SELECT activity, resource, MAX(timestamp) AS last_event_timestamp FROM event_log GROUP BY activity, resource;
SELECT activity, resource FROM event_log ORDER BY timestamp DESC LIMIT 1;
SELECT activity, resource FROM event_log ORDER BY timestamp DESC LIMIT 1;
SELECT e1.resource, e2.activity FROM events_log AS e1 INNER JOIN events_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' AND e1.timestamp > e2.timestamp ORDER BY e1.timestamp DESC LIMIT 1;
SELECT resource, activity FROM events_log WHERE id = ( SELECT MAX(id) FROM events_log );
SELECT el1.activity, el1.resource FROM event_log AS el1 JOIN event_log AS el2 ON el1.idcase = el2.idcase WHERE el2.activity = 'End trip' AND el1.timestamp > el2.timestamp ORDER BY el1.resource;
SELECT el1.idcase, el1.activity, el1.timestamp, el1.resource, el2.resource AS end_trip_resource FROM event_log el1 JOIN event_log el2 ON el1.idcase = el2.idcase AND el2.activity = 'End trip' WHERE el1.timestamp > el2.timestamp ORDER BY el1.resource;
SELECT el1.idcase, el1.activity, el1.timestamp, el1.resource, el2.resource AS end_trip_resource FROM event_log el1 JOIN event_log el2 ON el1.idcase = el2.idcase AND el2.activity = 'End trip' WHERE el1.timestamp > el2.timestamp ORDER BY el1.resource;
SELECT el1.activity, el1.resource, el1.timestamp FROM event_log el1 JOIN event_log el2 ON el1.idcase = el2.idcase WHERE el2.activity = 'End trip' AND el1.timestamp > el2.timestamp ORDER BY el1.timestamp;
SELECT el.activity, el.resource, el.timestamp FROM event_log el JOIN ( SELECT idcase, MAX(timestamp) AS max_timestamp FROM event_log WHERE activity = 'End trip' GROUP BY idcase ) AS max_end_trip ON el.idcase = max_end_trip.idcase AND el.timestamp > max_end_trip.max_timestamp ORDER BY el.timestamp;
SELECT el1.idcase, el1.activity, el1.timestamp, el1.resource, el2.resource AS resource_end_trip FROM event_log AS el1 JOIN event_log AS el2 ON el1.idcase = el2.idcase WHERE el2.activity = 'End trip' AND el1.timestamp > el2.timestamp ORDER BY el1.idcase, el1.timestamp;
SELECT el.activity, el.timestamp, el.resource, el2.resource AS responsible_resource FROM event_log AS el JOIN event_log AS el2 ON el.idcase = el2.idcase AND el.timestamp > el2.timestamp WHERE el2.activity = 'End trip';
SELECT el.idcase, el.activity, el.timestamp, el.resource, el.cost, el.idcase, u.name AS responsible_person FROM event_log AS el JOIN users AS u ON el.resource = u.id WHERE el.timestamp > ( SELECT timestamp FROM event_log WHERE activity = 'End trip' ) ORDER BY el.timestamp;
SELECT activity, resource FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log WHERE activity = 'End trip' ) AND timestamp > ( SELECT timestamp FROM event_log WHERE activity = 'End trip' );
SELECT el1.activity AS "Event 1", el1.timestamp AS "Event 1 Timestamp", el1.resource AS "Event 1 Resource", el2.activity AS "Event 2", el2.timestamp AS "Event 2 Timestamp", el2.resource AS "Event 2 Resource" FROM event_log AS el1 JOIN event_log AS el2 ON el1.idcase = el2.idcase WHERE el1.activity = 'End trip' AND el2.timestamp > el1.timestamp ORDER BY el1.idcase, el2.timestamp;
SELECT el.idcase, el.activity, el.timestamp, el.resource, el.cost, el.idcase, u.name AS responsible_person FROM event_log AS el JOIN users AS u ON el.resource = u.username WHERE el.timestamp > ( SELECT timestamp FROM event_log WHERE activity = 'End trip' AND idcase = el.idcase ) ORDER BY el.idcase, el.timestamp;
SELECT el1.idcase, el1.activity, el1.timestamp, el1.resource, el2.activity AS previous_activity, el2.resource AS previous_resource FROM event_log AS el1 JOIN event_log AS el2 ON el1.idcase = el2.idcase WHERE el1.timestamp > el2.timestamp AND el2.activity = 'End trip' ORDER BY el1.idcase, el1.timestamp;
SELECT el1.idcase, el1.activity AS end_trip_activity, el1.timestamp AS end_trip_timestamp, el2.activity, el2.timestamp, el2.resource FROM event_log AS el1 JOIN event_log AS el2 ON el1.idcase = el2.idcase WHERE el1.activity = 'End trip' AND el2.timestamp > el1.timestamp ORDER BY el1.idcase, el2.timestamp;
SELECT el1.idcase, el1.timestamp AS end_trip_timestamp, el2.activity, el2.timestamp AS activity_timestamp, el2.resource AS activity_resource FROM events_log AS el1 JOIN events_log AS el2 ON el1.idcase = el2.idcase WHERE el1.activity = 'End trip' AND el2.timestamp > el1.timestamp ORDER BY el1.idcase, el2.timestamp;
SELECT el1.idcase, el1.timestamp AS end_trip_timestamp, el2.activity, el2.timestamp AS activity_timestamp, el2.resource AS activity_resource FROM events_log AS el1 JOIN events_log AS el2 ON el1.idcase = el2.idcase WHERE el1.activity = 'End trip' AND el2.timestamp > el1.timestamp ORDER BY el1.idcase, el2.timestamp;
SELECT el.activity, el.timestamp, el.resource, el.cost, el.idcase, u.name AS responsible_user FROM event_log AS el JOIN users AS u ON el.user_id = u.id WHERE el.timestamp > ( SELECT MAX(timestamp) FROM event_log WHERE activity = 'Trip registration' AND idcase = el.idcase ) ORDER BY el.timestamp DESC;
SELECT idcase, timestamp, resource FROM events_log WHERE activity = 'End trip' ORDER BY resource;
SELECT resource, COUNT(*) AS num_events FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT resource, COUNT(*) AS num_events FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT resource, COUNT(*) AS num_events FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT resource, COUNT(*) AS num_events FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT resource, COUNT(*) AS num_events FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT e1.resource, COUNT(*) AS num_events FROM event_log AS e1 INNER JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' AND e1.timestamp < e2.timestamp GROUP BY e1.resource
SELECT COUNT(*) AS num_events, e1.resource AS resource FROM event_log AS e1 LEFT JOIN event_log AS e2 ON e1.idcase = e2.idcase AND e2.activity = 'End trip' WHERE e2.id IS NULL GROUP BY e1.resource;
SELECT e1.resource, COUNT(*) AS num_events FROM event_log AS e1 INNER JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' AND e1.timestamp < e2.timestamp GROUP BY e1.resource;
SELECT resource, COUNT(*) AS num_events FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT resource, COUNT(*) AS num_events FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT resource, COUNT(*) AS num_events FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT COUNT(*) AS "Number of events" FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT e1.resource, COUNT(*) AS num_events FROM event_log AS e1 INNER JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' AND e1.timestamp < e2.timestamp AND e1.activity <> 'End trip' GROUP BY e1.resource;
SELECT COUNT(*) AS num_events FROM event_log AS e1 WHERE NOT EXISTS ( SELECT 1 FROM event_log AS e2 WHERE e1.idcase = e2.idcase AND e2.activity = 'End trip' AND e1.timestamp < e2.timestamp ) AND e1.resource IN ( SELECT resource FROM event_log WHERE activity = 'End trip' );
SELECT resource, COUNT(*) AS event_count FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT resource, COUNT(*) AS total_events, SUM(CASE WHEN activity = 'End trip' THEN 1 ELSE 0 END) AS end_trip_events FROM event_log GROUP BY resource
SELECT resource, COUNT(*) AS event_count FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT COUNT(*) AS event_amount, resource FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT COUNT(*) AS event_count, e1.resource FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' AND e1.timestamp < e2.timestamp AND e1.activity <> 'End trip' GROUP BY e1.resource;
SELECT e1.resource, COUNT(*) AS event_count FROM event_log AS e1 INNER JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' AND e1.timestamp < e2.timestamp GROUP BY e1.resource HAVING COUNT(*) > 1;
SELECT COUNT(*) AS event_count FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' AND e1.timestamp < e2.timestamp GROUP BY e1.idcase HAVING COUNT(*) > 1;
SELECT resource, COUNT(*) AS event_count FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT COUNT(*) AS event_count, e1.resource AS resource FROM event_log AS e1 INNER JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' AND e1.timestamp < e2.timestamp GROUP BY e1.resource
SELECT resource, COUNT(*) AS event_count FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT COUNT(*) AS event_count, resource FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT COUNT(*) AS event_count, resource FROM event_log WHERE activity <> 'End trip' GROUP BY resource;
SELECT COUNT(*) AS event_count FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' AND e1.timestamp < e2.timestamp GROUP BY e1.idcase HAVING COUNT(*) > 1;
SELECT COUNT(*) AS event_count, e1.resource AS resource FROM event_log AS e1 INNER JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' AND e1.timestamp < e2.timestamp GROUP BY e1.resource HAVING NOT e1.activity = 'End trip';
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity LIKE '%Travel Declaration%' AND NOT activity LIKE '%End Trip%'
SELECT count(*), resource FROM events_log WHERE activity NOT LIKE '%End trip%' GROUP BY resource;
SELECT idcase, MIN(timestamp) AS start_date FROM events_log GROUP BY idcase ORDER BY start_date DESC;
SELECT DISTINCT idcase FROM events_log ORDER BY MIN(timestamp) DESC;
SELECT idcase, MIN(timestamp) AS start_date FROM event_log GROUP BY idcase ORDER BY start_date DESC
SELECT idcase, MIN(timestamp) AS start_date FROM events_log GROUP BY idcase ORDER BY start_date DESC;
SELECT DISTINCT idcase, MIN(timestamp) AS first_action_timestamp FROM events_log GROUP BY idcase ORDER BY first_action_timestamp;
SELECT idcase FROM events_log WHERE activity = 'Start trip' ORDER BY timestamp
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Request payment'
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'Request payment'
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'Request payment'
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'Request payment'
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'Request payment'
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'Request payment'
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'Request payment';
SELECT idcase FROM events_log WHERE activity='Declaration final approved by director' ORDER BY timestamp DESC LIMIT 1
SELECT idcase FROM events_log WHERE activity = 'Declaration final approved by director' ORDER BY timestamp DESC LIMIT 1;
SELECT idcase FROM events_log WHERE activity='Declaration final approved by director' ORDER BY timestamp DESC LIMIT 1
SELECT idcase FROM events_log WHERE activity='Declaration final approved by director' ORDER BY timestamp DESC LIMIT 1
SELECT idcase FROM events_log WHERE activity = 'Declaration final approved by director' ORDER BY timestamp DESC LIMIT 1;
SELECT e.idcase FROM events_log e INNER JOIN (SELECT idcase, MAX(timestamp) as timestamp FROM events_log where activity='Declaration final approved by director' GROUP BY idcase order by idcase) e1 on e.idcase = e1.idcase and e.timestamp = e1.timestamp
SELECT e.idcase, e.activity, e.timestamp FROM events_log e INNER JOIN (SELECT idcase, MAX(timestamp) as timestamp FROM events_log where activity='Declaration final approved by director' GROUP BY idcase order by idcase) e1 on e.idcase = e1.idcase and e.timestamp = e1.timestamp
SELECT resource, count(*) AS activity_count FROM events_log WHERE activity = 'Declaration approved by administration' GROUP BY resource ORDER BY activity_count DESC LIMIT 1;
SELECT resource, count(*) AS activity_count FROM events_log WHERE activity = 'Declaration approved by administration' GROUP BY resource ORDER BY activity_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS count FROM events_log WHERE activity = 'Declaration approved by administration' GROUP BY resource ORDER BY count DESC LIMIT 1;
SELECT resource, COUNT(*) AS event_count FROM events_log WHERE activity = 'Declaration approved by administration' GROUP BY resource ORDER BY event_count DESC LIMIT 1;
SELECT resource, COUNT(*) AS count FROM events_log WHERE activity = 'Declaration approved by administration' GROUP BY resource ORDER BY count DESC LIMIT 1;
SELECT resource, COUNT(*) AS num_approvals FROM events_log WHERE activity = 'Declaration approved by administration' GROUP BY resource ORDER BY num_approvals DESC LIMIT 1;
SELECT resource FROM event_log WHERE activity = 'Approve Declaration' AND resource LIKE '%Administration%' GROUP BY resource HAVING COUNT(*) = (SELECT COUNT(*) FROM event_log WHERE activity = 'Approve Declaration' AND resource LIKE '%Administration%' GROUP BY resource ORDER BY COUNT(*) DESC LIMIT 1)
SELECT COUNT(DISTINCT idcase) AS "Number of Cases" FROM event_log WHERE activity = ( SELECT activity FROM event_log ORDER BY timestamp LIMIT 1 ) GROUP BY resource;
SELECT resource,COUNT(*) FROM ( SELECT resource, activity, ROW_NUMBER() OVER (PARTITION BY resource ORDER BY timestamp) AS row_num FROM event_log ) AS subquery WHERE row_num = 1 GROUP BY resource
SELECT COUNT(DISTINCT idcase) AS "Number of Cases", resource FROM events_log WHERE activity = ( SELECT activity FROM events_log WHERE idcase = events_log.idcase ORDER BY timestamp ASC LIMIT 1 ) GROUP BY resource;
SELECT COUNT(DISTINCT idcase) AS "Number of Process Instances", resource FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log WHERE activity = 'Start' ) GROUP BY resource
SELECT resource, COUNT(DISTINCT CASE WHEN MIN(timestamp) OVER (PARTITION BY idcase ORDER BY timestamp) = timestamp THEN idcase ELSE NULL END) AS first_activity_count FROM event_log GROUP BY resource;
SELECT COUNT(DISTINCT idcase) AS "Number of Declarations" FROM event_log WHERE activity = 'First action' GROUP BY resource;
SELECT COUNT(*), resource FROM events_log WHERE activity = 'INITIATE_DECLARATION' GROUP BY resource
SELECT count(*) FROM event_log WHERE activity LIKE '%approved%'
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity LIKE '%approved%';
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity LIKE '%approved%'
SELECT count(*) FROM event_log WHERE activity LIKE '%approved%'
SELECT count(*) FROM event_log WHERE activity LIKE '%approved%'
SELECT count(*) FROM events_log WHERE activity LIKE '%approved%'
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity LIKE '%approved%'
SELECT count(DISTINCT idcase) FROM events_log WHERE activity LIKE '%approved%'
SELECT DATE(timestamp) AS day, COUNT(*) AS rejected_activities FROM event_log WHERE activity LIKE '%rejected%' GROUP BY day ORDER BY day;
SELECT DATE(timestamp) AS day, COUNT(DISTINCT idcase) AS num_cases FROM event_log WHERE activity LIKE '%rejected%' GROUP BY day ORDER BY day;
SELECT DATE(timestamp) AS day, COUNT(DISTINCT idcase) AS num_instances FROM event_log WHERE activity = 'rejected' GROUP BY day ORDER BY day;
SELECT DATE(timestamp) AS date, COUNT(*) AS num_rejected_activities FROM event_log WHERE activity LIKE '%rejected%' GROUP BY date ORDER BY date;
SELECT DATE(timestamp) AS day, COUNT(DISTINCT idcase) AS num_cases FROM event_log WHERE activity LIKE '%rejected%' GROUP BY day ORDER BY day;
SELECT DATE(timestamp) AS day, COUNT(*) AS rejected_activity_count FROM event_log WHERE activity LIKE '%rejected%' GROUP BY day ORDER BY day;
SELECT DATE(timestamp) AS date, COUNT(*) AS rejected_declarations FROM event_log WHERE activity LIKE '%rejected%' GROUP BY date ORDER BY date;
SELECT DATE(timestamp) AS date, COUNT(DISTINCT idcase) AS num_declarations FROM event_log WHERE activity LIKE '%rejected%' GROUP BY date ORDER BY date;
SELECT idcase, COUNT(*) AS event_count, strftime('%s', MAX(timestamp)) - strftime('%s', MIN(timestamp)) AS duration FROM event_log GROUP BY idcase HAVING event_count >= 20 ORDER BY event_count DESC LIMIT 5;
SELECT el.idcase, COUNT(el.id) AS event_count, strftime('%s', MAX(el.timestamp)) - strftime('%s', MIN(el.timestamp)) AS duration_seconds FROM event_log AS el GROUP BY el.idcase HAVING event_count >= 20 ORDER BY event_count DESC LIMIT 5;
SELECT idcase, strftime('%s', MAX(timestamp)) - strftime('%s', MIN(timestamp)) AS duration FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) >= 20 ORDER BY COUNT(*) DESC LIMIT 5 ) GROUP BY idcase ORDER BY duration DESC LIMIT 5;
SELECT el.idcase, COUNT(el.id) AS event_count, ( SELECT strftime('%s', MAX(timestamp)) - strftime('%s', MIN(timestamp)) FROM event_log WHERE idcase = el.idcase ) AS duration_seconds FROM event_log AS el GROUP BY el.idcase HAVING event_count >= 20 ORDER BY event_count DESC LIMIT 5;
SELECT idcase, COUNT(DISTINCT activity) AS num_activities FROM events_log GROUP BY idcase ORDER BY num_activities DESC LIMIT 5;
SELECT idcase, (MAX(timestamp) - MIN(timestamp)) AS duration FROM event_log GROUP BY idcase ORDER BY duration DESC LIMIT 5;
SELECT idcase, COUNT(*) AS event_count, strftime('%s', MAX(timestamp)) - strftime('%s', MIN(timestamp)) AS case_duration FROM event_log GROUP BY idcase HAVING event_count >= 20 ORDER BY event_count DESC LIMIT 5;
SELECT DISTINCT resource, COUNT(*) AS num_actions FROM events_log GROUP BY resource HAVING COUNT(*) > 5 ORDER BY num_actions DESC LIMIT 5;
SELECT activity, SUM(cost) AS total_cost FROM events_log GROUP BY activity ORDER BY total_cost DESC LIMIT 5;
SELECT strftime('%s', MAX(timestamp)) - strftime('%s', MIN(timestamp)) AS duration, idcase FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) >= 20 ORDER BY COUNT(*) DESC LIMIT 5 ) GROUP BY idcase ORDER BY duration DESC;
SELECT el.idcase, strftime('%s', MAX(el.timestamp)) - strftime('%s', MIN(el.timestamp)) AS duration FROM event_log AS el GROUP BY el.idcase HAVING COUNT(*) >= 20 ORDER BY duration DESC LIMIT 5;
SELECT idcase, COUNT(DISTINCT activity) AS activity_count, MAX(timestamp) - MIN(timestamp) AS duration FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT activity) >= 20 ORDER BY activity_count DESC LIMIT 5;
SELECT strftime('%s', MAX(timestamp)) - strftime('%s', MIN(timestamp)), idcase FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) >= 20 ) GROUP BY idcase ORDER BY strftime('%s', MAX(timestamp)) - strftime('%s', MIN(timestamp)) DESC LIMIT 5;
SELECT strftime('%s', MAX(timestamp)) - strftime('%s', MIN(timestamp)), idcase FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) >= 20 ) GROUP BY idcase ORDER BY COUNT(*) DESC LIMIT 5;
SELECT idcase, strftime('%s', MAX(timestamp)) - strftime('%s', MIN(timestamp)) AS duration FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) >= 20 ) GROUP BY idcase ORDER BY duration DESC LIMIT 5;
SELECT idcase, strftime('%s', MAX(timestamp)) - strftime('%s', MIN(timestamp)) AS duration FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) >= 20 ) GROUP BY idcase ORDER BY duration DESC LIMIT 5;
SELECT strftime('%s', MAX(timestamp)) - strftime('%s', MIN(timestamp)), idcase FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) >= 20 ) GROUP BY idcase ORDER BY strftime('%s', MAX(timestamp)) - strftime('%s', MIN(timestamp)) DESC LIMIT 5;
SELECT DISTINCT idcase FROM events_log WHERE idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'Request payment' ) ORDER BY timestamp DESC LIMIT 10;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'End trip' INTERSECT SELECT DISTINCT idcase FROM events_log GROUP BY idcase HAVING COUNT(DISTINCT resource) > 1 EXCEPT SELECT DISTINCT idcase FROM events_log WHERE activity = 'Request Payment' OR activity = 'Payment handled';
SELECT DISTINCT idcase FROM events_log WHERE idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'Request payment' ) ORDER BY timestamp DESC LIMIT 10;
SELECT DISTINCT idcase FROM events_log WHERE idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'Request payment' ) ORDER BY timestamp DESC LIMIT 10;
SELECT DISTINCT idcase FROM events_log WHERE idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'Request payment' ) ORDER BY timestamp DESC LIMIT 10;
SELECT DISTINCT idcase FROM events_log WHERE activity <> 'Request payment' ORDER BY timestamp DESC LIMIT 10;
SELECT DISTINCT idcase FROM events_log WHERE activity <> 'Request payment' ORDER BY timestamp DESC LIMIT 10;
SELECT DISTINCT idcase FROM events_log WHERE activity <> 'Request payment' ORDER BY timestamp DESC LIMIT 10;
SELECT DISTINCT idcase FROM events_log WHERE activity <> 'Request payment' ORDER BY timestamp DESC LIMIT 10;
SELECT DISTINCT idcase FROM events_log WHERE idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'Request payment' ) ORDER BY timestamp DESC LIMIT 10;
SELECT idcase FROM events_log WHERE activity <> 'Request payment' GROUP BY idcase ORDER BY timestamp DESC LIMIT 10;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Processing declaration' AND idcase NOT IN ( SELECT DISTINCT idcase FROM events_log WHERE activity = 'Request payment' ) ORDER BY timestamp DESC LIMIT 10;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) <= 10;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) <= 10;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) <= 10
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) <= 10;
SELECT idcase FROM ( SELECT idcase, COUNT(*) AS event_count FROM events_log GROUP BY idcase ) WHERE event_count <= 10;
SELECT idcase FROM events_log GROUP BY idcase HAVING count(*) <= 10
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) <= 10;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) <= 10;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) <= 10;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) BETWEEN 1 AND 10;
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) >= 10;
SELECT idcase FROM events_log GROUP BY idcase HAVING count(*) <= 10
SELECT AVG(cost) FROM event_log WHERE activity = 'Payment handled' AND timestamp < '2018-01-01'
SELECT strftime('%Y-%m-%d', timestamp) AS event_date, SUM(cost) AS total_cost FROM events_log WHERE activity = 'payment handled' AND timestamp < '2018-01-01' GROUP BY event_date ORDER BY event_date;
SELECT AVG(cost) FROM event_log WHERE activity = 'payment handled' AND timestamp < '2018-01-01';
SELECT AVG(cost) FROM event_log WHERE activity = 'payment handled' AND timestamp < '2018-01-01';
SELECT AVG(cost) FROM event_log WHERE activity = 'Payment handled' AND timestamp < '2018-01-01';
SELECT AVG(cost) FROM event_log WHERE activity = 'payment handled' AND timestamp < '2018-01-01';
SELECT AVG(cost) FROM event_log WHERE activity = 'payment handled' AND timestamp < '2018-01-01';
SELECT AVG(cost) FROM event_log WHERE activity = 'payment handled' AND timestamp < '2018-01-01';
SELECT AVG(cost) FROM event_log WHERE activity LIKE '%payment%' AND timestamp < '2018-01-01';
SELECT idcase, COUNT(activity) AS permit_count FROM events_log WHERE activity LIKE 'Permit%' GROUP BY idcase;
SELECT idcase, COUNT(activity) AS num_permit_activities FROM event_log WHERE activity LIKE 'Permit%' GROUP BY idcase;
SELECT idcase, COUNT(activity) AS permit_count FROM event_log WHERE activity LIKE 'Permit%' GROUP BY idcase;
SELECT idcase, COUNT(activity) AS permit_count FROM event_log WHERE activity LIKE 'Permit%' GROUP BY idcase;
SELECT idcase, COUNT(*) AS event_count FROM event_log WHERE activity LIKE 'Permit%' GROUP BY idcase ORDER BY event_count DESC;
SELECT idcase, COUNT(*) AS num_permit_activities FROM event_log WHERE activity LIKE 'Permit%' GROUP BY idcase;
SELECT idcase, COUNT(*) AS permit_count FROM event_log WHERE activity LIKE '%Permit%' GROUP BY idcase
SELECT idcase, COUNT(*) AS event_count FROM event_log WHERE activity LIKE '%permit%' GROUP BY idcase
SELECT COUNT(*) AS "Number of Permits" FROM event_log WHERE activity = 'Permit registered' GROUP BY resource;
SELECT resource, COUNT(*) AS permit_count FROM event_log WHERE activity LIKE '%Permit%' GROUP BY resource
SELECT e1.idcase, e1.resource FROM events_log e1 inner join (SELECT idcase, MIN(timestamp) as timestamp FROM events_log GROUP BY idcase order by timestamp) AS e2 on e1.idcase=e2.idcase WHERE e1.activity = 'Declaration rejected by supervisor' ORDER by e2.timestamp
SELECT COUNT(DISTINCT e1.idcase) AS num_cases, GROUP_CONCAT(DISTINCT e1.resource) AS resources FROM events_log e1 WHERE e1.activity = 'Declaration rejected by supervisor' GROUP BY e1.resource ORDER BY num_cases DESC;
SELECT count(DISTINCT idcase), resource FROM events_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource
SELECT COUNT(DISTINCT idcase) AS "Number of Cases", resource AS "Resource" FROM event_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource
SELECT COUNT(DISTINCT idcase) AS "Number of Cases", resource AS "Resource" FROM event_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource;
SELECT COUNT(DISTINCT idcase) AS "Number of Cases", resource FROM event_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource;
SELECT COUNT(DISTINCT idcase) AS "Number of Declarations Rejected" FROM events_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource;
SELECT count(*), resource FROM events_log WHERE activity = 'Declaration rejected by supervisor' GROUP BY resource
SELECT COUNT(DISTINCT idcase) AS num_cases, activity FROM event_log GROUP BY activity;
SELECT count (DISTINCT idcase), activity FROM event_log group by activity
SELECT count(DISTINCT idcase), activity FROM event_log GROUP BY activity
SELECT COUNT(DISTINCT idcase), activity FROM event_log GROUP BY activity;
SELECT count(DISTINCT idcase), activity FROM event_log GROUP BY activity;
SELECT COUNT(DISTINCT idcase) AS "Number of Cases", activity FROM event_log GROUP BY activity;
SELECT activity, COUNT(*) AS count FROM event_log WHERE activity LIKE '%declaration%' GROUP BY activity;
SELECT COUNT(DISTINCT idcase) AS num_declarations, activity FROM event_log GROUP BY activity;
SELECT el1.id FROM event_log AS el1 JOIN event_log AS el2 ON el1.idcase = el2.idcase WHERE el1.activity LIKE 'R%' AND el1.timestamp > el2.timestamp AND el2.activity LIKE 'D%';
SELECT * FROM event_log WHERE activity LIKE 'R%' AND timestamp > ( SELECT MAX(timestamp) FROM event_log WHERE activity LIKE 'D%' );
SELECT * FROM event_log WHERE activity LIKE 'R%' AND timestamp > ( SELECT MAX(timestamp) FROM event_log WHERE activity LIKE 'D%' );
SELECT * FROM event_log WHERE activity LIKE 'R%' AND timestamp > ( SELECT MAX(timestamp) FROM event_log WHERE activity LIKE 'D%' );
SELECT * FROM event_log WHERE activity LIKE 'R%' AND timestamp > ( SELECT MAX(timestamp) FROM event_log WHERE activity LIKE 'D%' );
SELECT * FROM event_log WHERE activity LIKE 'R%' AND timestamp > ( SELECT MAX(timestamp) FROM event_log WHERE activity LIKE 'D%' );
SELECT e1.activity AS "action_after" FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e1.timestamp > e2.timestamp AND e1.activity LIKE 'R%' AND e2.activity LIKE 'D%'
SELECT e1.activity AS declaration_activity, e2.activity AS registration_activity FROM events_log AS e1 JOIN events_log AS e2 ON e1.idcase = e2.idcase WHERE e1.activity LIKE '%declaration%' AND e2.activity LIKE 'R%' AND e1.timestamp < e2.timestamp;
SELECT COUNT(*) AS "Number of Activities", resource FROM events_log GROUP BY resource;
SELECT COUNT(*) AS "Number of Activities", resource FROM events_log GROUP BY resource;
SELECT resource, activity, COUNT(*) AS count FROM event_log GROUP BY resource, activity ORDER BY resource, count DESC;
SELECT resource, activity, COUNT(*) AS count FROM event_log GROUP BY resource, activity ORDER BY resource, count DESC;
SELECT activity, resource, COUNT(*) AS count FROM events_log GROUP BY activity, resource ORDER BY activity, count DESC;
SELECT COUNT(*) AS "Number of Actions", resource FROM events_log GROUP BY resource;
SELECT COUNT(DISTINCT idcase) AS "Number of Cases", activity AS "Activity" FROM events_log GROUP BY activity;
SELECT DISTINCT activity FROM event_log WHERE timestamp BETWEEN '2018-01-01' AND '2018-07-01';
SELECT DISTINCT activity FROM event_log WHERE timestamp BETWEEN '2018-01-01' AND '2018-07-01';
SELECT activity FROM event_log WHERE timestamp BETWEEN '2018-01-01' AND '2018-06-30' GROUP BY activity
SELECT activity, COUNT(*) AS count FROM events_log WHERE timestamp BETWEEN '2018-01-01' AND '2018-07-31' GROUP BY activity HAVING COUNT(*) > 1;
SELECT DISTINCT activity FROM event_log WHERE timestamp BETWEEN '2018-01-01' AND '2018-07-01';
SELECT DISTINCT activity FROM event_log WHERE timestamp BETWEEN '2018-01-01' AND '2018-07-01';
SELECT activity, COUNT(DISTINCT idcase) FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log GROUP BY idcase HAVING strftime('%Y-%m-%d', MAX(timestamp)) = '2018-03-12' ) GROUP BY activity;
SELECT resource, COUNT(*) AS activity_count FROM events_log GROUP BY resource ORDER BY resource;
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Wayne' ORDER BY idcase;
SELECT resource, COUNT(*) AS event_count FROM events_log GROUP BY resource ORDER BY event_count DESC;
SELECT DISTINCT idcase FROM event_log WHERE resource = 'Wayne' ORDER BY idcase;
SELECT DISTINCT idcase FROM events_log WHERE resource = 'Wayne' ORDER BY idcase
SELECT idcase FROM event_log WHERE resource = 'Wayne' GROUP BY idcase ORDER BY idcase
SELECT DISTINCT idcase FROM event_log WHERE resource = 'Wayne' ORDER BY idcase
SELECT DISTINCT idcase FROM event_log WHERE resource = 'Wayne' ORDER BY idcase;
SELECT DISTINCT idcase FROM event_log WHERE resource = 'Wayne' ORDER BY idcase
SELECT DISTINCT idcase FROM events_log WHERE activity LIKE '%Wayne%' ORDER BY idcase;
SELECT activity, COUNT(DISTINCT idcase) FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log WHERE timestamp = ( SELECT MAX(timestamp) FROM event_log WHERE idcase = event_log.idcase ) AND timestamp BETWEEN '2018-03-12 00:00:00' AND '2018-03-12 23:59:59' ) GROUP BY activity
SELECT COUNT(DISTINCT idcase) AS "Number of Process Instances", activity FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log WHERE activity = 'End' AND timestamp <= '2018-03-12' ) GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS num_cases FROM event_log WHERE timestamp >= '2018-03-02' AND timestamp < '2018-03-03' GROUP BY activity ORDER BY num_cases DESC;
SELECT activity, COUNT(DISTINCT idcase) AS num_cases FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log WHERE activity = 'End trip' AND timestamp BETWEEN '2016-01-01' AND '2018-01-01' ) GROUP BY activity ORDER BY num_cases DESC;
SELECT activity, COUNT(DISTINCT idcase) FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING MAX(timestamp) = '2018-03-02' ) GROUP BY activity
SELECT activity, COUNT(DISTINCT idcase) AS num_cases FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log WHERE timestamp BETWEEN '2018-03-02 00:00:00' AND '2018-03-02 23:59:59' ) GROUP BY activity ORDER BY num_cases DESC;
SELECT COUNT(DISTINCT idcase), activity FROM event_log WHERE timestamp < '2018-03-02' GROUP BY activity
SELECT COUNT(*), activity FROM events_log WHERE timestamp BETWEEN '2018-03-02 00:00:00' AND '2018-03-02 23:59:59' GROUP BY activity
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity LIKE 'Permit%' AND idcase IN ( SELECT idcase FROM event_log WHERE activity LIKE 'Permit%' ORDER BY timestamp ASC LIMIT 1 );
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity LIKE 'Permit%';
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity IN ( SELECT activity FROM event_log WHERE activity LIKE 'Permit%' );
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity LIKE 'Permit%' AND id IN ( SELECT MIN(id) FROM event_log GROUP BY idcase );
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity LIKE 'Permit%' AND id IN ( SELECT MIN(id) FROM event_log GROUP BY idcase );
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity LIKE 'Permit%' AND id IN ( SELECT MIN(id) FROM event_log GROUP BY idcase );
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity LIKE 'Permit%' AND activity LIKE '%Start%';
SELECT COUNT(*) FROM event_log WHERE activity LIKE '%permit%' AND id IN (SELECT id FROM event_log WHERE activity = 'Start trip')
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'permit' AND resource LIKE '%travel declaration%' AND timestamp IN ( SELECT MIN(timestamp) FROM event_log WHERE idcase = event_log.idcase );
SELECT DISTINCT idcase FROM event_log WHERE activity NOT IN ('Request payment', 'Payment handled')
SELECT DISTINCT idcase FROM events_log WHERE activity NOT IN ('Request payment', 'Payment handled')
SELECT DISTINCT idcase FROM event_log WHERE activity NOT IN ('Request payment', 'Payment handled')
SELECT idcase FROM event_log WHERE activity NOT IN ('Request payment', 'Payment handled') GROUP BY idcase HAVING COUNT(DISTINCT activity) = 2;
SELECT DISTINCT idcase FROM event_log WHERE idcase NOT IN ( SELECT DISTINCT idcase FROM event_log WHERE activity IN ('Request payment', 'Payment handled') );
SELECT DISTINCT idcase FROM events_log WHERE activity NOT IN ('Request payment', 'Payment handled')
SELECT idcase from events_log WHERE activity = 'Start trip' OR activity = 'End trip' EXCEPT SELECT idcase from events_log WHERE activity = 'Request payment' INTERSECT SELECT idcase from events_log WHERE activity = 'Payment handled'
SELECT idcase FROM event_log WHERE activity NOT IN ('Request payment', 'Payment handled') GROUP BY idcase HAVING COUNT(*) = ( SELECT COUNT(*) FROM event_log WHERE activity IN ('Request payment', 'Payment handled') GROUP BY idcase );
SELECT DISTINCT idcase FROM event_log WHERE idcase NOT IN ( SELECT DISTINCT idcase FROM event_log WHERE activity IN ('Request payment', 'Payment handled') );
SELECT DISTINCT idcase FROM events_log WHERE activity NOT IN ('Request payment', 'Payment handled')
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE idcase NOT IN ( SELECT DISTINCT idcase FROM events_log where activity IN ('Payment handled', 'Payment request') )
SELECT DISTINCT idcase FROM events_log WHERE activity IN ('Request payment', 'Payment made') AND NOT EXISTS ( SELECT 1 FROM events_log WHERE activity = 'Payment made' AND idcase = events_log.idcase );
SELECT timestamp, activity, resource FROM event_log WHERE activity IN ('Start trip', 'Declaration submitted by employee') ORDER BY timestamp, resource;
SELECT * FROM event_log WHERE activity = 'Start trip' OR activity = 'Declaration submitted by employee' ORDER BY timestamp ASC, resource ASC;
SELECT * FROM event_log WHERE activity IN ('Start trip', 'Declaration submitted by employee') ORDER BY timestamp ASC, resource ASC;
SELECT timestamp, activity, resource FROM event_log WHERE activity IN ('Start trip', 'Declaration submitted by employee') ORDER BY timestamp, resource;
SELECT timestamp, activity, resource FROM event_log WHERE activity IN ('Start trip', 'Declaration submitted by employee') ORDER BY timestamp ASC, resource ASC;
SELECT timestamp, resource FROM event_log WHERE activity = 'Start trip' OR activity = 'Declaration submitted by employee' ORDER BY timestamp ASC, resource ASC;
SELECT timestamp, resource FROM event_log WHERE activity = 'Start trip' OR activity = 'Declaration submitted by employee' ORDER BY timestamp, resource;
SELECT timestamp, resource FROM event_log WHERE activity = 'Start trip' OR activity = 'Declaration submitted by employee' ORDER BY timestamp, resource;
SELECT * FROM events_log WHERE activity IN ('Start trip', 'Declaration submitted by employee') ORDER BY timestamp, resource;
SELECT e1.id, e1.activity, e1.timestamp, e1.resource, e1.cost, e1.idcase, e2.resource AS employee_name FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e1.activity IN ('Initiate travel', 'Request declaration') ORDER BY e1.timestamp, e2.resource;
SELECT e1.id, e1.activity, e1.timestamp, e1.resource, e1.cost, e1.idcase, e2.resource AS employee_name FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e1.activity IN ('Start trip', 'Request from employee') ORDER BY e1.timestamp ASC, e2.resource ASC;
SELECT resource, COUNT(*) AS count FROM event_log WHERE activity = 'Payment handled' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) AS num_payment_handled FROM event_log WHERE activity = 'Payment handled' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) AS num_payment_handled FROM event_log WHERE activity = 'Payment handled' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) AS num_payments_handled FROM event_log WHERE activity = 'Payment handled' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) AS num_occurrences FROM event_log WHERE activity = 'Payment handled' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) AS count_payment_handled FROM event_log WHERE activity = 'Payment handled' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) AS count FROM event_log WHERE activity = 'Payment handled' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT(*) AS num_associations FROM event_log WHERE activity = 'Payment handled' GROUP BY resource ORDER BY num_associations DESC;
SELECT resource, COUNT(DISTINCT idcase) AS count_payment_handled FROM events_log WHERE activity = 'Payment handled' GROUP BY resource ORDER BY resource;
SELECT resource, COUNT (*) AS payment_count FROM events_log WHERE activity = 'Payment handled' GROUP BY resource ORDER BY resource
SELECT resource, COUNT(*) AS count FROM event_log WHERE activity = 'PAYMENT' GROUP BY resource ORDER BY resource;
SELECT activity, COUNT(DISTINCT idcase) AS case_count FROM event_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS num_cases FROM event_log GROUP BY activity;
SELECT COUNT(DISTINCT idcase), activity FROM event_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS num_instances FROM event_log GROUP BY activity ORDER BY num_instances DESC;
SELECT activity, count(DISTINCT idcase) FROM event_log GROUP BY activity
SELECT COUNT(DISTINCT idcase), activity FROM event_log GROUP BY activity;
SELECT COUNT(DISTINCT idcase), activity FROM event_log GROUP BY activity;
SELECT COUNT(DISTINCT idcase), activity FROM events_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS num_declarations FROM event_log GROUP BY activity;
SELECT COUNT(DISTINCT activity), resource FROM events_log GROUP BY resource
SELECT resource, COUNT(DISTINCT activity) AS num_activities FROM event_log GROUP BY resource;
SELECT resource,COUNT(DISTINCT activity) FROM events_log GROUP BY resource
SELECT resource, count(DISTINCT activity) FROM events_log group by resource
SELECT resource, COUNT(DISTINCT activity) AS num_activities FROM event_log GROUP BY resource;
SELECT COUNT(DISTINCT activity), resource FROM event_log GROUP BY resource
SELECT COUNT(DISTINCT activity), resource FROM event_log GROUP BY resource;
SELECT resource, COUNT (DISTINCT activity) FROM events_log WHERE activity LIKE '%travel declaration%' GROUP BY resource
SELECT resource, COUNT (DISTINCT activity) FROM events_log GROUP BY resource
SELECT COUNT(*) AS "Number of Occurrences", resource FROM event_log WHERE activity IN ('end trip', 'payment handled') GROUP BY resource;
SELECT COUNT(*) AS "Number of Final Activities", resource FROM event_log WHERE activity IN ('end trip', 'payment handled') GROUP BY resource;
SELECT resource, COUNT(*) AS num_occurrences FROM event_log WHERE activity IN ('End trip', 'Payment handled') GROUP BY resource ORDER BY num_occurrences DESC;
SELECT resource, COUNT(DISTINCT activity) AS num_activities FROM events_log WHERE activity IN ('end trip', 'payment handled') GROUP BY resource;
SELECT COUNT(*) AS "Number of Times", resource FROM event_log WHERE activity IN ('end trip', 'payment handled') GROUP BY resource;
SELECT COUNT(*), resource FROM events_log WHERE activity IN ('End trip', 'Payment handled') GROUP BY resource;
SELECT COUNT(DISTINCT id) AS "Number of Completed Declarations" FROM event_log WHERE activity IN ('End of Trip', 'Payment') GROUP BY resource
SELECT COUNT(*) AS "Completion Activities", resource FROM events_log WHERE activity IN ('End trip', 'Make payment') GROUP BY resource;
SELECT resource, COUNT(*) AS count FROM ( SELECT resource, idcase, ROW_NUMBER() OVER (PARTITION BY idcase ORDER BY timestamp) AS row_num FROM event_log WHERE activity = 'Declaration rejected by pre-approver' ) AS subquery WHERE row_num = 1 GROUP BY resource
SELECT resource, COUNT(*) AS count FROM ( SELECT resource, activity, MIN(timestamp) AS first_occurrence FROM event_log WHERE activity = 'Declaration rejected by pre-approver' GROUP BY resource, activity ) GROUP BY resource ORDER BY count DESC;
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Declaration rejected by pre-approver' AND row_number() OVER (PARTITION BY idcase ORDER BY timestamp) = 1;
SELECT COUNT(*), resource, idcase FROM events_log WHERE activity = 'Declaration rejected by administration' GROUP BY idcase, resource
SELECT resource, COUNT(*) AS count FROM ( SELECT resource, activity, ROW_NUMBER() OVER (PARTITION BY idcase ORDER BY timestamp) AS row_num FROM event_log WHERE activity = 'Declaration rejected by pre-approver' ) AS subquery WHERE row_num = 1 GROUP BY resource;
SELECT e.employee_id, e.employee_name, COUNT(el.id) AS num_rejections FROM employees AS e JOIN events_log AS el ON e.employee_id = el.pre_approver_id WHERE el.activity = 'Declaration rejected by pre-approver' GROUP BY e.employee_id, e.employee_name ORDER BY num_rejections DESC;
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Declaration rejected' AND resource IN ( SELECT resource FROM event_log WHERE activity = 'Declaration submitted' AND resource IN ( SELECT resource FROM event_log WHERE activity = 'Declaration pre-approved' ) );
SELECT idcase, COUNT(*) AS activity_count FROM events_log WHERE activity <> 'End trip' GROUP BY idcase
SELECT idcase, COUNT(*) AS activity_occurrences FROM event_log WHERE activity <> 'End trip' GROUP BY idcase;
SELECT idcase, COUNT(*) AS num_activities FROM event_log WHERE activity <> 'End trip' GROUP BY idcase;
SELECT idcase, COUNT(*) AS event_count FROM event_log WHERE activity <> 'End trip' GROUP BY idcase
SELECT idcase, COUNT(*) AS activity_occurrences FROM event_log WHERE activity <> 'End trip' GROUP BY idcase
SELECT idcase, COUNT(*) AS activity_occurrences FROM event_log WHERE activity = 'End trip' GROUP BY idcase;
SELECT idcase, COUNT(*) AS event_count FROM event_log WHERE activity = 'End trip' GROUP BY idcase;
SELECT COUNT(*) FROM event_log WHERE activity != 'End trip' GROUP BY idcase;
SELECT COUNT(*) FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log WHERE activity = 'End trip' )
SELECT count(DISTINCT idcase), activity FROM events_log WHERE activity LIKE '%end of trip%' GROUP BY activity
SELECT COUNT(*) AS "Number of Actions", idcase FROM events_log WHERE activity LIKE '%end of trip%' GROUP BY idcase;
SELECT DISTINCT activity FROM event_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2018-01-01' AND '2018-07-01';
SELECT activity FROM events_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2018-01-01' AND '2018-07-01' GROUP BY activity
SELECT activity FROM event_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2018-01-01' AND '2018-06-30'
SELECT DISTINCT activity FROM event_log WHERE timestamp BETWEEN '2018-01-01' AND '2018-07-01' AND resource = 'Thomas';
SELECT DISTINCT activity FROM event_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2018-01-01' AND '2018-07-31';
SELECT activity FROM event_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2018-01-01' AND '2018-07-31';
SELECT DISTINCT activity FROM events_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2018-01-01' AND '2018-07-01';
SELECT DISTINCT activity FROM events_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2018-01-01' AND '2018-06-30'
SELECT activity FROM event_log WHERE resource = 'Thomas' AND timestamp BETWEEN '2018-01-01' AND '2018-06-30';
SELECT idcase FROM events_log WHERE activity = 'Declaration rejected by supervisor' ORDER BY timestamp ASC;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Declaration rejected by supervisor' ORDER BY timestamp ASC;
SELECT idcase FROM events_log WHERE activity = 'Declaration rejected by supervisor' ORDER BY timestamp
SELECT idcase FROM events_log WHERE activity = 'Declaration rejected by supervisor' ORDER BY timestamp ASC;
SELECT idcase FROM events_log WHERE activity = 'Declaration rejected by supervisor' ORDER BY timestamp
SELECT idcase FROM events_log WHERE activity = 'Declaration rejected by supervisor' ORDER BY timestamp ASC;
SELECT idcase FROM events_log WHERE activity = 'Declaration rejected by supervisor' ORDER BY timestamp ASC;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Declaration rejected by supervisor' ORDER BY timestamp ASC;
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Rejection' AND resource = 'Supervisor' ORDER BY timestamp
SELECT idcase FROM events_log WHERE activity = 'Declaration rejected by supervisor' ORDER BY timestamp
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Start trip' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'End trip' AND timestamp < '2018-03-01' );
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Start trip' AND idcase NOT IN ( SELECT DISTINCT idcase FROM events_log WHERE activity = 'End trip' AND timestamp < '2018-03-01' );
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Start trip' AND idcase NOT IN ( SELECT DISTINCT idcase FROM events_log WHERE activity = 'End trip' AND timestamp < '2018-03-01' );
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Start trip' AND idcase NOT IN ( SELECT DISTINCT idcase FROM events_log WHERE activity = 'End trip' AND timestamp <= '2018-03-31' );
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Start trip' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'End trip' AND timestamp <= '2018-03-31' );
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Start trip' AND idcase NOT IN ( SELECT DISTINCT idcase FROM events_log WHERE activity = 'End trip' AND timestamp <= '2018-03-31' );
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Start trip' AND idcase NOT IN ( SELECT DISTINCT idcase FROM events_log WHERE activity = 'End trip' AND timestamp <= '2018-03-31' );
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Start trip' AND idcase NOT IN ( SELECT DISTINCT idcase FROM events_log WHERE activity = 'End trip' AND timestamp <= '2018-03-31' );
SELECT DISTINCT idcase FROM events_log WHERE activity = 'Start trip' AND idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'End trip' AND timestamp <= '2018-03-31' );
SELECT DISTINCT idcase FROM event_log WHERE activity = 'Start trip' AND idcase NOT IN ( SELECT idcase FROM event_log WHERE activity = 'Finalize declaration' AND timestamp <= '2018-03-31' );
SELECT DISTINCT idcase FROM event_log WHERE activity = 'Start trip' AND idcase NOT IN ( SELECT DISTINCT idcase FROM event_log WHERE activity = 'End trip' AND timestamp <= '2018-03-31' );
SELECT idcase FROM event_log WHERE activity = 'End trip' AND idcase NOT IN ( SELECT idcase FROM event_log WHERE activity = 'Request payment' OR activity = 'Payment handled' ) AND resource IN ( SELECT resource FROM event_log WHERE activity = 'End trip' GROUP BY resource HAVING COUNT(*) > 1 )
SELECT idcase FROM event_log WHERE activity = 'End trip' EXCEPT SELECT idcase FROM event_log WHERE activity = 'Request payment' INTERSECT SELECT idcase FROM event_log WHERE activity = 'Payment handled' AND idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT resource) > 1 );
SELECT idcase FROM event_log WHERE activity = 'End trip' AND NOT activity = 'Request payment' AND NOT activity = 'Payment handled' GROUP BY idcase HAVING COUNT(DISTINCT resource) > 1
SELECT idcase FROM event_log WHERE activity = 'End trip' AND resource IN ( SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 1 ) AND idcase NOT IN ( SELECT idcase FROM event_log WHERE activity IN ('Request payment', 'Payment handled') );
SELECT idcase FROM event_log WHERE activity = 'End trip' GROUP BY idcase HAVING COUNT(DISTINCT resource) > 1 EXCEPT SELECT idcase FROM event_log WHERE activity = 'Request payment' UNION SELECT idcase FROM event_log WHERE activity = 'Payment handled';
SELECT resource FROM event_log WHERE activity = 'End trip' AND NOT EXISTS ( SELECT 1 FROM event_log WHERE activity = 'Request payment' OR activity = 'Payment handled' ) AND EXISTS ( SELECT 1 FROM event_log WHERE activity = 'End trip' AND resource <> '' ) GROUP BY resource HAVING COUNT(*) > 1
SELECT DISTINCT idcase FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT resource) > 1 ) AND idcase IN ( SELECT idcase FROM event_log WHERE activity = 'End trip' ) AND idcase NOT IN ( SELECT idcase FROM event_log WHERE activity = 'Request payment' OR activity = 'Payment handled' );
SELECT idcase FROM event_log WHERE activity='Declaration finalized' AND idcase NOT IN ( SELECT idcase FROM event_log WHERE activity='Payment handled' )
SELECT idcase FROM events_log WHERE activity = 'End trip' EXCEPT SELECT idcase FROM events_log WHERE activity = 'Request payment' UNION SELECT idcase FROM events_log WHERE activity = 'Payment handled';
SELECT idcase, count(distinct resource) AS num_resources, sum(cost) AS total_cost FROM event_log GROUP BY idcase;
SELECT idcase, count(distinct resource) AS num_resources, sum(cost) AS total_cost FROM event_log GROUP BY idcase;
SELECT idcase, count(distinct resource) AS num_resources, sum(cost) AS total_cost FROM event_log GROUP BY idcase;
SELECT idcase, count(distinct resource) AS num_resources, sum(cost) AS total_cost FROM event_log GROUP BY idcase;
SELECT idcase, count(distinct resource), sum(cost) FROM events_log group by idcase
SELECT idcase, SUM(cost) AS total_cost, COUNT(DISTINCT resource) AS num_resources FROM event_log GROUP BY idcase;
SELECT idcase, SUM(cost) AS total_cost, COUNT(DISTINCT resource) AS num_resources FROM event_log GROUP BY idcase;
SELECT idcase, SUM(cost) AS total_cost, COUNT(DISTINCT resource) AS num_resources FROM event_log GROUP BY idcase;
SELECT idcase, SUM(cost) AS total_cost, COUNT(DISTINCT resource) AS num_resources FROM event_log GROUP BY idcase;
SELECT idcase, COUNT(DISTINCT resource) AS num_people, SUM(cost) AS total_cost FROM events_log GROUP BY idcase;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT CASE WHEN activity LIKE 'Permit%' THEN activity ELSE NULL END) > 1;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT CASE WHEN activity LIKE 'Permit%' THEN activity ELSE NULL END) > 1;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT CASE WHEN activity LIKE 'Permit%' THEN activity ELSE NULL END) >= 2;
SELECT idcase FROM event_log WHERE activity LIKE 'Permit%' GROUP BY idcase HAVING COUNT(*) > 1;
SELECT idcase FROM event_log WHERE activity LIKE 'Permit%' GROUP BY idcase HAVING COUNT(*) > 1;
SELECT idcase FROM event_log WHERE activity LIKE 'Permit%' GROUP BY idcase HAVING COUNT(*) > 1;
SELECT idcase FROM event_log WHERE activity LIKE 'Permit%' GROUP BY idcase HAVING COUNT(*) > 1;
SELECT idcase FROM event_log WHERE activity LIKE 'Permit%' GROUP BY idcase HAVING COUNT(*) > 1;
SELECT DISTINCT e1.idcase FROM event_log e1 JOIN event_log e2 ON e1.idcase = e2.idcase WHERE e1.activity LIKE '%permit%' AND e2.activity LIKE '%declaration%';
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 1 AND activity LIKE 'Permit%'
SELECT id FROM event_log ORDER BY timestamp DESC LIMIT 1
SELECT activity, timestamp, id FROM events_log ORDER BY timestamp;
SELECT id FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase ORDER BY timestamp DESC ) ORDER BY timestamp;
SELECT idcase, MAX(timestamp) AS last_event_timestamp FROM events_log GROUP BY idcase ORDER BY last_event_timestamp DESC;
SELECT id FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase ORDER BY MAX(timestamp) ) ORDER BY timestamp;
SELECT idcase, MAX(id) AS last_event_id FROM event_log GROUP BY idcase ORDER BY timestamp DESC;
SELECT id FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase ORDER BY timestamp DESC ) ORDER BY timestamp DESC;
SELECT id, activity, timestamp, resource, cost, idcase FROM event_log WHERE id IN ( SELECT MAX(id) FROM event_log GROUP BY idcase );
SELECT id, activity, timestamp, resource, cost, idcase FROM event_log WHERE id IN ( SELECT MAX(id) FROM event_log GROUP BY idcase );
SELECT activity FROM event_log GROUP BY activity HAVING count(*) >= 100
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity FROM event_log GROUP BY activity HAVING count(*) >= 100
SELECT activity FROM events_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity, COUNT(*) AS occurrence_count FROM event_log GROUP BY activity HAVING occurrence_count > 100;
SELECT activity, COUNT(*) AS count FROM event_log GROUP BY activity HAVING count > 100 ORDER BY count DESC;
SELECT activity FROM event_log GROUP BY activity HAVING count(*) > 100
SELECT activity, COUNT(*) AS count FROM event_log WHERE activity LIKE '%processing declarations%' GROUP BY activity HAVING count > 100;
SELECT CASE WHEN activity LIKE '%funcionrio%' THEN 'funcionrio' WHEN activity LIKE '%supervisor%' THEN 'supervisor' WHEN activity LIKE '%administrao%' THEN 'administrao' WHEN activity LIKE '%pr-aprovador%' THEN 'pr-aprovador' WHEN activity LIKE '%responsvel pelo oramento%' THEN 'responsvel pelo oramento' WHEN activity LIKE '%diretor%' THEN 'diretor' END AS grupo, COUNT(*) AS quantidade FROM event_log GROUP BY grupo ORDER BY quantidade DESC;
SELECT CASE WHEN activity LIKE '%funcionrio%' THEN 'funcionrio' WHEN activity LIKE '%supervisor%' THEN 'supervisor' WHEN activity LIKE '%administrao%' THEN 'administrao' WHEN activity LIKE '%pr-aprovador%' THEN 'pr-aprovador' WHEN activity LIKE '%responsvel pelo oramento%' THEN 'responsvel pelo oramento' WHEN activity LIKE '%diretor%' THEN 'diretor' END AS grupo, COUNT(*) AS quantidade FROM event_log GROUP BY grupo ORDER BY quantidade DESC;
SELECT CASE WHEN activity LIKE '%funcionrio%' THEN 'funcionrio' WHEN activity LIKE '%supervisor%' THEN 'supervisor' WHEN activity LIKE '%administrao%' THEN 'administrao' WHEN activity LIKE '%pr-aprovador%' THEN 'pr-aprovador' WHEN activity LIKE '%responsvel pelo oramento%' THEN 'responsvel pelo oramento' WHEN activity LIKE '%diretor%' THEN 'diretor' ELSE 'outros' END AS grupo, COUNT(*) AS quantidade FROM event_log GROUP BY grupo ORDER BY quantidade DESC;
SELECT CASE WHEN activity LIKE '%funcionrio%' THEN 'funcionrio' WHEN activity LIKE '%supervisor%' THEN 'supervisor' WHEN activity LIKE '%administrao%' THEN 'administrao' WHEN activity LIKE '%pr-aprovador%' THEN 'pr-aprovador' WHEN activity LIKE '%responsvel pelo oramento%' THEN 'responsvel pelo oramento' WHEN activity LIKE '%diretor%' THEN 'diretor' END AS grupo, COUNT(DISTINCT idcase) AS num_casos FROM event_log GROUP BY grupo ORDER BY num_casos DESC;
SELECT CASE WHEN activity LIKE '%funcionrio%' THEN 'funcionrio' WHEN activity LIKE '%supervisor%' THEN 'supervisor' WHEN activity LIKE '%administrao%' THEN 'administrao' WHEN activity LIKE '%pr-aprovador%' THEN 'pr-aprovador' WHEN activity LIKE '%responsvel pelo oramento%' THEN 'responsvel pelo oramento' WHEN activity LIKE '%diretor%' THEN 'diretor' END AS grupo, COUNT(*) AS quantidade FROM event_log GROUP BY grupo ORDER BY quantidade DESC;
SELECT activity, COUNT(*) AS count FROM event_log WHERE resource IN ( SELECT resource FROM event_log WHERE activity = 'Declaration final approved by supervisor' ) GROUP BY activity ORDER BY count DESC;
SELECT activity, COUNT(DISTINCT idcase) AS num_cases FROM events_log WHERE activity LIKE '%employee%' GROUP BY activity ORDER BY num_cases DESC;
SELECT activity, COUNT(DISTINCT idcase) AS total_cases FROM events_log WHERE activity LIKE '%funcionrio%' OR activity LIKE '%supervisor%' OR activity LIKE '%administrao%' OR activity LIKE '%pr-aprovador%' OR activity LIKE '%responsvel pelo oramento%' OR activity LIKE '%diretor%' GROUP BY activity ORDER BY total_cases DESC;
SELECT DISTINCT idcase FROM event_log WHERE activity = 'End trip' AND EXISTS ( SELECT 1 FROM event_log WHERE idcase = event_log.idcase AND timestamp > event_log.timestamp );
SELECT e1.idcase FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' AND e1.timestamp > e2.timestamp;
SELECT e1.id, e1.activity, e1.resource, e1.timestamp, e1.cost, e1.idcase FROM event_log AS e1 INNER JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' AND e1.timestamp > e2.timestamp;
SELECT e1.idcase FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'End trip' AND e1.timestamp > e2.timestamp;
SELECT DISTINCT idcase FROM events_log WHERE timestamp > ( SELECT MAX(timestamp) FROM events_log WHERE activity = 'End trip' AND idcase = events_log.idcase );
SELECT idcase FROM events_log WHERE activity = 'End trip' AND timestamp > ( SELECT MAX(timestamp) FROM events_log WHERE activity = 'Start trip' AND idcase = events_log.idcase );
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Send reminder' AND timestamp = ( SELECT MAX(timestamp) FROM event_log WHERE idcase = event_log.idcase );
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Send reminder' AND timestamp = ( SELECT MAX(timestamp) FROM event_log WHERE idcase = event_log.idcase );
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Send reminder' AND id IN ( SELECT MAX(id) FROM event_log GROUP BY idcase );
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Send reminder' AND id IN ( SELECT MAX(id) FROM event_log GROUP BY idcase );
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'Send reminder' AND timestamp = ( SELECT MAX(timestamp) FROM event_log WHERE idcase = event_log.idcase );
SELECT COUNT(*) FROM event_log WHERE activity = 'Send reminder' AND resource = 'Declaration';
SELECT resource FROM event_log WHERE timestamp >= '2018-03-31 00:00:00' AND timestamp <= '2018-03-31 23:59:59' AND activity = 'Not Working' GROUP BY resource
SELECT resource FROM event_log WHERE timestamp = '2018-03-31' EXCEPT SELECT resource FROM event_log WHERE timestamp = '2018-03-31' AND resource IS NOT NULL;
SELECT resource FROM event_log WHERE timestamp NOT IN ( SELECT timestamp FROM event_log WHERE DATE(timestamp) = '2018-03-31' );
SELECT resource FROM event_log WHERE timestamp >= '2018-03-31 00:00:00' AND timestamp <= '2018-03-31 23:59:59' AND activity = 'Idle' GROUP BY resource HAVING COUNT(*) >= 1;
SELECT resource FROM events_log WHERE activity = 'Idle' AND timestamp BETWEEN '2018-03-31 00:00:00' AND '2018-03-31 23:59:59'
SELECT resource FROM events_log WHERE timestamp BETWEEN '2018-03-31 00:00:00' AND '2018-03-31 23:59:59' GROUP BY resource HAVING COUNT(DISTINCT idcase) = 0;
SELECT activity, COUNT(DISTINCT id) AS num_events FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log WHERE timestamp BETWEEN '2018-12-01' AND '2018-12-05' ) GROUP BY activity ORDER BY num_events DESC;
SELECT activity, COUNT(DISTINCT idcase) AS frequency FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING MAX(timestamp) BETWEEN '2018-12-01' AND '2018-12-05' ) GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS frequency FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING MAX(timestamp) BETWEEN '2018-12-01' AND '2018-12-05' ) GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS performance_frequency FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log WHERE timestamp BETWEEN '2018-12-01' AND '2018-12-05' ) GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS activity_count FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING MAX(timestamp) BETWEEN '2018-12-01' AND '2018-12-05' ) GROUP BY activity;
SELECT activity, COUNT(DISTINCT idcase) AS frequency FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log GROUP BY idcase HAVING MAX(timestamp) BETWEEN '2018-12-01' AND '2018-12-05' ) GROUP BY activity;
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity <> 'Payment handled'
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE idcase NOT IN (SELECT idcase FROM events_log WHERE activity = 'Payment handled')
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'Payment handled' AND cost IS NULL;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity <> 'Payment handled'
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity = 'Payment handled' AND cost IS NULL;
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE activity NOT IN ('Request payment', 'Payment handled');
SELECT COUNT(DISTINCT idcase) FROM events_log WHERE idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'Payment handled' );
SELECT DISTINCT idcase FROM events_log WHERE idcase NOT IN ( SELECT idcase FROM events_log WHERE activity = 'Payment handled' );
SELECT COUNT(DISTINCT resource), activity FROM event_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT resource) AS num_distinct_resources FROM event_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT resource) AS num_resources FROM event_log GROUP BY activity;
SELECT activity, COUNT(DISTINCT resource) AS num_resources FROM event_log GROUP BY activity;
SELECT COUNT(DISTINCT resource), activity FROM event_log GROUP BY activity;
SELECT COUNT(DISTINCT resource) FROM events_log WHERE activity LIKE '%declaration%';
SELECT DISTINCT e1.activity FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e2.activity = 'Send reminder' AND e1.timestamp < e2.timestamp ORDER BY e1.timestamp;
SELECT activity, timestamp, resource FROM event_log WHERE idcase = '1' AND timestamp < ( SELECT timestamp FROM event_log WHERE activity = 'Send reminder' AND idcase = '1' ) ORDER BY timestamp;
SELECT DISTINCT activity FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log WHERE activity = 'Send reminder' ) AND timestamp < ( SELECT timestamp FROM event_log WHERE activity = 'Send reminder' ) ORDER BY timestamp;
SELECT COUNT(*) AS num_events, idcase FROM events_log GROUP BY idcase ORDER BY num_events DESC;
SELECT count(*) AS event_count, idcase, (SELECT count(*) FROM events_log WHERE event_count = count(*)) AS case_count FROM events_log GROUP BY idcase
SELECT count(*) AS "Number of Events", idcase FROM events_log GROUP BY idcase ORDER BY "Number of Events" DESC;
SELECT count(*) AS "Number of Cases", COUNT(DISTINCT idcase) AS "Number of Distinct Cases" FROM events_log GROUP BY count(*)
SELECT DISTINCT activity FROM events_log GROUP BY activity, idcase HAVING count(activity) > 3 This query will return all the distinct activities that were performed more than three times in each declaration. SELECT COUNT(DISTINCT activity) AS num_activities, COUNT(*) AS num_declarations FROM events_log GROUP BY idcase This query will count the number of distinct activities performed in each declaration and then count the number of declarations that have the same number of events performed.
SELECT AVG (SUM (cost)) FROM events_log GROUP BY idcase
SELECT AVG (SUM (cost)) FROM events_log GROUP BY idcase
SELECT AVG (SUM (cost)) FROM events_log GROUP BY idcase
SELECT AVG (SUM (cost)) FROM events_log GROUP BY idcase
SELECT AVG (SUM (cost)) FROM event_log GROUP BY idcase
SELECT AVG(cost) FROM events_log WHERE activity = 'declaration';
SELECT resource, AVG(cost) AS mean_cost FROM event_log GROUP BY resource;
SELECT resource, AVG(cost) from events_log group by resource
SELECT resource, AVG(cost) AS mean_cost FROM event_log GROUP BY resource;
SELECT resource, AVG(cost) FROM event_log GROUP BY resource;
SELECT resource, AVG(cost) AS average_cost FROM event_log GROUP BY resource;
SELECT AVG(el.cost) AS mean_cost FROM event_log AS el JOIN employee AS e ON el.idcase = e.idcase GROUP BY e.idcase;
SELECT resource FROM event_log GROUP BY resource ORDER BY COUNT(*) DESC LIMIT 10;
SELECT resource FROM event_log GROUP BY resource ORDER BY COUNT(*) DESC LIMIT 10;
SELECT resource FROM event_log GROUP BY resource ORDER BY COUNT(*) DESC LIMIT 10;
SELECT resource FROM event_log GROUP BY resource ORDER BY COUNT(*) DESC LIMIT 10;
SELECT resource, COUNT(*) AS event_count FROM event_log GROUP BY resource ORDER BY event_count DESC LIMIT 10;
SELECT resource FROM events_log GROUP BY resource ORDER BY COUNT(DISTINCT idcase) DESC LIMIT 10;
SELECT strftime('%Y-%m-%d', timestamp) AS day, COUNT(*) AS event_count FROM event_log GROUP BY day ORDER BY day;
SELECT activity, DATE(timestamp) AS date, COUNT(*) AS occurrences FROM event_log GROUP BY activity, date ORDER BY date, occurrences DESC;
SELECT count (*), date(timestamp) FROM events_log group by date(timestamp)
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT resource) > 1 AND MIN(timestamp) OVER (PARTITION BY idcase, activity ORDER BY timestamp) != MAX(timestamp) OVER (PARTITION BY idcase, activity ORDER BY timestamp);
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT resource) = 1;
SELECT resource, activity, COUNT(*) AS count FROM events_log GROUP BY resource, activity ORDER BY count DESC;
SELECT idcase, COUNT(*) AS event_count FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log WHERE activity = 'Declaration final approved by director' ) GROUP BY idcase;
SELECT idcase, COUNT(*) AS num_preceding_events FROM events_log WHERE idcase IN ( SELECT idcase FROM events_log WHERE activity = 'Declaration final approved by director' ) GROUP BY idcase;
SELECT COUNT(*) AS num_interventions, idcase FROM event_log WHERE activity = 'Intervention' AND idcase IN ( SELECT idcase FROM event_log WHERE activity = 'Final approval from the director' ) GROUP BY idcase;
SELECT event_log1.timestamp AS permit_submitted_timestamp, event_log2.timestamp AS permit_approved_timestamp, ( event_log2.timestamp - event_log1.timestamp ) AS time_between_activities FROM event_log AS event_log1 JOIN event_log AS event_log2 ON event_log1.idcase = event_log2.idcase WHERE event_log1.activity = 'Permit submitted by employee' AND event_log2.activity = 'Permit approved by administration';
SELECT event_log1.timestamp AS permit_submitted_timestamp, event_log2.timestamp AS permit_approved_timestamp, ( event_log2.timestamp - event_log1.timestamp ) AS time_interval FROM event_log AS event_log1 JOIN event_log AS event_log2 ON event_log1.idcase = event_log2.idcase WHERE event_log1.activity = 'Permit submitted by employee' AND event_log2.activity = 'Permit approved by administration';
SELECT strftime('%s', e.timestamp) - strftime('%s', p.timestamp) AS time_between_actions, p.activity AS first_action, e.activity AS second_action, p.idcase FROM events_log p INNER JOIN events_log e ON p.idcase = e.idcase WHERE p.activity = 'Permit requested by employee' AND e.activity = 'Permit approved by administration';
SELECT DISTINCT(idcase) FROM (SELECT idcase, activity, LEAD(activity) OVER (PARTITION BY idcase ORDER BY timestamp) AS next_activity FROM event_log) where activity = next_activity
SELECT DISTINCT(idcase) FROM (SELECT idcase, activity, LEAD(activity) OVER (PARTITION BY idcase ORDER BY timestamp) AS next_activity FROM event_log) where activity = next_activity
SELECT DISTINCT(idcase) FROM (SELECT idcase, activity, LEAD(activity) OVER (PARTITION BY idcase ORDER BY timestamp) AS next_activity FROM event_log) where activity = next_activity
SELECT idcase FROM events_log WHERE activity LIKE '%rework%'
SELECT DISTINCT(idcase) FROM (SELECT idcase, activity, LEAD(activity) OVER (PARTITION BY idcase ORDER BY timestamp) AS next_activity FROM events_log) where activity = next_activity AND activity = 'Intervention'
SELECT DISTINCT(idcase) FROM (SELECT idcase, activity, LEAD(activity) OVER (PARTITION BY idcase ORDER BY timestamp) AS next_activity FROM events_log) where activity = next_activity
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT activity) > 3;
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(DISTINCT activity) = 1
SELECT idcase FROM events_log GROUP BY idcase, activity HAVING COUNT(*) > 1
SELECT DISTINCT idcase FROM events_log GROUP BY idcase, activity HAVING COUNT(*) > 1
SELECT idcase FROM events_log GROUP BY idcase HAVING COUNT(*) > 3;
SELECT DISTINCT idcase FROM event_log WHERE activity = 'intervention' GROUP BY idcase HAVING COUNT(*) >= 2 AND MIN(timestamp) < MAX(timestamp)
SELECT DISTINCT resource FROM event_log WHERE activity LIKE '%supervisor%' ORDER BY resource;
SELECT DISTINCT resource FROM events_log WHERE activity LIKE '%supervise%'
SELECT resource FROM events_log WHERE activity = 'Budget approved' GROUP BY resource ORDER BY COUNT(*) DESC LIMIT 1
SELECT DISTINCT(resource) from events_log where activity like '%budget owner%'
