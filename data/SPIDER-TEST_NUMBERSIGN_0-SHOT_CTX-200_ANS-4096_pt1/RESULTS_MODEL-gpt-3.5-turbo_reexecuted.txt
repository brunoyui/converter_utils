SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT activity, COUNT(activity) AS total_activities FROM event_log WHERE activity LIKE '%universidade%' GROUP BY activity ORDER BY total_activities DESC;
SELECT idcase, COUNT(activity) as total_activities FROM event_log GROUP BY idcase ORDER BY total_activities DESC LIMIT 10;
SELECT activity, COUNT(activity) AS total_actions FROM event_log GROUP BY activity ORDER BY total_actions DESC LIMIT 10;
SELECT activity, COUNT(activity) AS total_actions FROM event_log GROUP BY activity ORDER BY total_actions DESC LIMIT 10;
SELECT idcase, COUNT(id) as event_count FROM event_log GROUP BY idcase ORDER BY event_count DESC LIMIT 10;
SELECT resource, COUNT(activity) AS total_actions FROM event_log GROUP BY resource HAVING total_actions >= 100 ORDER BY total_actions DESC;
SELECT idcase FROM event_log WHERE resource = 'Charles' AND strftime('%Y-%m', timestamp) <> '2018-01';
SELECT idcase FROM event_log WHERE resource IN ('Sara', 'Thomas');
SELECT idcase FROM event_log WHERE resource = 'Sara' AND idcase IN ( SELECT idcase FROM event_log WHERE resource = 'Thomas' )
SELECT COUNT(activity) FROM event_log WHERE idcase = 56300;
SELECT resource FROM event_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource, idcase HAVING COUNT(activity) > 5;
SELECT resource FROM event_log GROUP BY resource, idcase HAVING COUNT(activity) > 5;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(activity) > 5;
SELECT resource FROM event_log WHERE activity = 'approval' AND resource IN ( SELECT resource FROM event_log WHERE activity = 'declaration' AND cost = 'approved' AND idcase NOT IN ( SELECT idcase FROM event_log WHERE activity = 'declaration' AND cost = 'rejected' ) ) GROUP BY resource ORDER BY COUNT(*) DESC LIMIT 10;
SELECT resource FROM event_log WHERE activity = 'approval' AND resource IN ( SELECT resource FROM event_log WHERE activity = 'declaration' AND cost = 'final' AND resource IN ( SELECT resource FROM event_log WHERE activity = 'position' AND cost = 'supervisor' ) ) ORDER BY idcase;
SELECT activity, timestamp, COUNT(DISTINCT id) AS interventions FROM event_log WHERE activity = 'intervention' GROUP BY activity, timestamp HAVING COUNT(DISTINCT id) > 1;
SELECT resource, COUNT(*) AS interventions_without_cost FROM event_log WHERE cost IS NULL GROUP BY resource;
SELECT resource, COUNT(*) AS interventions_without_cost FROM event_log WHERE cost IS NULL GROUP BY resource;
SELECT activity FROM event_log WHERE timestamp = '2017-12-12' AND activity NOT IN ('Chegada ao destino', 'Retorno ao ponto de partida');
SELECT SUM(cost) AS total_cost FROM event_log WHERE activity = 'approval' AND resource = 'supervisor';
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'fim da viagem' AND timestamp BETWEEN '2017-05-02' AND '2017-05-12';
SELECT COUNT(*) FROM event_log WHERE cost IS NULL;
SELECT activity FROM event_log WHERE date(timestamp) = '2018-04-12';
SELECT activity, timestamp, resource FROM event_log WHERE idcase = 'declaracao_viagem' AND timestamp > (SELECT MAX(timestamp) FROM event_log WHERE idcase = 'finalizacao_viagem');
SELECT COUNT(*) FROM event_log WHERE activity = 'processamento de declaração de viagem' AND resource = 'funcionário' AND idcase NOT IN ( SELECT idcase FROM event_log WHERE activity = 'registro final de viagem' AND resource = 'funcionário' )
SELECT idcase FROM event_log WHERE activity = 'declaração de viagem' GROUP BY idcase HAVING COUNT(activity) <= 10;
SELECT id FROM event_log WHERE (idcase, timestamp) IN (SELECT idcase, MAX(timestamp) FROM event_log GROUP BY idcase) ORDER BY timestamp;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity, COUNT(*) as occurrences FROM event_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity, COUNT(*) as total_executions FROM event_log WHERE activity LIKE '%processamento de declarações%' GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity, COUNT(activity) as total_executions FROM event_log WHERE resource IN ('funcionário', 'supervisor', 'administração', 'pré-aprovador', 'responsável pelo orçamento', 'diretor') GROUP BY activity ORDER BY total_executions DESC;
