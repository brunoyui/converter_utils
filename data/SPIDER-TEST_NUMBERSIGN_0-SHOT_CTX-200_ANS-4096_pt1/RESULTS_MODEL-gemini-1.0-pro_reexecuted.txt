SELECT * FROM event_log WHERE activity = 'process_statement' AND cost > 0;
SELECT activity FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log WHERE activity = 'process_declaration' GROUP BY idcase ORDER BY COUNT(*) DESC LIMIT 1 ) GROUP BY activity ORDER BY COUNT(*) DESC;
SELECT idcase FROM event_log GROUP BY idcase ORDER BY COUNT(*) DESC LIMIT 10;
SELECT statement FROM event_log GROUP BY statement ORDER BY COUNT(*) DESC LIMIT 10;
SELECT activity, COUNT(*) AS count FROM event_log GROUP BY activity ORDER BY count DESC LIMIT 10;
SELECT idcase FROM event_log GROUP BY idcase ORDER BY COUNT(*) DESC LIMIT 10;
SELECT resource, COUNT(*) AS num_actions FROM event_log GROUP BY resource HAVING num_actions >= 100 ORDER BY num_actions DESC;
SELECT DISTINCT idcase FROM event_log WHERE resource = 'Charles' AND NOT timestamp BETWEEN '2018-01-01' AND '2018-01-31';
SELECT idcase FROM event_log WHERE resource IN ('Sara', 'Thomas');
SELECT activity FROM event_log WHERE idcase IN ( SELECT idcase FROM event_log WHERE activity = 'Participated' AND resource = 'Sara' ) AND idcase IN ( SELECT idcase FROM event_log WHERE activity = 'Participated' AND resource = 'Thomas' );
SELECT COUNT(*) FROM event_log WHERE idcase = 56300;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 5
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 5;
SELECT supervisor, COUNT(*) AS total_approved FROM event_log WHERE activity = 'Approve' AND resource = 'Statement' AND cost = 'Definitive' GROUP BY supervisor ORDER BY total_approved DESC LIMIT 10;
SELECT e.id, e.activity, e.timestamp, e.resource, e.cost, e.idcase FROM event_log AS e WHERE e.activity = 'Aprovação' AND e.resource = 'Supervisor' ORDER BY e.cost DESC;
SELECT activity FROM event_log GROUP BY idcase, timestamp HAVING COUNT(*) > 1;
SELECT COUNT(*) AS intervencoes_sem_custo FROM event_log WHERE activity = 'processar_declaracao' AND cost IS NULL GROUP BY idcase;
SELECT COUNT(*) AS intervencoes_sem_custo FROM event_log WHERE activity = 'processar_declaracao' AND cost IS NULL GROUP BY idcase;
SELECT activity FROM event_log WHERE activity NOT IN ( SELECT activity FROM event_log WHERE timestamp BETWEEN '2017-12-12 00:00:00' AND '2017-12-12 23:59:59' ) AND activity LIKE '%end%' AND idcase IN ( SELECT idcase FROM event_log WHERE timestamp BETWEEN '2017-12-12 00:00:00' AND '2017-12-12 23:59:59' );
SELECT timestamp FROM event_log WHERE activity = 'supervisor_approval' AND resource = 'statement';
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'fim da viagem' AND timestamp BETWEEN '2017-05-02' AND '2017-05-12';
SELECT COUNT(*) FROM event_log WHERE cost IS NULL;
SELECT activity FROM event_log WHERE timestamp LIKE '2018-04-12%';
SELECT e.activity, e.timestamp, e.resource, e.cost, e.idcase, u.name AS employee_name FROM event_log AS e JOIN user AS u ON e.idcase = u.id WHERE e.activity = 'Trip End' AND e.timestamp > ( SELECT timestamp FROM event_log WHERE activity = 'Trip Start' AND idcase = e.idcase );
SELECT COUNT(*) FROM event_log WHERE activity = 'Process Travel Claim' AND idcase NOT IN ( SELECT idcase FROM event_log WHERE activity = 'End Travel' );
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(*) <= 10;
SELECT id FROM event_log WHERE activity = 'executed' GROUP BY idcase ORDER BY timestamp DESC
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity FROM event_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity FROM event_log WHERE activity LIKE '%process declaration%' GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity, COUNT(*) AS count FROM event_log WHERE resource IN ( SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 1 ) GROUP BY activity ORDER BY CASE WHEN activity = 'employee' THEN 1 WHEN activity = 'supervisor' THEN 2 WHEN activity = 'management' THEN 3 WHEN activity = 'preapprover' THEN 4 WHEN activity = 'budget_owner' THEN 5 WHEN activity = 'director' THEN 6 ELSE 7 END, count DESC;
