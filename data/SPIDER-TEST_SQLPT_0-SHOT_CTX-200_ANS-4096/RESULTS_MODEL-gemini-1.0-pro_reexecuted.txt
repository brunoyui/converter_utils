SELECT "activity" FROM "event_log" WHERE "resource" = 'university' AND "cost" IS NOT NULL;
SELECT "activity" FROM "event_log" WHERE "resource" = 'declaracoes' GROUP BY "activity" ORDER BY COUNT(*) DESC LIMIT 10;
SELECT "idcase" FROM "event_log" GROUP BY "idcase" ORDER BY COUNT(*) DESC LIMIT 10;
SELECT e1.activity AS activity1, e2.activity AS activity2, COUNT(*) AS count FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e1.activity <> e2.activity GROUP BY e1.activity, e2.activity ORDER BY count DESC LIMIT 10;
SELECT "activity", COUNT(*) AS "action_count" FROM "event_log" GROUP BY "activity" ORDER BY "action_count" DESC LIMIT 10;
SELECT "idcase" FROM "event_log" GROUP BY "idcase" ORDER BY COUNT(*) DESC LIMIT 10;
SELECT resource, COUNT(*) AS total_actions FROM event_log WHERE activity = 'action' GROUP BY resource HAVING COUNT(*) >= 100 ORDER BY total_actions DESC;
SELECT DISTINCT "idcase" FROM "event_log" WHERE "activity" = 'Charles' AND "timestamp" NOT BETWEEN '2018-01-01' AND '2018-01-31';
SELECT DISTINCT "idcase" FROM "event_log" WHERE "resource" IN ('Sara', 'Thomas');
SELECT "activity" FROM "event_log" WHERE "resource" IN ( SELECT "resource" FROM "event_log" WHERE "activity" = 'Participated' AND "resource" IN ('Sara', 'Thomas') ) AND "activity" = 'Participated' AND "resource" IN ('Sara', 'Thomas');
SELECT COUNT(*) FROM event_log WHERE idcase = '56300';
SELECT resource FROM event_log GROUP BY idcase HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 5 AND idcase IS NOT NULL;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 5;
SELECT resource FROM event_log GROUP BY resource HAVING COUNT(*) > 5;
SELECT e.activity, e.resource, COUNT(e.id) AS total_approvals FROM event_log AS e WHERE e.activity = 'Aprovação de Declaração' AND e.resource LIKE '%Supervisor%' GROUP BY e.resource ORDER BY total_approvals DESC LIMIT 10;
SELECT e.activity, e.resource, e.timestamp, e.cost, e.idcase, s.supervisor FROM event_log AS e JOIN supervisor AS s ON e.resource = s.employee WHERE e.activity = 'Aprovação de Declaração' AND e.cost = ( SELECT MAX(cost) FROM event_log WHERE activity = 'Aprovação de Declaração' AND resource = e.resource ) ORDER BY e.cost DESC;
SELECT "activity" FROM "event_log" WHERE "idcase" IN ( SELECT "idcase" FROM "event_log" GROUP BY "idcase" HAVING COUNT(*) > 1 );
SELECT e.activity, e.resource, COUNT(e.id) AS intervencoes_sem_custo FROM event_log AS e WHERE e.activity = 'Processamento de Declarações' AND e.cost IS NULL GROUP BY e.activity, e.resource;
SELECT e.activity, e.resource, COUNT(e.id) AS intervencoes_sem_custo FROM event_log AS e WHERE e.activity LIKE '%processamento de declarações%' AND e.cost IS NULL GROUP BY e.activity, e.resource;
SELECT "activity" FROM "event_log" WHERE "timestamp" BETWEEN '2017-12-12 00:00:00' AND '2017-12-12 23:59:59' AND "activity" NOT IN ( 'end_trip', 'end_trip_cancelled' );
SELECT ( SELECT "timestamp" FROM "event_log" WHERE "activity" = 'supervisor_approval' AND "idcase" = '12345' ) - ( SELECT "timestamp" FROM "event_log" WHERE "activity" = 'statement_submitted' AND "idcase" = '12345' ) AS "time_spent_for_supervisor_approval" FROM "event_log" WHERE "idcase" = '12345';
SELECT COUNT(DISTINCT "idcase") FROM "event_log" WHERE "activity" = 'fim da viagem' AND "timestamp" BETWEEN '2017-05-02' AND '2017-05-12';
SELECT COUNT(*) FROM event_log WHERE cost IS NULL;
SELECT "activity" FROM "event_log" WHERE "timestamp" BETWEEN '2018-04-12 00:00:00' AND '2018-04-12 23:59:59';
SELECT e1.activity AS "Ação pós-finalização da viagem", e1.timestamp AS "Data e hora da ação", e2.activity AS "Ação de finalização da viagem", e2.timestamp AS "Data e hora da finalização da viagem", e1.resource AS "Funcionário que executou a ação" FROM event_log AS e1 JOIN event_log AS e2 ON e1.idcase = e2.idcase WHERE e1.timestamp > e2.timestamp AND e2.activity = 'Finalização da viagem';
SELECT COUNT(*) FROM event_log WHERE activity = 'Processar Declaração de Viagem' AND resource NOT IN ( SELECT resource FROM event_log WHERE activity = 'Registrar Fim de Viagem' );
SELECT idcase FROM event_log WHERE activity = 'processamento de declaração de viagem' GROUP BY idcase HAVING COUNT(*) <= 10;
SELECT MAX("id") AS "last_event_id" FROM "event_log" GROUP BY "idcase" ORDER BY "timestamp" DESC;
SELECT "activity" FROM "event_log" GROUP BY "activity" HAVING COUNT(*) >= 100;
SELECT "activity" FROM "event_log" GROUP BY "activity" HAVING COUNT(*) >= 100;
SELECT "activity" FROM "event_log" GROUP BY "activity" HAVING COUNT(*) >= 100;
SELECT "activity" FROM "event_log" WHERE "activity" LIKE '%process declaration%' GROUP BY "activity" HAVING COUNT(*) >= 100;
SELECT "activity", COUNT(*) AS "count" FROM "event_log" WHERE "resource" IN ( SELECT "resource" FROM "event_log" GROUP BY "resource" HAVING COUNT(*) > 1 ) GROUP BY "activity" ORDER BY CASE WHEN "activity" LIKE '%Funcionário%' THEN 1 WHEN "activity" LIKE '%Supervisor%' THEN 2 WHEN "activity" LIKE '%Administração%' THEN 3 WHEN "activity" LIKE '%Pré-aprovador%' THEN 4 WHEN "activity" LIKE '%Responsável pelo orçamento%' THEN 5 WHEN "activity" LIKE '%Diretor%' THEN 6 ELSE 7 END, "count" DESC;
