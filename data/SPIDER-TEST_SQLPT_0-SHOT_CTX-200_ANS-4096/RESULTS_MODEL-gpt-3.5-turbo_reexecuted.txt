SELECT * FROM event_log WHERE cost IS NOT NULL;
SELECT activity, COUNT(activity) AS total_executions FROM event_log GROUP BY activity ORDER BY total_executions DESC;
SELECT idcase, COUNT(activity) AS num_activities FROM event_log GROUP BY idcase ORDER BY num_activities DESC LIMIT 10;
SELECT activity, COUNT(*) AS num_actions FROM event_log GROUP BY activity ORDER BY num_actions DESC, activity DESC LIMIT 10;
SELECT activity, COUNT(activity) AS total_actions FROM event_log GROUP BY activity ORDER BY total_actions DESC LIMIT 10;
SELECT idcase, COUNT(id) AS event_count FROM event_log GROUP BY idcase ORDER BY event_count DESC LIMIT 10;
SELECT resource, COUNT(*) AS num_actions FROM event_log GROUP BY resource HAVING num_actions >= 100 ORDER BY num_actions DESC;
SELECT idcase FROM event_log WHERE resource = 'Charles' AND strftime('%Y-%m', timestamp) != '2018-01' GROUP BY idcase;
SELECT idcase FROM event_log WHERE resource = 'Sara' OR resource = 'Thomas';
SELECT * FROM event_log WHERE resource = 'Sara' OR resource = 'Thomas' GROUP BY idcase HAVING COUNT(DISTINCT resource) = 2;
SELECT COUNT(*) AS total_actions FROM event_log WHERE idcase = '56300';
SELECT resource FROM event_log GROUP BY resource, idcase HAVING COUNT(*) > 5;
SELECT resource, COUNT(resource) AS num_activities FROM event_log GROUP BY resource, idcase HAVING COUNT(resource) > 5;
SELECT "resource" FROM "event_log" GROUP BY "resource", "idcase" HAVING COUNT("resource") > 5;
SELECT "resource" FROM event_log GROUP BY "idcase", "resource" HAVING COUNT("id") > 5;
SELECT "resource" FROM event_log GROUP BY "resource", "idcase" HAVING COUNT("id") > 5;
SELECT resource FROM event_log GROUP BY resource, idcase HAVING COUNT(id) > 5;
SELECT "resource", COUNT("resource") AS "num_activities" FROM "event_log" GROUP BY "resource" HAVING COUNT("resource") > 5;
SELECT "resource", COUNT("resource") AS "num_activities" FROM "event_log" GROUP BY "resource" HAVING COUNT("resource") > 5;
SELECT "resource" FROM "event_log" GROUP BY "resource" HAVING COUNT("activity") > 5;
SELECT resource, COUNT(*) AS total_approvals FROM event_log WHERE activity = 'approval' AND resource IN ( SELECT resource FROM event_log WHERE activity = 'declaration' AND cost = 0 ) GROUP BY resource ORDER BY total_approvals DESC LIMIT 10;
SELECT resource FROM event_log WHERE activity = 'aprovar declaração' AND resource IN ( SELECT resource FROM event_log WHERE activity = 'posição de supervisor' ) ORDER BY resource;
SELECT activity, timestamp, COUNT(DISTINCT id) AS interventions FROM event_log GROUP BY activity, timestamp HAVING COUNT(DISTINCT id) > 1;
SELECT resource, COUNT(*) AS interventions_without_cost FROM event_log WHERE activity = 'intervention' AND cost IS NULL GROUP BY resource;
SELECT resource, COUNT(*) AS interventions_without_cost FROM event_log WHERE cost IS NULL GROUP BY resource;
SELECT DISTINCT activity FROM event_log WHERE timestamp NOT LIKE '2017-12-12%' AND activity LIKE '%fim de viagem%';
SELECT SUM(cost) AS "Tempo gasto para uma declaração ser aprovada pelo supervisor" FROM event_log WHERE activity = 'approval' AND resource = 'supervisor';
SELECT COUNT(DISTINCT idcase) FROM event_log WHERE activity = 'fim da viagem' AND timestamp BETWEEN '2017-05-02' AND '2017-05-12';
SELECT COUNT(*) FROM event_log WHERE cost IS NULL; 
SELECT "activity" FROM "event_log" WHERE DATE("timestamp") = '2018-04-12';
SELECT activity, resource FROM event_log WHERE idcase = 'declaração de viagem' AND timestamp > ( SELECT timestamp FROM event_log WHERE idcase = 'declaração de viagem' AND activity = 'finalização da viagem' )
SELECT COUNT(DISTINCT id) FROM event_log WHERE activity = 'processamento de declaração de viagem' AND resource = 'funcionário' AND id NOT IN ( SELECT id FROM event_log WHERE activity = 'registro final de viagem' AND resource = 'funcionário' )
SELECT idcase FROM event_log GROUP BY idcase HAVING COUNT(activity) <= 10;
SELECT idcase, MAX(timestamp) as last_event_timestamp FROM event_log GROUP BY idcase;
SELECT activity, COUNT(*) as occurrences FROM event_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity, COUNT(*) as occurrences FROM event_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity, COUNT(*) as occurrences FROM event_log GROUP BY activity HAVING COUNT(*) >= 100;
SELECT activity, COUNT(*) as total_executions FROM event_log GROUP BY activity HAVING total_executions >= 100;
SELECT activity, resource, COUNT(*) AS num_executions FROM event_log GROUP BY activity, resource ORDER BY CASE WHEN resource = 'funcionário' THEN 1 WHEN resource = 'supervisor' THEN 2 WHEN resource = 'administração' THEN 3 WHEN resource = 'pré-aprovador' THEN 4 WHEN resource = 'responsável pelo orçamento' THEN 5 WHEN resource = 'diretor' THEN 6 END, num_executions DESC;
