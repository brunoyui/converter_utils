SELECT activity, COUNT(*) as frequency FROM event_log GROUP BY activity ORDER BY frequency DESC;
SELECT activity, COUNT(*) as frequency FROM event_log GROUP BY activity ORDER BY frequency DESC;
SELECT activity, COUNT(*) as frequency FROM event_log GROUP BY activity ORDER BY frequency DESC;
SELECT * FROM event_log WHERE activity = 'início da viagem' AND timestamp >= '2017-03-01' AND timestamp < '2017-04-01' AND idcase IS NOT NULL;
SELECT * FROM event_log WHERE activity = 'início da viagem' AND timestamp BETWEEN '2017-03-01 00:00:00' AND '2017-03-31 23:59:59' ORDER BY id LIMIT 1;
SELECT * FROM event_log WHERE activity = 'início da viagem' AND timestamp >= '2017-03-01 00:00:00' AND timestamp < '2017-04-01 00:00:00' AND idcase LIKE 'C%';
SELECT DISTINCT idcase FROM event_log WHERE activity = 'início da viagem' AND EXTRACT(MONTH FROM timestamp) = 3 AND EXTRACT(YEAR FROM timestamp) = 2017 ORDER BY timestamp ASC LIMIT 1;
WITH ranked_events AS ( SELECT id, activity, timestamp, resource, cost, idcase, ROW_NUMBER() OVER (PARTITION BY idcase ORDER BY timestamp) AS row_num FROM event_log WHERE activity = 'início da viagem' AND timestamp BETWEEN '2017-03-01' AND '2017-03-31' ) SELECT id FROM ranked_events WHERE row_num = 1;
SELECT DISTINCT id FROM event_log WHERE activity = 'início da viagem' AND timestamp BETWEEN '2017-03-01 00:00:00' AND '2017-03-31 23:59:59' AND id NOT IN ( SELECT id FROM event_log WHERE activity!= 'início da viagem' ) ORDER BY id;
SELECT user_id, COUNT(*) AS num_actions FROM event_log GROUP BY user_id;
SELECT timestamp FROM event_log WHERE activity = 'início da viagem' AND resource LIKE '%s';
SELECT timestamp FROM event_log WHERE activity = 'início da viagem' AND resource LIKE '%s';
SELECT timestamp FROM event_log WHERE activity = 'início da viagem' AND resource LIKE '%s';
SELECT timestamp FROM event_log WHERE activity = 'início da viagem' AND resource LIKE '%s';
SELECT timestamp FROM event_log WHERE activity = 'início da viagem' AND resource LIKE '%s';
SELECT timestamp FROM event_log WHERE activity = 'início da viagem' AND resource LIKE '%s';
SELECT timestamp FROM event_log WHERE activity = 'início da viagem' AND resource LIKE '%s';
SELECT timestamp FROM event_log WHERE activity = 'início da viagem' AND resource LIKE '%s';
SELECT resource, COUNT(*) as quantidade_eventos FROM event_log WHERE activity = 'declaração aprovada pela administração' GROUP BY resource ORDER BY quantidade_eventos DESC LIMIT 1;
SELECT idcase, COUNT(*) AS num_events, SUM(DATEDIFF(timestamp, LAG(timestamp) OVER (PARTITION BY idcase ORDER BY timestamp))) AS total_duration FROM event_log GROUP BY idcase ORDER BY num_events DESC LIMIT 5;
SELECT activity, COUNT(*) AS quantidade FROM event_log WHERE idcase IS NOT NULL AND timestamp BETWEEN '2018-03-12 00:00:00' AND '2018-03-12 23:59:59' GROUP BY activity ORDER BY quantidade DESC;
SELECT activity, COUNT(*) AS quantidade_casos FROM event_log WHERE timestamp <= '2018-03-12 23:59:59' AND idcase IS NOT NULL AND activity IS NOT NULL GROUP BY activity ORDER BY quantidade_casos DESC;
SELECT activity, COUNT(idcase) AS quantidade_casos FROM event_log WHERE timestamp <= '2018-03-12 23:59:59' AND activity IN ( SELECT activity FROM event_log WHERE timestamp <= '2018-03-12 23:59:59' GROUP BY activity HAVING COUNT(idcase) = ( SELECT COUNT(idcase) FROM event_log WHERE timestamp <= '2018-03-12 23:59:59' GROUP BY idcase ORDER BY COUNT(idcase) DESC LIMIT 1 ) ) GROUP BY activity ORDER BY quantidade_casos DESC;
SELECT activity, COUNT(*) AS quantidade_casos FROM event_log WHERE timestamp = '2018-03-12' AND idcase LIKE '%FINALIZADO%' GROUP BY activity ORDER BY quantidade_casos DESC;
SELECT activity, COUNT(*) AS num_declaracoes, SUM(CASE WHEN activity LIKE '%processada%' THEN 1 ELSE 0 END) AS num_processadas, SUM(CASE WHEN activity LIKE '%finalizada%' THEN 1 ELSE 0 END) AS num_finalizadas FROM event_log WHERE timestamp >= '2018-03-12 00:00:00' AND timestamp < '2018-03-13 00:00:00' GROUP BY activity;
SELECT activity, COUNT(CASE WHEN activity LIKE 'DECLARACAO_EXECUTADA' THEN 1 ELSE NULL END) AS executas, COUNT(CASE WHEN activity LIKE 'DECLARACAO_FINALIZADA' THEN 1 ELSE NULL END) AS finalizadas FROM event_log WHERE timestamp >= '2018-03-12 00:00:00' AND timestamp < '2018-03-13 00:00:00' GROUP BY activity
SELECT * FROM event_log WHERE activity = 'declaração rejeitada pelo supervisor' ORDER BY timestamp;
SELECT idcase, timestamp, activity FROM event_log WHERE activity = 'declaração rejeitada pelo supervisor' GROUP BY idcase ORDER BY timestamp ASC;
SELECT * FROM event_log WHERE activity = 'declaração rejeitada pelo supervisor' ORDER BY timestamp;
SELECT * FROM event_log WHERE activity = 'declaração rejeitada pelo supervisor' ORDER BY timestamp ASC;
SELECT idcase FROM event_log WHERE activity = 'declaração rejeitada pelo supervisor' ORDER BY timestamp ASC;
SELECT * FROM event_log WHERE activity = 'declaração rejeitada pelo supervisor' ORDER BY timestamp ASC;
